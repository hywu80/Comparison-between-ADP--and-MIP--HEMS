GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  * static data
   3   
   4  * gridlabd data
   6   
   7  * time series data
   9   
  10  scalar M /10000/;
  11  scalar epsilon /0.01/;
  12  scalar coolingSP;
  13  scalar heatingSP;
  14  scalar EVCharRateResult;
  15   
  16  set t time period ;
  17  set s scenario for stochastic;
  18  set ss(s)  subset of s;
  19  Set hm HVAC_mode;
  20  Set nWH
  21  Set nEV
  22  set nStorage
  23  set nObj
  24  set weight
  25  ;
  26   
  27   
  28  * Parameters are read from the files
  29   
  30  parameters HVACPar,AppPar,EPrice,GPrice,tempOut,desiredTEMP,fridgePar,WHPar,waterUsage,EVPar,dishWasherPar,clothesWasherDryerPar,poolPumpPar,windGen,solarGenf;
  31  parameters storPar,nonControlLoad,gasPrice,ancPrice,occupLevel,lightingPar,tsLighting,emiPar;
  32  parameters coObj,CHPPar,sysTimePar,solarIns,interSource,penPar;
  33   
  34  * Read data in
  35   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\HVAC_PAR.gdx
--- LOAD  hm = 1:HVACTable
--- LOAD  HVACPar = 1:HVACTable
  40   
  41   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\CONTROL_DEV.gdx
--- LOAD  AppPar = 1:appTable
  46   
  47   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_ELEC_PRICE.gdx
--- LOAD  t = 1:elecPriceTable
--- LOAD  s = 1:elecPriceTable
--- LOAD  EPrice = 1:elecPriceTable
  52   
  53   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_OUTDOOR_TEMP.gdx
--- LOAD  tempOut = 1:outDoorTempTable
  58   
  59  ************** added on 02-03-2015 ********************
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_SOLAR_INSOLATION.gdx
--- LOAD  solarIns = 1:solarInsolationTable
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


  64   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_INTERNAL_SOURCE.gdx
--- LOAD  interSource = 1:internalSourceTable
  69  ************** end on 02-03-2015 ********************
  70   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_DESIRED_TEMP.gdx
--- LOAD  desiredTEMP = 1:desiredTempTable
  75   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\WATER_HEATER_PAR.gdx
--- LOAD  WHPar = 1:WHTable
--- LOAD  nWH = 1:WHTable
  80   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_HOTWATER_USAGE.gdx
--- LOAD  waterUsage = 1:waterUseTable
  85   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\EV_PAR.gdx
--- LOAD  nEV = 1:EVTable
--- LOAD  EVPar = 1:EVTable
  90   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\STORAGE_PAR.gdx
--- LOAD  nStorage = 1:storageTable
--- LOAD  storPar = 1:storageTable
  95   
  96   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_WIND_GEN.gdx
--- LOAD  windGen = 1:windGenTable
 101   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_SOLAR_GEN.gdx
--- LOAD  solarGenf = 1:solarGenTable
 106   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\TS_NONCONTROL_LOAD.gdx
--- LOAD  nonControlLoad = 1:nonControlLoadTable
 111   
 112   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\OBJECTIVE.gdx
--- LOAD  nObj = 1:objTable
--- LOAD  coObj = 1:objTable
 117   
 118   
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\PENALTY.gdx
--- LOAD  penPar = 1:penTable
 123   
 124   
 125  * Change IntervalLength / SysTimePar if you run energy constraints
GDXIN   D:\PSOC\LWang\GAMS_HEMS_test\SYSTIME_PAR.gdx
--- LOAD  sysTimePar = 1:sysTimeTable
 130   
 131  *ss(s)=yes$(ord(s)>=1);
 132  *deterministic, use the first scenario
 133  ss(s)=yes$(ord(s)>=1 and ord(s)<=1);
 134   
 135  display waterUsage, tempOut, nEV,s,ss,t,Eprice,penPar;
 136   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 144  * For fixing setpoint and testing in old version
 146  * For testing, should not take effect
 148  * Setpoint in bound
 150  * Should not take effect, without integer may be faster but solution may not be feasible
 152  * Should not take effect
 154  * Penalty for charging rate variation
 156  * Penalty for smoothing charging/discharing rate
 158  * Decides if solar is dispatchable (0-max capacity)
 160  * battery degradation
 162   
 163  ****************************** Number of applicances consistency check **********************************
 164   
 165  abort$(appPar('WATER_HEATER')-card(nWH) <> 0)
 166  "Number of Water Heaters inconsistentency, Please check !!";
 167   
 168  abort$(appPar('EV')-card(nEV) <> 0)
 169  "Number of Electric Vehicles inconsistentency, Please check !!";
 170   
 171   
 172  abort$(appPar('STORAGE')-card(nStorage) <> 0)
 173  "Number of Storages inconsistentency, Please check !!";
 174   
 175   
 176  abort$(abs(coObj('ENERGY_COST')+coObj('DISCOMFORT')+coObj('ELEC_CONSUMPTION')+coObj('EMISSION')+coObj('PEAK_LOAD'))-1.0000>0.0001)
 177  "Sum of objective coefficients not equal to 1, Please check !!";
 178   
 179   
 180  ********************************** System Time Parameters ***********************************
 181  parameter intervalLength;
 182  * Number of hours that an interval represents (e.g. .25 hours == 15 minutes)
 183  intervalLength=sysTimePar('INTERVAL_LENGTH');
 184   
 185  parameter singleRunHorizon;
 186  * Should not take effect
 187  singleRunHorizon=sysTimePar('SINGLE_RUN_HORIZON');
 188   
 189  parameter timeGapMultiRun;
 190  * Should not take effect, for future development
 191  timeGapMultiRun=sysTimePar('TIME_GAP_MULTI_RUN');
 192   
 193  parameter elecPricef(t);
 194  elecPricef(t)=EPRICE(t,'BASE_CASE');
 195   
 196  parameter outTempf(t);
 197  outTempf(t)=tempOut(t,'BASE_CASE');
 198  display tempOut;
 199   
 200  parameter hotWaterUsagef(t);
 201  hotWaterUsagef(t)=waterUsage(t,'BASE_CASE');
 202   
 203  parameter objWeight(nObj);
 204  objWeight(nObj)=coObj(nObj);
 205   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 206  parameter sceProbability(s);
 207  sceProbability(ss)=1/card(ss);
 208   
 209  display sceProbability;
 210   
 211  * End system Time Parameters  *
 212   
 213  * 1 HVAC Parameters *
 214   
 215  parameters coRmTemp(hm);
 216  coRmTemp(hm)=HVACPar(hm,'CO_RM_TEMP');
 217  display HVACPar;
 218   
 219  parameter coOutTemp(hm);
 220  coOutTemp(hm)=HVACPar(hm,'CO_OUT_TEMP');
 221  display coOutTemp;
 222   
 223  parameter coPowerToTemp(hm);
 224  coPowerToTemp(hm)=HVACPar(hm,'CO_POWER_TO_TEMP');
 225  display coPowerToTemp;
 226   
 227  * added on 02-03-2015 *
 228  parameter coSolarInsolation(hm);
 229  coSolarInsolation(hm)=HVACPar(hm,'CO_SOLAR_INSOLATION');
 230  display coSolarInsolation;
 231   
 232  parameter coInternalSource(hm);
 233  coInternalSource(hm)=HVACPar(hm,'CO_INTERNAL_SOURCE');
 234  display coInternalSource;
 235  * End added on 02-03-2015 *
 236   
 237  parameter ratedHVACPower(hm);
 238  ratedHVACPower(hm)=HVACPar(hm,'RATED_POWER');
 239  display ratedHVACPower;
 240   
 241  parameter minHVACPower(hm);
 242  minHVACPower(hm)=HVACPar(hm,'MIN_POWER');
 243  *loop(hm,if(minHVACPower(hm)=0,minHVACPower(hm)=epsilon;););
 244   
 245  scalar iniRmTemp;
 246  *$IFI "%HEATPARUSE%"=="YES" iniRmTemp=HVACPar('heating','INI_RM_TEMP');
 247  iniRmTemp=HVACPar('cooling','INI_RM_TEMP');
 248   
 249  display iniRmTemp;
 250   
 251  Parameter HVACCOP(hm);
 252  HVACCOP(hm)=HVACPar(hm,'COP');
 253  display HVACCOP;
 254   
 255  *replace the bound later on 07-15-14
 256  Parameter rmTempUB(t);
 257  *$IFI "%HEATPARUSE%"=="YES" rmTempUB(t)=desiredTEMP(t,'DESIRED_HEATING_TEMP_UB');
 258  rmTempUB(t)=desiredTEMP(t,'DESIRED_COOLING_TEMP_UB');
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 259  display rmTempUB;
 260   
 261   
 262  Parameter rmTempLB(t);
 263  *$IFI "%HEATPARUSE%"=="YES" rmTempLB(t)=desiredTEMP(t,'DESIRED_HEATING_TEMP_LB');
 264  rmTempLB(t)=desiredTEMP(t,'DESIRED_COOLING_TEMP_LB');
 265  display rmTempLB;
 266   
 267   
 268  Parameter desiredRmTemp(t);
 269  desiredRmTemp(t)=desiredTEMP(t,'DESIRED_COOLING_TEMP');
 270  display desiredRmTEMP, desiredTEMP;
 271   
 272  ******************** HVAC consistency Check ****************************************************************************
 273  *abort$(HVACPar('heating','INI_RM_TEMP')-HVACPar('cooling','INI_RM_TEMP') <> 0)
 274  *"Initial Temperature inconsistency, Please check !!";
 275  ******************************************* End HVAC ++++++++++++++++++++++++++++++++++++++++++ ***********************************************************
 276   
 277  **************************************   3 Water Heater Parameters   *******************************
 278   
 279  parameters coWHTemp(nWH);
 280  coWHTemp(nWH)=WHPar(nWH,'CO_WH_TEMP');
 281   
 282   
 283  parameter coWaterUsage(nWH);
 284  coWaterUsage(nWH)=WHPar(nWH,'CO_HOTWATER_USAGE');
 285   
 286  parameter coWHPowerToTemp(nWH);
 287  coWHPowerToTemp(nWH)=WHPar(nWH,'CO_WHPOWER_TO_TEMP');
 288   
 289  parameter ratedWHPower(nWH);
 290  ratedWHPower(nWH)=WHPar(nWH,'RATED_WHPOWER');
 291   
 292  parameter minWHPower(nWH);
 293  minWHPower(nWH)=WHPar(nWH,'min_WHPOWER');
 294  loop(nWH,if(minWHPower(nWH)=0,minWHPower(nWH)=epsilon;););
 295   
 296  Parameters iniWHTemp(nWH);
 297  iniWHTemp(nWH)=WHPar(nWH,'INI_WH_TEMP');
 298   
 299  Parameters coWHAmbTemp(nWH);
 300  coWHAmbTemp(nWH)=WHPar(nWH,'CO_WH_AMBIENT');
 301   
 302  Parameter WHCOP(nWH);
 303  WHCOP(nWH)=WHPar(nWH,'COP');
 304   
 305  Parameter WHTempUB(t);
 306  WHTempUB(t)=desiredTEMP(t,'DESIRED_WH_TEMP_UB');
 307   
 308  Parameter WHTempLB(t);
 309  WHTempLB(t)=desiredTEMP(t,'DESIRED_WH_TEMP_LB');
 310   
 311  Parameter desiredWHTemp(t);
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 312  desiredWHTemp(t)=desiredTEMP(t,'DESIRED_WH_TEMP');
 313   
 314  parameter hotWaterUsage(t,s);
 315  hotWaterUsage(t,ss)=waterUsage(t,ss);
 316   
 317  *********************************** 4 EV Parameters  ***********************************************
 318  Parameter EVCapac(nEV);
 319  EVCapac(nEV)=EVPar(nEV,'CAPACITY');
 320   
 321  Parameter maxEVCharge(nEV);
 322  maxEVCharge(nEV)=EVPar(nEV,'MAX_CHARGE');
 323   
 324  Parameter minEVCharge(nEV);
 325  minEVCharge(nEV)=EVPar(nEV,'MIN_CHARGE');
 326  loop(nEV,if(minEVCharge(nEV)=0,minEVCharge(nEV)=epsilon;););
 327   
 328  Parameter maxEVDischarge(nEV);
 329  maxEVdischarge(nEV)=EVPar(nEV,'MAX_DISCHARGE');
 330   
 331  Parameter minEVDischarge(nEV);
 332  minEVdischarge(nEV)=EVPar(nEV,'MIN_DISCHARGE');
 333  loop(nEV,if(minEVDischarge(nEV)=0,minEVDischarge(nEV)=epsilon;););
 334   
 335  parameter minEVSOC(nEV);
 336  minEVSOC(nEV)=EVPar(nEV,'MIN_SOC');
 337   
 338  parameter maxEVSOC(nEV);
 339  maxEVSOC(nEV)=EVPar(nEV,'MAX_SOC');
 340   
 341  Parameter ArrEVTime(nEV);
 342  ArrEVTime(nEV)=EVPar(nEV,'ARRIVAL_TIME');
 343   
 344  Parameter DepEVTime(nEV);
 345  DepEVTime(nEV)=EVPar(nEV,'DEPART_TIME');
 346   
 347  Parameter ArrEVSOC(nEV);
 348  ArrEVSOC(nEV)=EVPar(nEV,'ARRIVAL_SOC');
 349   
 350  Parameter DepEVSOC(nEV);
 351  DepEVSOC(nEV)=EVPar(nEV,'DEPART_SOC');
 352   
 353  Parameter EVEff(nEV);
 354  EVEff(nEV)=EVPar(nEV,'EFFICIENCY');
 355   
 356  parameter EVBDTMAX(nEV);
 357  EVBDTMAX(nEV)=(DepEVTime(nEV)-ArrEVTime(nEV))*intervalLength;
 358  parameter EVBDPMIN(nEV);
 359  EVBDPMIN(nEV)=(DepEVSOC(nEV)-ArrEVSOC(nEV))*EVCapac(nEV)*1000/EVBDTMAX(nEV)/EVEff(nEV);
 360   
 361   
 362  Parameter InitEVSOC(nEV);
 363  InitEVSOC(nEV)=EVPar(nEV,'INITIAL_SOC');
 364   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 365  Parameter EndEVSOC(nEV);
 366  EndEVSOC(nEV)=EVPar(nEV,'END_SOC');
 367   
 368  display InitEVSOC,EndEVSOC;
 369   
 370  Parameter StartChargeTime(nEV);
 371  parameter StopChargeTime(nEV);
 372  parameter StartChargeEVSOC(nEV);
 373  parameter StopChargeEVSOC(nEV);
 374   
 375  loop (nEV,if(card(t)-1 ge DepEVTime(nEV) and DepEVTime(nEV) ge ArrEVTime(nEV) and ArrEVTime(nEV) ge 0,
 376  StartChargeTime(nEV)=ArrEVTime(nEV);
 377  StartChargeEVSOC(nEV)=ArrEVSOC(nEV);
 378  StopChargeTime(nEV)=DepEVTime(nEV);
 379  StopChargeEVSOC(nEV)=DepEVSOC(nEV););
 380  if(card(t)-1 ge ArrEVTime(nEV) and ArrEVTime(nEV) ge DepEVTime(nEV) and DepEVTime(nEV) ge 0,
 381  StartChargeTime(nEV)=0;
 382  StartChargeEVSOC(nEV)=InitEVSOC(nEV);
 383  StopChargeTime(nEV)=DepEVTime(nEV);
 384  StopChargeEVSOC(nEV)=DepEVSOC(nEV););
 385  if(card(t)-1 ge ArrEVTime(nEV) and ArrEVTime(nEV) ge 0 and (0 gt DepEVTime(nEV) or DepEVTime(nEV) gt card(t)-1),
 386  StartChargeTime(nEV)=ArrEVTime(nEV);
 387  StartChargeEVSOC(nEV)=ArrEVSOC(nEV);
 388  StopChargeTime(nEV)=card(t)-1;
 389  StopChargeEVSOC(nEV)=EndEVSOC(nEV););
 390  if(card(t)-1 ge DepEVTime(nEV) and DepEVTime(nEV) ge 0 and (0 gt ArrEVTime(nEV) or ArrEVTime(nEV) gt card(t)-1),
 391  StartChargeTime(nEV)=0;
 392  StartChargeEVSOC(nEV)=InitEVSOC(nEV);
 393  StopChargeTime(nEV)=DepEVTime(nEV);
 394  StopChargeEVSOC(nEV)=DepEVSOC(nEV););
 395  if((0 gt ArrEVTime(nEV) or ArrEVTime(nEV) gt card(t)-1) and (0 gt DepEVTime(nEV) or DepEVTime(nEV) gt card(t)-1),
 396  StartChargeTime(nEV)=0;
 397  StartChargeEVSOC(nEV)=0;
 398  StopChargeTime(nEV)=0;
 399  StopChargeEVSOC(nEV)=0;););
 400  *end addition
 401  display StartChargeTime,StartChargeEVSOC,StopChargeTime,StopChargeEVSOC;
 402   
 403   
 404   
 405  *********************************** end EV Parameters **********************************************
 406   
 407  *********************************** Storage Parameters *********************************************
 408  Parameter storCapac(nStorage);
 409  storCapac(nStorage)=storPar(nStorage,'CAPACITY');
 410   
 411  Parameter maxstorCharge(nStorage);
 412  maxstorCharge(nStorage)=storPar(nStorage,'MAX_CHARGE');
 413   
 414  Parameter minStorCharge(nStorage);
 415  minStorCharge(nStorage)=storPar(nStorage,'MIN_CHARGE');
 416  loop(nStorage,if(minStorCharge(nStorage)=0,minStorCharge(nStorage)=epsilon;););
 417   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 418  Parameter maxstorDischarge(nStorage);
 419  maxStorDischarge(nStorage)=storPar(nStorage,'MAX_DISCHARGE');
 420   
 421  Parameter minStorDischarge(nStorage);
 422  minStorDischarge(nStorage)=storPar(nStorage,'MIN_DISCHARGE');
 423  loop(nStorage,if(minStorDischarge(nStorage)=0,minStorDischarge(nStorage)=epsilon;););
 424   
 425  parameter minStorSOC(nStorage);
 426  minStorSOC(nStorage)=storPar(nStorage,'MIN_SOC');
 427   
 428  parameter maxStorSOC(nStorage);
 429  maxStorSOC(nStorage)=storPar(nStorage,'MAX_SOC');
 430   
 431  Parameter iniStorSOC(nStorage);
 432  iniStorSOC(nStorage)=storPar(nStorage,'INI_SOC');
 433   
 434  Parameter endStorSOC(nStorage);
 435  endStorSOC(nStorage)=storPar(nStorage,'END_SOC');
 436   
 437  Parameter storEff(nStorage);
 438  storEff(nStorage)=storPar(nStorage,'EFFICIENCY');
 439  *********************************** end Storage parameters *****************************************
 440   
 441   
 442  ********************************** Global variables *****************************************
 443  * small `p` represents power
 444   
 445  variable pGrid(t,s);
 446  variable pGridUB;
 447  positive variable pGridSlack1(t,s);
 448  positive variable pGridSlack2(t,s);
 449  variable gasConsump(t,s);
 450  variable energyCost total energy cost;
 451  variable discom total discomfort;
 452  variable elecConsump total energy comsumption;
 453  variable carbFoot carbon footprint;
 454  variable peakLoad peak load;
 455  variable sumObj overall objective function;
 456   
 457   
 458  ****** dispatchable renewable *************
 459  positive variable dispSolarGen(t,s);
 460   
 461  ****** end dispatchable renewable *********
 462   
 463  *added on 07-09-14
 464   
 465  variable HVACEnergyCost;
 466  variable WHEnergyCost;
 467  variable EVEnergyCost;
 468  variable StorEnergyCost;
 469  variable PVEnergyCost;
 470  variable WindEnergyCost;
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                 03/14/18 13:22:38 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 471  variable NCLEnergycost;
 472  ********************************** End Global variables *************************************
 473   
 474   
 475  **********************************  HVAC variables  ***********************************************************
 476   
 477  variable rmTemp(t,s);
 478  variable rmTempSP(t) room temperature set point;
 479  positive variable pHVAC(t,s) HVAC power consumption;
 480  variable calRmTemp_noCool(t,s) calculated room temperature without HVAC;
 481  variable calRmTemp_ratedCool(t,s) calculated room temperature with rated HVAC power;
 482  variable calPHVAC_CoolSP(t,s) calculated HVAC power with room temperature cooling setpoint;
 483  variable calPHVAC_HeatSP(t,s) calculated HVAC power with room temperature heating setpoint;
 484  variable calRmTemp_noHeat(t,s) calculated room temperature without HVAC;
 485  variable calRmTemp_ratedHeat(t,s) calculated room temperature with rated HVAC power;
 486  variable calPHVAC_SP(t,s) calculated HVAC power with room temperature setpoint;
 487  positive variable s1(t,s);
 488  positive variable s2(t,s);
 489  integer variable decision(t,s);
 490  binary variable ON(t) HVAC ON=1 or OFF=0 state;
 492  ON.up(t)=1;
 493  ON.lo(t)=0;
 494   
 495  binary variable c(t)  cooling state;
 497  c.up(t)=1;
 498  c.lo(t)=0;
 499  binary variable h(t)  heating state;
 501  h.up(t)=1;
 502  h.lo(t)=0;
 503  binary variable b1(t) cooling ancillary variables;
 504  binary variable b2(t) cooling ancillary variables;
 505  binary variable b3(t) heating ancillary variables;
 506  binary variable b4(t) heating ancillary variables;
 511  b1.up(t)=1;
 512  b1.lo(t)=0;
 513  b2.up(t)=1;
 514  b2.lo(t)=0;
 515  b3.up(t)=1;
 516  b3.lo(t)=0;
 517  b4.up(t)=1;
 518  b4.lo(t)=0;
 519   
 520  ********************************** End HVAC Variables ***********************************************************
 521   
 522  ***********************************  WH variables  **************************************************************
 523  variable WHTemp(nWH,t,s);
 524  variable WHTempSP(nWH,t);
 525  positive variable pWH(nWH,t,s);
 526  variable calWHTemp_noHeat(nWH,t,s);
 527  variable calWHTemp_ratedHeat(nWH,t,s);
 528  variable calPWH_HeatSP(nWH,t,s);
 529  positive variable s5(nWH,t,s);
 530  positive variable s6(nWH,t,s);
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 531  binary variable WHON(nWH,t);
 533  WHON.up(nWH,t)=1;
 534  WHON.lo(nWH,t)=0;
 535  binary variable bbb1(nWH,t);
 536  binary variable bbb2(nWH,t);
 539  bbb1.up(nWH,t)=1;
 540  bbb2.up(nWH,t)=1;
 541  bbb1.lo(nWH,t)=0;
 542  bbb2.lo(nWH,t)=0;
 543  *added on 07-01-14
 544  variable WHAmbTemp(nWH,t,s);
 545   
 546  ***********************************  End WH variables  **************************************************************
 547   
 548  ***********************************  EV variables  ***************************************************************
 549  variable EVCharRate(nEV,t,s);
 550  variable EVDischarRate(nEV,t,s);
 551  positive variable EVSOC(nEV,t,s);
 552  positive variable EVSOCSlack(t);
 553  binary variable EVChargeState(nEV,t);
 555  binary variable EVDischargeState(nEV,t);
 557  EVChargeState.up(nEV,t)=1;
 558  EVChargeState.lo(nEV,t)=0;
 559  EVDischargeState.up(nEV,t)=1;
 560  EVDischargeState.lo(nEV,t)=0;
 561  positive variable EVCharPosDiff(nEV,t,s);
 562  positive variable EVCharNegDiff(nEV,t,s);
 563  positive variable EVDischarPosDiff(nEV,t,s);
 564  positive variable EVDischarNegDiff(nEV,t,s);
 565  variable CostBD_Q_SOC(nEV,s);
 566  variable CostBD_Q_T(nEV,s);
 567  variable CostBD_P_T(nEV,s);
 568  variable CostBD_UB(nEV,s);
 569  variable debug_variable1(nEV,s);
 570  variable debug_variable2(nEV,s);
 571   
 572  ***********************************  End of EV variables *********************************************************
 573  *********************************** Storage variables ************************************************************
 574  variable storCharRate(nStorage,t,s);
 575  variable storDischarRate(nStorage,t,s);
 576  positive variable storSOC(nStorage,t,s);
 577  binary variable storChargeState(nStorage,t);
 579  binary variable storDischargeState(nStorage,t);
 581  storChargeState.up(nStorage,t)=1;
 582  storChargeState.lo(nStorage,t)=0;
 583  storDischargeState.up(nStorage,t)=1;
 584  storDischargeState.lo(nStorage,t)=0;
 585  positive variable storCharPosDiff(nStorage,t,s);
 586  positive variable storCharNegDiff(nStorage,t,s);
 587  positive variable storDischarPosDiff(nStorage,t,s);
 588  positive variable storDischarNegDiff(nStorage,t,s);
 589   
 590  *********************************** end storage variables ********************************************************
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 591   
 592  *********************************** Equations for objective functions ***************************************
 593  equations
 594  objDefEnerCost
 595  objDefDiscom
 596  objDefElecConsump
 597  objDefCarbFoot
 598  objDefPeakLoad
 599  elecLoadBalanceCon
 600  gasLoadBalanceCon
 601  ;
 602  equations
 603  gridPowerUB
 604  gridPowerLB
 605  dispSolarUB
 606  inverterUB
 607  inverterLB
 608  ;
 609   
 610  ********************************** Equation for energy cost breakdown ****************************************
 611  equations
 612  HVACEnergyCostDef
 613  WHEnergyCostDef
 614  EVEnergyCostDef
 615  StorEnergyCostDef
 616  PVEnergyCostDef
 617  WindEnergyCostDef
 618  NCLEnergycostDef
 619  ;
 620  ********************************** End equation for energy cost breakdown ************************************
 621   
 622  **********************************  HVAC equaitons ***********************************************************
 623  equations
 624  inirmTempcon
 625  thermEqONCool1
 626  thermEqONCool2
 627  ancON1
 628  ancON2
 629  ancON3
 630  ancON4
 631  thermEqOFF1
 632  thermEqOFF2
 633  ubrmtemp                 upper bound of room temperature
 634  lbrmtemp
 635  ubrmSetTemp              upper bound of room set temprature
 636  lbrmSetTemp              lower bound of room set temprature
 637  ubpHVACONCool                  upper bound of HVAC power
 638  lbpHVACONCool
 639  ubpHVACOFF1
 640  ubpHVACOFF2
 641  calRmTempNoCooling       calculate room temperature without cooling from HVAC
 642  calRmTempRatedCooling    calculate room temperature with full power from HVAC
 643  calPHVACSP1
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 12
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 644  calPHVACSP2               calculate power consumption of HVAC system with room temperature setpoint
 645  ancbin1
 646  ancbin2
 647  ancbin3
 648  ancbin4
 649  ancbin5
 650  ancbin6
 651  ancbin7
 652  ancbin8
 653  ancbin9
 654  ancbin10
 655  ancbin11
 656  ancbin12
 657  ancbin13
 658  ancbin14
 659  ancbin15
 660  ancbin16
 661  extraCon1
 662  extraCon2
 663  ;
 664   
 665  equations
 666  calRmTempNoHeat       calculate room temperature without heating from HVAC
 667  calRmTempRatedHeat    calculate room temperature with rated power from HVAC for heating
 668  calPHVACHeatSP1               calculate power consumption of HVAC system with room temperature setpoint
 669  calPHVACHeatSP2
 670  thermEqONHeat1
 671  thermEqONHeat2
 672  ubpHVACONHeat
 673  lbpHVACONHeat
 674  ancbin17
 675  ancbin18
 676  ancbin19
 677  ancbin20
 678  ancbin21
 679  ancbin22
 680  ancbin23
 681  ancbin24
 682  ancbin25
 683  ancbin26
 684  ancbin27
 685  ancbin28
 686  ancbin29
 687  ancbin30
 688  ancbin31
 689  ancbin32
 690  branch1 huristic prunning condition
 691  branch2
 692  lbrmSetPoint1
 693  lbrmSetPoint2
 694  ubrmTemp1
 695  lbrmTemp1
 696  ;
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 13
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 697  **********************************  End HVAC Equations ***********************************************************
 698   
 699   
 700  ************************************* WH equations *************************************************************
 701  Equations
 702  iniWHTempcon
 703  thermEqWH
 704  ubWHtemp
 705  lbWHtemp
 706  ubWHSetTemp
 707  lbWHSetTemp
 708  ubpWHONHeat
 709  ubpWHOFF1
 710  ubpWHOFF2
 711  calWHTempNoHeating
 712  calWHTempRatedHeating
 713  calPWHSP1
 714  calPWHSP2
 715  ancbin1WH
 716  ancbin2WH
 717  ancbin3WH
 718  ancbin4WH
 719  ancbin5WH
 720  ancbin6WH
 721  ancbin7WH
 722  ancbin8WH
 723  ancbin9WH
 724  ancbin10WH
 725  ancbin11WH
 726  ancbin12WH
 727  ancbin13WH
 728  ancbin14WH
 729  ancbin15WH
 730  ancbin16WH
 731  lbWHSetPoint1
 732  lbWHSetPoint2
 733  AmbTempCal
 734  lbpWHONHeat
 735  ubWHtemp1
 736  lbWHtemp1
 737  extraWHCon1
 738  extraWHCon2
 739  ;
 740  ************************************* End WH equations *********************************************************
 741   
 742  ************************************* EV equations *************************************************************
 743  equations
 744  EVSOCdynamicEq1Charge
 745  EVSOCdynamicEq2Charge
 746  EVSOCdynamicEq1Discharge
 747  EVSOCdynamicEq2Discharge
 748  EVSOCdynamicEq1Idle
 749  EVSOCdynamicEq2Idle
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 14
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 750  EVOfflineEq1
 751  EVOfflineEq2
 752  EViniSOCEq
 753  EVendSOCEq
 754  EVubChargeCon
 755  EVlbChargeCon
 756  EVubDischargeCon
 757  EVlbDischargeCon
 758  EVStateCon
 759  EVubSOC
 760  EVlbSOC
 761  EVCharABS
 762  EVDischarABS
 763  EVCostBD_Q_SOC_Con
 764  EVCostBD_P_T_Con
 765  EVCostBD_Q_T_Con
 766  EVCostBD_UP_Con1
 767  EVCostBD_UP_Con2
 768  debug_1
 769  debug_2
 770  ;
 771   
 772  ****************************************************************************************************************
 773  ************************************** Storage Equations *******************************************************
 774  equations
 775  storSOCdynamicEq1Charge
 776  storSOCdynamicEq2Charge
 777  storSOCdynamicEq1Discharge
 778  storSOCdynamicEq2Discharge
 779  storSOCdynamicEq1Idle
 780  storSOCdynamicEq2Idle
 781  storIniSOCEq
 782  storEndSOCEq
 783  storUbChargeCon
 784  storLbChargeCon
 785  storUbDischargeCon
 786  storLbDischargeCon
 787  storSOCCon
 788  storStateCon
 789  storUbSOC
 790  storLbSOC
 791  storCharABS
 792  storDischarABS
 793  ;
 794  ************************************** End Storage Equations ***************************************************
 795   
 796   
 797  **********************************  HVAC Constraints *************************************************************
 798  objDefEnerCost..      energyCost =e= sum((t,ss)$(ord(t)>1),sceProbability(ss)*EPrice(t,ss)*pGrid(t,ss)*intervalLength)
 800  +sum(t$(ord(t)>1),EVSOCSlack(t)*penPar('EV_SOC_INSUF')*EVCapac('EV_1')+pGridSlack1(t,'BASE_CASE')*penPar('PGRID_UB_VIO')+pGridSlack2(t,'BASE_CASE')*penPar('PGRID_LB_VIO'))
 802  ;
 803   
 804  objDefDiscom..       discom =e= 0
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 15
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 805  *$IFI "%HVAC_INC%"=="YES"    +sum((t,ss)$(ord(t)>1),sceProbability(ss)*desiredTEMP(t,'PENALTY')*(s1(t,ss)+s2(t,ss)))
 806  +sum((t,ss)$(ord(t)>1),sceProbability(ss)*0.38*(s1(t,ss)+s2(t,ss)))
 807  +sum((t,ss)$(ord(t)>1),sceProbability(ss)*0.12*sum(nWH,s5(nWH,t,ss)+s6(nWH,t,ss)))
 808  ;
 809   
 810  *** changed for Google Honeybee ***
 811  objDefElecConsump..  elecConsump =e= intervalLength*(sum((t,ss)$(ord(t)>1),pGrid(t,ss)*0.08))
 814  +sum(t$(ord(t)>1),EVSOCSlack(t)*penPar('EV_SOC_INSUF')*EVCapac('EV_1')+pGridSlack1(t,'BASE_CASE')*penPar('PGRID_UB_VIO')+pGridSlack2(t,'BASE_CASE')*penPar('PGRID_LB_VIO'));
 815  *** end of change for Google Honeybee ***
 816   
 817  objDefCarbFoot.. carbFoot =e= sum((t,ss)$(ord(t)>1),sceProbability(ss)*emiPar('CO_EFFICIENT','ELECTRICITY')*pGrid(t,ss)*intervalLength)
 818  ;
 819   
 820  **************** peak electricity price hour ****************************
 821  parameter PeakElecPrice;
 822  peakElecPrice=smax(t$(ord(t)>1), EPrice(t,'BASE_CASE'));
 823  set peakInterval(t);
 824  peakInterval(t)=yes$(EPrice(t,'BASE_CASE') eq peakElecPrice);
 825  *************** end get peak electricity price hour *********************
 826   
 827  objDefPeakLoad.. peakLoad =e= pGridUB+sum(t$(ord(t)>1),EVSOCSlack(t)*penPar('EV_SOC_INSUF'));
 828   
 829  gasLoadBalanceCon(t,ss)$(ord(t)>1).. gasConsump(t,ss) =e= 0
 830  ;
 831   
 832  elecLoadBalancecon(t,ss)$(ord(t)>1).. pGrid(t,ss)
 835                                 =e=
 836  pHVAC(t,ss)
 837  +sum(nEV,EVCharRate(nEV,t,ss)-EVDischarRate(nEV,t,ss))
 839  +sum(nWH,pWH(nWH,t,ss))
 841  ;
 842   
 843   
 844  inirmTempcon(t,s)$(ord(t)=1 and ss(s)).. rmTemp(t,s) =e= iniRmTemp;
 845  ubrmtemp(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s) =l= desiredRmTemp(t)+s1(t,s);
 846  lbrmtemp(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s) =g= desiredRmTemp(t)-s2(t,s);
 847  ubrmSetTemp(t)$(ord(t)>1).. rmTempSP(t) =l= rmTempUB(t);
 848  lbrmSetTemp(t)$(ord(t)>1).. rmTempSP(t) =g= rmTempLB(t);
 849  ubrmTemp1(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s) =l= rmTempUB(t);
 850  lbrmTemp1(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s) =g= rmTempLB(t);
 851   
 852  ***** Revised on 02-03-2015
 853  thermEqOFF1(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-coRmTemp('cooling')*rmTemp(t-1,s)-coOutTemp('cooling')*tempOut(t,s)-coSolarInsolation('cooling')*solarIns(t,s)-coInternalSource('cooling')*interSource(t,s) =l= M*ON(t);
 854  thermEqOFF2(t,s)$(ord(t)>1 and ss(s)).. -rmTemp(t,s)+coRmTemp('cooling')*rmTemp(t-1,s)+coOutTemp('cooling')*tempOut(t,s)+coSolarInsolation('cooling')*solarIns(t,s)+coInternalSource('cooling')*interSource(t,s) =l= M*ON(t);
 855  ***** End of revison 02-03-2015
 856   
 857   
 858  ubpHVACOFF1(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s) =l= M*ON(t);
 859  ubpHVACOFF2(t,s)$(ord(t)>1  and ss(s)).. -pHVAC(t,s) =l= M*ON(t);
 860   
 861  ************************   End of HVAC is OFF  *************************************
 862   
 863  ************************   HVAC is ON  *************************************
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 16
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 864  ancON1(t)$(ord(t)>1)..  c(t)-1 =l= M*(1-ON(t));
 865  ancON2(t)$(ord(t)>1)..  -c(t)+1 =l= M*(1-ON(t));
 866  ancON3(t)$(ord(t)>1).. c(t) =l= M*ON(t);
 867  ancON4(t)$(ord(t)>1).. -c(t) =l= M*ON(t);
 868  ************************   End of HVAC is ON  *************************************
 869   
 870  ** added on 02-03-2015
 871  calRmTempNoCooling(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss) =e= coRmTemp('cooling')*rmTemp(t-1,ss)+coOutTemp('cooling')*tempOut(t,ss)+coSolarInsolation('cooling')*solarIns(t,ss)+coInternalSource('cooling')*interSource(t,ss);
 872  calRmTempRatedCooling(t,ss)$(ord(t)>1).. calRmTemp_ratedCool(t,ss)=e=coRmTemp('cooling')*rmTemp(t-1,ss)+coPowerToTemp('Cooling')*ratedHVACPower('Cooling')+coOutTemp('cooling')*tempOut(t,ss)+coSolarInsolation('cooling')*solarIns(t,ss)+coInternalSourc
      e('cooling')*interSource(t,ss);
 873  calPHVACSP1(t,ss)$(ord(t)>1)..  calPHVAC_CoolSP(t,ss)-(rmTempSP(t)-coRmTemp('cooling')*rmTemp(t-1,ss)-coOutTemp('cooling')*tempOut(t,ss)-coSolarInsolation('cooling')*solarIns(t,ss)-coInternalSource('cooling')*interSource(t,ss))/coPowerToTemp('Coolin
      g') =l= M*(2-ON(t)-c(t));
 874  calPHVACSP2(t,ss)$(ord(t)>1)..  -calPHVAC_CoolSP(t,ss)+(rmTempSP(t)-coRmTemp('cooling')*rmTemp(t-1,ss)-coOutTemp('cooling')*tempOut(t,ss)-coSolarInsolation('cooling')*solarIns(t,ss)-coInternalSource('cooling')*interSource(t,ss))/coPowerToTemp('Cooli
      ng') =l= M*(2-ON(t)-c(t));
 875  ** end addition on 02-03-2015
 876   
 877   
 878  *added on 11-17-14
 879  extraCon1(t,ss)$(ord(t)>1)..  rmTempSP(t)-calRmTemp_noCool(t,ss) =l= M*(1-c(t));
 880  extraCon2(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss)+epsilon-rmTempSP(t) =l= M*c(t);
 881   
 882  *added on 02-04-15
 883  thermEqONCool1(t,ss)$(ord(t)>1).. rmTemp(t,ss)-coRmTemp('cooling')*rmTemp(t-1,ss)-coPowerToTemp('Cooling')*pHVAC(t,ss)-coOutTemp('cooling')*tempOut(t,ss)-coSolarInsolation('cooling')*solarIns(t,ss)-coInternalSource('cooling')*interSource(t,ss) =l=M*
      (1-c(t));
 884  thermEqONCool2(t,ss)$(ord(t)>1).. -rmTemp(t,ss)+coRmTemp('cooling')*rmTemp(t-1,ss)+coPowerToTemp('Cooling')*pHVAC(t,ss)+coOutTemp('cooling')*tempOut(t,ss)+coSolarInsolation('cooling')*solarIns(t,ss)+coInternalSource('cooling')*interSource(t,ss) =l=M
      *(1-c(t));
 885  *end addition
 886   
 887  ubpHVACONCool(t,ss).. pHVAC(t,ss)=l=ratedHVACPower('Cooling')*c(t);
 888  lbpHVACONCool(t,ss).. minHVACPower('Cooling')*c(t)=l=pHVAC(t,ss);
 889   
 890  *Cooling constraint regarding ancillary binary variable
 891  ancbin1(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss)-rmTempSP(t) =l= M*(2-b1(t)-c(t));
 892  ancbin2(t,ss)$(ord(t)>1)..  pHVAC(t,ss) =l= M*(2-b1(t)-c(t));
 893  ancbin3(t,ss)$(ord(t)>1)..  -pHVAC(t,ss) =l= M*(2-b1(t)-c(t));
 894  ancbin4(t,ss)$(ord(t)>1)..  rmTemp(t,ss)-calRmTemp_noCool(t,ss) =l= M*(2-b1(t)-c(t));
 895  ancbin5(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss)-rmTemp(t,ss) =l= M*(2-b1(t)-c(t));
 896  ancbin6(t,ss)$(ord(t)>1)..  rmTempSP(t)-calRmTemp_noCool(t,ss) =l= M*(1+b1(t)-c(t));
 897  ancbin7(t,ss)$(ord(t)>1)..  ratedHVACPower('Cooling')-calPHVAC_CoolSP(t,ss) =l=M*(b1(t)+2-b2(t)-c(t));
 898  ancbin8(t,ss)$(ord(t)>1)..  pHVAC(t,ss)-ratedHVACPower('Cooling') =l= M*(b1(t)+2-b2(t)-c(t));
 899  ancbin9(t,ss)$(ord(t)>1)..  ratedHVACPower('Cooling')-pHVAC(t,ss) =l= M*(b1(t)+2-b2(t)-c(t));
 900  ancbin10(t,ss)$(ord(t)>1).. rmTemp(t,ss)-calRmTemp_ratedCool(t,ss) =l= M*(b1(t)+2-b2(t)-c(t));
 901  ancbin11(t,ss)$(ord(t)>1).. calRmTemp_ratedCool(t,ss)-rmTemp(t,ss) =l= M*(b1(t)+2-b2(t)-c(t));
 902  ancbin12(t,ss)$(ord(t)>1).. calPHVAC_CoolSP(t,ss)-ratedHVACPower('Cooling') =l= M*(b1(t)+b2(t)+1-c(t));
 903  ancbin13(t,ss)$(ord(t)>1).. pHVAC(t,ss)-calPHVAC_CoolSP(t,ss) =l= M*(b1(t)+b2(t)+1-c(t));
 904  ancbin14(t,ss)$(ord(t)>1).. calPHVAC_CoolSP(t,ss)-pHVAC(t,ss) =l= M*(b1(t)+b2(t)+1-c(t));
 905  ancbin15(t,ss)$(ord(t)>1).. rmTemp(t,ss)-rmTempSP(t) =l= M*(b1(t)+b2(t)+1-c(t));
 906  ancbin16(t,ss)$(ord(t)>1).. rmTempSP(t)-rmTemp(t,ss) =l= M*(b1(t)+b2(t)+1-c(t));
 907   
 908  *********************************   Heating   ***********************************************************************
 909  * Pre_calculation
 910  calRmTempNoHeat(t,s)$(ord(t)>1 and ss(s))..  calRmTemp_noHeat(t,s)=e= coRmTemp('heating')*rmTemp(t-1,s)+coOutTemp('heating')*tempOut(t,s);
 911  calRmTempRatedHeat(t,s)$(ord(t)>1 and ss(s)).. calRmTemp_ratedHeat(t,s)=e=coRmTemp('heating')*rmTemp(t-1,s)+coPowerToTemp('heating')*ratedHVACPower('Heating')+coOutTemp('heating')*tempOut(t,s);
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 17
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 912   
 913  calPHVACHeatSP1(t,s)$(ord(t)>1 and ss(s))..  calpHVAC_HeatSP(t,s)-(rmTempSP(t)-coRmTemp('heating')*rmTemp(t-1,s)-coOutTemp('heating')*tempOut(t,s))/coPowerToTemp('heating') =l= M*(1-h(t));
 914  calPHVACHeatSP2(t,s)$(ord(t)>1 and ss(s))..  -calpHVAC_HeatSP(t,s)+(rmTempSP(t)-coRmTemp('heating')*rmTemp(t-1,s)-coOutTemp('heating')*tempOut(t,s))/coPowerToTemp('heating') =l= M*(1-h(t));
 915   
 916   
 917  thermEqONHeat1(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-coRmTemp('heating')*rmTemp(t-1,s)-coPowerToTemp('heating')*pHVAC(t,s)-coOutTemp('heating')*tempOut(t,s)
 919                                 =l=M*(1-h(t));
 920  thermEqONHeat2(t,s)$(ord(t)>1 and ss(s)).. -rmTemp(t,s)+coRmTemp('heating')*rmTemp(t-1,s)+coPowerToTemp('heating')*pHVAC(t,s)+coOutTemp('heating')*tempOut(t,s)
 922                                 =l=M*(1-h(t));
 923   
 924  ubpHVACONHeat(t,s)$ss(s).. pHVAC(t,s)=l=ratedHVACPower('Heating')*h(t)+c(t)*M;
 925  lbpHVACONHeat(t,s)$ss(s).. minHVACPower('Heating')*h(t)=l=pHVAC(t,s)+c(t)*M;
 926   
 927  * heating constraint regarding ancillary binary variable
 928  ancbin17(t,s)$(ord(t)>1 and ss(s))..  rmTempSP(t)-calRmTemp_noHeat(t,s) =l= M*(2-b3(t)-h(t));
 929  ancbin18(t,s)$(ord(t)>1 and ss(s))..  pHVAC(t,s) =l= M*(2-b3(t)-h(t));
 930  ancbin19(t,s)$(ord(t)>1 and ss(s))..  -pHVAC(t,s) =l= M*(2-b3(t)-h(t));
 931  ancbin20(t,s)$(ord(t)>1 and ss(s))..  rmTemp(t,s)-calRmTemp_noHeat(t,s) =l= M*(2-b3(t)-h(t));
 932  ancbin21(t,s)$(ord(t)>1 and ss(s))..  calRmTemp_noHeat(t,s)-rmTemp(t,s) =l= M*(2-b3(t)-h(t));
 933  ancbin22(t,s)$(ord(t)>1 and ss(s))..  calRmTemp_noHeat(t,s)-rmTempSP(t) =l= M*(1-h(t)+b3(t));
 934  ancbin23(t,s)$(ord(t)>1 and ss(s))..  ratedHVACPower('Heating')-calPHVAC_HeatSP(t,s) =l=M*(b3(t)+2-b4(t)-h(t));
 935  ancbin24(t,s)$(ord(t)>1 and ss(s))..  pHVAC(t,s)-ratedHVACPower('Heating') =l= M*(b3(t)+2-b4(t)-h(t));
 936  ancbin25(t,s)$(ord(t)>1 and ss(s))..  ratedHVACPower('Heating')-pHVAC(t,s) =l= M*(b3(t)+2-b4(t)-h(t));
 937  ancbin26(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-calRmTemp_ratedHeat(t,s) =l= M*(b3(t)+2-b4(t)-h(t));
 938  ancbin27(t,s)$(ord(t)>1 and ss(s)).. calRmTemp_ratedHeat(t,s)-rmTemp(t,s) =l= M*(b3(t)+2-b4(t)-h(t));
 939  ancbin28(t,s)$(ord(t)>1 and ss(s)).. calPHVAC_HeatSP(t,s)-ratedHVACPower('Heating') =l= M*(b3(t)+b4(t)+1-h(t));
 940  ancbin29(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s)-calPHVAC_HeatSP(t,s) =l= M*(b3(t)+b4(t)+1-h(t));
 941  ancbin30(t,s)$(ord(t)>1 and ss(s)).. calPHVAC_HeatSP(t,s)-pHVAC(t,s) =l= M*(b3(t)+b4(t)+1-h(t));
 942  ancbin31(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-rmTempSP(t) =l= M*(b3(t)+b4(t)+1-h(t));
 943  ancbin32(t,s)$(ord(t)>1 and ss(s)).. rmTempSP(t)-rmTemp(t,s) =l= M*(b3(t)+b4(t)+1-h(t));
 944   
 945  branch1(t,s)$((ord(t)>1  and ss(s))) .. h(t)=e=0;
 946   
 947  ***************************************** End HVAC Constraints **********************************************
 948   
 949   
 950   
 951   
 952  ***************************************** WH constraints chaned on 07-01-14***************************************************
 953  iniWHTempcon(nWH,t,ss)$(ord(t)=1).. WHTemp(nWH,t,ss) =e= iniWHTemp(nWH);
 954  ubWHtemp(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss) =l= desiredTEMP(t,'DESIRED_WH_TEMP')+s5(nWH,t,ss);
 955  lbWHtemp(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss) =g= desiredTEMP(t,'DESIRED_WH_TEMP')-s6(nWH,t,ss);
 956   
 957  *modified on 06-30-14
 958  ubWHSetTemp(nWH,t)$(ord(t)>1).. WHTempSP(nWH,t) =l= desiredTEMP(t,'DESIRED_WH_TEMP_UB');
 959  lbWHSetTemp(nWH,t)$(ord(t)>1).. WHTempSP(nWH,t) =g= desiredTEMP(t,'DESIRED_WH_TEMP_LB');
 960  thermEqWH(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss)=e=coWHTemp(nWH)*WHTemp(nWH,t-1,ss)+coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)+coWHPowerToTemp(nWH)*pWH(nWH,t,ss)+coWaterUsage(nWH)*waterUsage(t,ss)
 962  ;
 963   
 964   
 965   
 966  ************************   WH is OFF  *************************************
 967  ubpWHOFF1(nWH,t,ss)$(ord(t)>1).. pWH(nWH,t,ss) =l= M*WHON(nWH,t);
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 18
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 968  ubpWHOFF2(nWH,t,ss)$(ord(t)>1).. -pWH(nWH,t,ss) =l= M*WHON(nWH,t);
 969   
 970   
 971  *********************************   WH Heating   ***********************************************************************
 972   
 973  calWHTempNoHeating(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss) =e= coWHTemp(nWH)*WHTemp(nWH,t-1,ss)+coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)+coWaterUsage(nWH)*waterUsage(t,ss);
 974  calWHTempRatedHeating(nWH,t,ss)$(ord(t)>1).. calWHTemp_ratedHeat(nWH,t,ss)=e=coWHTemp(nWH)*WHTemp(nWH,t-1,ss)+coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)+coWHPowerToTemp(nWH)*ratedWHPower(nWH)+coWaterUsage(nWH)*waterUsage(t,ss);
 975  calPWHSP1(nWH,t,ss)$(ord(t)>1)..  calPWH_HeatSP(nWH,t,ss)-(WHTempSP(nWH,t)-coWHTemp(nWH)*WHTemp(nWH,t-1,ss)-coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)-coWaterUsage(nWH)*waterUsage(t,ss))/coWHPowerToTemp(nWH) =l= M*(1-WHON(nWH,t));
 976  calPWHSP2(nWH,t,ss)$(ord(t)>1)..  -calPWH_HeatSP(nWH,t,ss)+(WHTempSP(nWH,t)-coWHTemp(nWH)*WHTemp(nWH,t-1,ss)-coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)-coWaterUsage(nWH)*waterUsage(t,ss))/coWHPowerToTemp(nWH) =l= M*(1-WHON(nWH,t));
 977   
 978  *added on 03-06-2017
 979  extraWHCon1(nWH,t,ss)$(ord(t)>1)..  WHTempSP(nWH,t)-calWHTemp_noHeat(nWH,t,ss) =g= -M*(1-WHON(nWH,t));
 980  extraWHCon2(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss)-epsilon-WHTempSP(nWH,t) =g= -M*WHON(nWH,t);
 981   
 982  ubpWHONHeat(nWH,t,ss).. pWH(nWH,t,ss)=l=ratedWHPower(nWH)*WHON(nWH,t);
 983  lbpWHONHeat(nWH,t,ss).. pWH(nWH,t,ss)=g=minWHPower(nWH)*WHON(nWH,t);
 984  *added on 07-01-14
 985  AmbTempCal(nWH,t,ss).. WHAmbTemp(nWH,t,ss)=e=(rmTemp(t,ss)+tempOut(t,ss))/2;
 986   
 987  *WH constraint regarding ancillary binary variable
 988  ancbin1WH(nWH,t,ss)$(ord(t)>1)..  WHTempSP(nWH,t)-calWHTemp_noHeat(nWH,t,ss) =l= M*(2-bbb1(nWH,t)-WHON(nWH,t));
 989  ancbin2WH(nWH,t,ss)$(ord(t)>1)..  pWH(nWH,t,ss) =l= M*(2-bbb1(nWH,t)-WHON(nWH,t));
 990  ancbin3WH(nWH,t,ss)$(ord(t)>1)..  -pWH(nWH,t,ss) =l= M*(2-bbb1(nWH,t)-WHON(nWH,t));
 991  ancbin4WH(nWH,t,ss)$(ord(t)>1)..  WHTemp(nWH,t,ss)-calWHTemp_noHeat(nWH,t,ss) =l= M*(2-bbb1(nWH,t)-WHON(nWH,t));
 992  ancbin5WH(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss)-WHTemp(nWH,t,ss) =l= M*(2-bbb1(nWH,t)-WHON(nWH,t));
 993  ancbin6WH(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss)-WHTempSP(nWH,t) =l= M*(1+bbb1(nWH,t)-WHON(nWH,t));
 994  ancbin7WH(nWH,t,ss)$(ord(t)>1)..  ratedWHPower(nWH)-calPWH_HeatSP(nWH,t,ss) =l=M*(bbb1(nWH,t)+2-bbb2(nWH,t)-WHON(nWH,t));
 995  ancbin8WH(nWH,t,ss)$(ord(t)>1)..  pWH(nWH,t,ss)-ratedWHPower(nWH) =l= M*(bbb1(nWH,t)+2-bbb2(nWH,t)-WHON(nWH,t));
 996  ancbin9WH(nWH,t,ss)$(ord(t)>1)..  ratedWHPower(nWH)-pWH(nWH,t,ss) =l= M*(bbb1(nWH,t)+2-bbb2(nWH,t)-WHON(nWH,t));
 997  ancbin10WH(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss)-calWHTemp_ratedHeat(nWH,t,ss) =l= M*(bbb1(nWH,t)+2-bbb2(nWH,t)-WHON(nWH,t));
 998  ancbin11WH(nWH,t,ss)$(ord(t)>1).. calWHTemp_ratedHeat(nWH,t,ss)-WHTemp(nWH,t,ss) =l= M*(bbb1(nWH,t)+2-bbb2(nWH,t)-WHON(nWH,t));
 999  ancbin12WH(nWH,t,ss)$(ord(t)>1).. calPWH_HeatSP(nWH,t,ss)-ratedWHPower(nWH) =l= M*(bbb1(nWH,t)+bbb2(nWH,t)+1-WHON(nWH,t));
1000  ancbin13WH(nWH,t,ss)$(ord(t)>1).. pWH(nWH,t,ss)-calPWH_HeatSP(nWH,t,ss) =l= M*(bbb1(nWH,t)+bbb2(nWH,t)+1-WHON(nWH,t));
1001  ancbin14WH(nWH,t,ss)$(ord(t)>1).. calPWH_HeatSP(nWH,t,ss)-pWH(nWH,t,ss) =l= M*(bbb1(nWH,t)+bbb2(nWH,t)+1-WHON(nWH,t));
1002  ancbin15WH(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss)-WHTempSP(nWH,t) =l= M*(bbb1(nWH,t)+bbb2(nWH,t)+1-WHON(nWH,t));
1003  ancbin16WH(nWH,t,ss)$(ord(t)>1).. WHTempSP(nWH,t)-WHTemp(nWH,t,ss) =l= M*(bbb1(nWH,t)+bbb2(nWH,t)+1-WHON(nWH,t));
1004  ***************************************** End WH Constraints ***********************************************
1005   
1006  ****************************************** EV Constraints **************************************************
1007  EVSOCdynamicEq1Charge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. EVSOC(nEV,t,ss)-EVSOC(nEV,t-1,ss)-EVEff(nEV)*EVCharRate(nEV,t,ss)*intervalLength/EVCapac(nEV) =l= M*(1-EVChargeState(nEV,t));
1008  EVSOCdynamicEq2Charge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. -EVSOC(nEV,t,ss)+EVSOC(nEV,t-1,ss)+EVEff(nEV)*EVCharRate(nEV,t,ss)*intervalLength/EVCapac(nEV) =l= M*(1-EVChargeState(nEV,t));
1009  EVSOCdynamicEq1Discharge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. EVSOC(nEV,t,ss)-EVSOC(nEV,t-1,ss)+EVDischarRate(nEV,t,ss)*intervalLength/EVCapac(nEV)/EVEff(nEV)=l= M*(1-EVDischargeState(nEV,t));
1010  EVSOCdynamicEq2Discharge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. -EVSOC(nEV,t,ss)+EVSOC(nEV,t-1,ss)-EVDischarRate(nEV,t,ss)*intervalLength/EVCapac(nEV)/EVEff(nEV)=l= M*(1-EVDischargeState(nEV,t));
1011  EVSOCdynamicEq1Idle(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1)..  EVSOC(nEV,t,ss)-EVSOC(nEV,t-1,ss)=l= M*(EVChargeState(nEV,t)+EVDischargeState(nEV,t));
1012  EVSOCdynamicEq2Idle(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1)..  -EVSOC(nEV,t,ss)+EVSOC(nEV,t-1,ss)=l= M*(EVChargeState(nEV,t)+EVDischargeState(nEV,t));
1013  EVOfflineEq1(nEV,t,ss)$(ord(t)<StartChargeTime(nEV)+2 or ord(t)>StopChargeTime(nEV)+1).. EVCharRate(nEV,t,ss) =e= 0;
1014  EVOfflineEq2(nEV,t,ss)$(ord(t)<StartChargeTime(nEV)+2 or ord(t)>StopChargeTime(nEV)+1).. EVDischarRate(nEV,t,ss) =e= 0;
1015  EViniSOCEq(nEV,t,ss)$(ord(t)=StartChargeTime(nEV)+1).. EVSOC(nEV,t,ss)=e=StartChargeEVSOC(nEV);
1016   
1017  EVendSOCEq(nEV,t,ss)$(ord(t)=StopChargeTime(nEV)+1).. EVSOC(nEV,t,ss)=e=StopChargeEVSOC(nEV)-EVSOCSlack(t);
1018   
1019   
1020  EVubChargeCon(nEV,t,ss)$(ord(t)>1)..   EVCharRate(nEV,t,ss) =l= maxEVCharge(nEV)*EVChargeState(nEV,t);
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 19
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1021  EVlbChargeCon(nEV,t,ss)$(ord(t)>1)..   EVCharRate(nEV,t,ss) =g= minEVCharge(nEV)*EVChargeState(nEV,t);
1022  EVubDischargeCon(nEV,t,ss)$(ord(t)>1)..   EVDischarRate(nEV,t,ss) =l= maxEVDischarge(nEV)*EVDischargeState(nEV,t);
1023  EVlbDischargeCon(nEV,t,ss)$(ord(t)>1)..   EVDischarRate(nEV,t,ss) =g= minEVDischarge(nEV)*EVDischargeState(nEV,t);
1024  EVStateCon(nEV,t,ss)$(ord(t)>1)..  EVChargeState(nEV,t)+EVDischargeState(nEV,t) =l= 1;
1025  EVubSOC(nEV,t,ss)$((ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1))..  EVSOC(nEV,t,ss)=l=maxEVSOC(nEV);
1026  EVlbSOC(nEV,t,ss)$((ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1))..  EVSOC(nEV,t,ss)=g=minEVSOC(nEV);
1027   
1028  *added on 03-10-2015
1029  EVCharABS(nEV,t,ss)$((ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1)).. EVCharRate(nEV,t,ss)-EVCharRate(nEV,t-1,ss)=e=EVCharPosDiff(nEV,t,ss)-EVCharNegDiff(nEV,t,ss);
1030  EVDischarABS(nEV,t,ss)$((ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1)).. EVDisCharRate(nEV,t,ss)-EVDisCharRate(nEV,t-1,ss)=e=EVDischarPosDiff(nEV,t,ss)-EVDischarNegDiff(nEV,t,ss);
1031  *added on 04-08-2015 for battery degradation
1032  EVCostBD_Q_SOC_Con(nEV,ss).. CostBD_Q_SOC(nEV,ss)=e=sum(t$((ord(t)>=ArrEVTime(nEV)+2 and ord(t)<=DepEVTime(nEV)+1)), EVPar(nEV,'DEG_CBAT')*(EVPar(nEV,'DEG_M')*EVSOC(nEV,t,ss)-EVPar(nEV,'DEG_D'))*intervalLength/EVPar(nEV,'DEG_CFMAX')/15/8760);
1033  debug_1(nEV,ss).. debug_variable1(nEV,ss)=e=sum(t$((ord(t)>=ArrEVTime(nEV)+2 and ord(t)<=DepEVTime(nEV)+1)),intervalLength*(EVPar(nEV,'DEG_SLOPE_P')*EVCharRate(nEV,t,ss)*1000+0.0472));
1034  debug_2(nEV,ss).. debug_variable2(nEV,ss)=e=EVBDTMAX(nEV)*(EVPar(nEV,'DEG_SLOPE_P')*EVBDPMIN(nEV)+0.0472);
1035  EVCostBD_P_T_Con(nEV,ss).. CostBD_P_T(nEV,ss)=e=EVPar(nEV,'DEG_CBAT')*(sum(t$((ord(t)>=ArrEVTime(nEV)+2 and ord(t)<=DepEVTime(nEV)+1)),intervalLength*(EVPar(nEV,'DEG_SLOPE_P')*EVCharRate(nEV,t,ss)*1000+0.0472))-EVBDTMAX(nEV)*(EVPar(nEV,'DEG_SLOPE_P'
      )*EVBDPMIN(nEV)+0.0472));
1036  EVCostBD_Q_T_Con(nEV,ss).. CostBD_Q_T(nEV,ss)=e=EVPar(nEV,'DEG_CBAT')*(sum(t$((ord(t)>=ArrEVTime(nEV)+2 and ord(t)<=DepEVTime(nEV)+1)),intervalLength*(EVPar(nEV,'DEG_SLOPE_Q')*EVCharRate(nEV,t,ss)*1000+0.03627))-EVBDTMAX(nEV)*(EVPar(nEV,'DEG_SLOPE_Q
      ')*EVBDPMIN(nEV)+0.03627));
1037  EVCostBD_UP_Con1(nEV,ss).. CostBD_UB(nEV,ss) =g= CostBD_Q_T(nEV,ss)+ CostBD_Q_SOC(nEV,ss);
1038  EVCostBD_UP_Con2(nEV,ss).. CostBD_UB(nEV,ss) =g= CostBD_P_T(nEV,ss);
1039  ************************************************************************************************************
1040  ************************************************************************************************************
1041   
1042  *********************************** Storage constraints ****************************************************
1043  storSOCdynamicEq1Charge(nStorage,t,ss)$(ord(t)>1).. storSOC(nStorage,t,ss)-storSOC(nStorage,t-1,ss)-storEff(nStorage)*storCharRate(nStorage,t,ss)*intervalLength/storCapac(nStorage) =l= M*(1-storChargeState(nStorage,t));
1044  storSOCdynamicEq2Charge(nStorage,t,ss)$(ord(t)>1).. -storSOC(nStorage,t,ss)+storSOC(nStorage,t-1,ss)+storEff(nStorage)*storCharRate(nStorage,t,ss)*intervalLength/storCapac(nStorage) =l= M*(1-storChargeState(nStorage,t));
1045  storSOCdynamicEq1Discharge(nStorage,t,ss)$(ord(t)>1).. storSOC(nStorage,t,ss)-storSOC(nStorage,t-1,ss)+storDischarRate(nStorage,t,ss)*intervalLength/storCapac(nStorage)/storEff(nStorage)=l= M*(1-storDischargeState(nStorage,t));
1046  storSOCdynamicEq2Discharge(nStorage,t,ss)$(ord(t)>1).. -storSOC(nStorage,t,ss)+storSOC(nStorage,t-1,ss)-storDischarRate(nStorage,t,ss)*intervalLength/storCapac(nStorage)/storEff(nStorage)=l= M*(1-storDischargeState(nStorage,t));
1047  storSOCdynamicEq1Idle(nStorage,t,ss)$(ord(t)>1)..  storSOC(nStorage,t,ss)-storSOC(nStorage,t-1,ss)=l= M*(storChargeState(nStorage,t)+storDischargeState(nStorage,t));
1048  storSOCdynamicEq2Idle(nStorage,t,ss)$(ord(t)>1)..  -storSOC(nStorage,t,ss)+storSOC(nStorage,t-1,ss)=l= M*(storChargeState(nStorage,t)+storDischargeState(nStorage,t));
1049  storSOCCon(nStorage,t,ss)$(ord(t)>1).. storSOC(nStorage,t,ss) =l= 1;
1050  storIniSOCEq(nStorage,t,ss)$(ord(t)=1).. storSOC(nStorage,t,ss) =e= iniStorSOC(nStorage);
1051  storEndSOCEq(nStorage,t,ss)$(ord(t)=card(t)).. storSOC(nStorage,t,ss) =e= endStorSOC(nStorage);
1052  storubChargeCon(nStorage,t,ss)$(ord(t)>1)..   storCharRate(nStorage,t,ss) =l= maxstorCharge(nStorage)*storChargeState(nStorage,t);
1053  storlbChargeCon(nStorage,t,ss)$(ord(t)>1)..   storCharRate(nStorage,t,ss) =g= minStorCharge(nStorage)*storChargeState(nStorage,t);
1054  storubDischargeCon(nStorage,t,ss)$(ord(t)>1)..   storDischarRate(nStorage,t,ss) =l= maxStorDischarge(nStorage)*storDischargeState(nStorage,t);
1055  storlbDischargeCon(nStorage,t,ss)$(ord(t)>1)..   storDisCharRate(nStorage,t,ss) =g= minStorDischarge(nStorage)*storDischargeState(nStorage,t);
1056  storStateCon(nStorage,t,ss)$(ord(t)>1)..  storChargeState(nStorage,t)+storDischargeState(nStorage,t) =l= 1;
1057  storUbSOC(nStorage,t,ss)$(ord(t)>1)..  storSOC(nStorage,t,ss)=l=maxStorSOC(nStorage);
1058  storLbSOC(nStorage,t,ss)$(ord(t)>1)..  storSOC(nStorage,t,ss)=g=minStorSOC(nStorage);
1059   
1060  storCharABS(nStorage,t,ss)$(ord(t)>1).. storCharRate(nStorage,t,ss)-storCharRate(nStorage,t-1,ss)=e=storCharPosDiff(nStorage,t,ss)-storCharNegDiff(nStorage,t,ss);
1061  storDischarABS(nStorage,t,ss)$(ord(t)>1).. storDischarRate(nStorage,t,ss)-storDischarRate(nStorage,t-1,ss)=e=storDischarPosDiff(nStorage,t,ss)-storDischarNegDiff(nStorage,t,ss);
1062   
1063   
1064  *********************************** End Storage Constraints ************************************************
1065   
1066  *solve SHEMS using mip minimzing sumObj;
1067  parameter ubEnergyCost;
1068  parameter ubElecConsump;
1069  parameter ubCarbFoot;
1070  parameter ubPeakLoad;
1071  parameter ubDiscom;
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 20
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1072   
1073  scalar objcounter;
1074  objcounter=0;
1075   
1076  parameter ifSingleObjective;
1077  ifSingleObjective=0;
1078   
1079  if(coObj('ENERGY_COST')>0,
1080  objcounter=objcounter+1;
1081  );
1082   
1083  if(coObj('ELEC_CONSUMPTION')>0,
1084  objcounter=objcounter+1;
1085  );
1086   
1087  if(coObj('EMISSION')>0,
1088  objcounter=objcounter+1;
1089  );
1090   
1091  if(coObj('PEAK_LOAD')>0,
1092  objcounter=objcounter+1;
1093  );
1094   
1095  if(coObj('DISCOMFORT')>0,
1096  objcounter=objcounter+1;
1097  );
1098   
1099  * if single objective function
1100  if(objcounter=1,
1101           ifSingleObjective=1;
1102           ubEnergyCost=1;
1103           ubElecConsump=1;
1104           ubDiscom=1;
1105           ubPeakLoad=1;
1106           ubCarbFoot=1;
1107  );
1108   
1109  *Added on 07-02-14
1110  equations
1111  objDefSumObj
1112  ObjDefSumObjToGetDiscomUB
1113  fixObjDefSumObj
1114  fixSetTemp
1115  fixWHSetTemp
1116  ;
1117   
1118   
1119  ObjDefSumObjToGetDiscomUB..  sumObj =e= sum((t,ss)$(ord(t)>1),sceProbability(ss)*EPrice(t,ss)*(sum(nWH,pWH(nWH,t,ss))+pHVAC(t,ss))*intervalLength);
1120  fixSetTemp(t)$(ord(t)>1).. rmTempSP(t) =e= desiredTEMP(t,'DESIRED_COOLING_TEMP');
1121  fixWHSetTemp(nWH,t)$(ord(t)>1).. WHTempSP(nWH,t) =e= desiredTEMP(t,'DESIRED_WH_TEMP');
1122  HVACEnergyCostDef.. HVACEnergyCost =e=  sum((t,ss)$(ord(t)>1),sceProbability(ss)*EPrice(t,ss)*pHVAC(t,ss)*intervalLength);
1123  WHEnergyCostDef.. WHEnergyCost =e= sum((nWH,t,ss)$(ord(t)>1),sceProbability(ss)*EPrice(t,ss)*pWH(nWH,t,ss)*intervalLength);
1124   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 21
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1125   
1126   
1127  *first run: MINIMIZE THERMAL-APPLICANCE-ONLY ELECTRICITY COST TO GET DISCOMFORT UPPER BOUND
1128  model SHEMS_GETDISCOMUB/
1129  ObjDefSumObjToGetDiscomUB
1130  objDefEnerCost
1131  objDefDiscom
1132  objDefElecConsump
1133  objDefPeakLoad
1134  elecLoadBalanceCon
1135  HVACEnergyCostDef
1136  WHEnergyCostDef
1137   
1138  inirmTempcon
1139  thermEqONCool1
1140  thermEqONCool2
1141  ancON1
1142  ancON2
1143  ancON3
1144  ancON4
1145  thermEqOFF1
1146  thermEqOFF2 ubrmtemp lbrmtemp
1147  ubrmSetTemp lbrmSetTemp
1148  ubpHVACONCool
1149  lbpHVACONCool
1150  ubpHVACOFF1
1151  ubpHVACOFF2
1152  calRmTempNoCooling
1153  calRmTempRatedCooling
1154  calPHVACSP1
1155  calPHVACSP2
1156  ancbin1 ancbin2 ancbin3 ancbin4 ancbin5 ancbin6 ancbin7 ancbin8 ancbin9 ancbin10 ancbin11 ancbin12 ancbin13 ancbin14 ancbin15 ancbin16
1157  ubrmTemp1 lbrmTemp1
1158  extraCon1
1159  extraCon2
1160   
1161   
1162  iniWHTempcon
1163  thermEqWH
1164  ubWHtemp
1165  lbWHtemp
1166  ubWHSetTemp
1167  lbWHSetTemp
1168  ubpWHONHeat
1169  ubpWHOFF1
1170  ubpWHOFF2
1171  calWHTempNoHeating
1172  calWHTempRatedHeating
1173  calPWHSP1
1174  calPWHSP2
1175  ancbin1WH
1176  ancbin2WH
1177  ancbin3WH
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 22
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1178  ancbin4WH
1179  ancbin5WH
1180  ancbin6WH
1181  ancbin7WH
1182  ancbin8WH
1183  ancbin9WH
1184  ancbin10WH
1185  ancbin11WH
1186  ancbin12WH
1187  ancbin13WH
1188  ancbin14WH
1189  ancbin15WH
1190  ancbin16WH
1191  AmbTempCal
1192  lbpWHONHeat
1193  * added on 03-06-17
1194  extraWHCon1
1195  extraWHCon2
1196   
1199   
1200  /;
1201  SHEMS_GETDISCOMUB.OptCR=0.01;
1202  SHEMS_GETDISCOMUB.ResLim=60;
1203  * FIRST RUN to get the discomfort upper bound
1204   
1205  *if(coObj('DISCOMFORT')>0 and ifSingleObjective=0,
1206   
1207  *solve SHEMS_GETDISCOMUB using mip minimizing sumObj;
1208   
1209  *UbDiscom=discom.l;
1210  *else
1211  *UbDiscom=1;
1212  *);
1213   
1214  *display 'First Run Results (minimizing THERMAL-APPLICANCE-ONLY Electricity Cost)';
1215  *display sumObj.l, discom.l, ON.l, c.l, h.l,rmtemp.l,pHVAC.l;
1216   
1217   
1218  binary variable f_ON(t) HVAC ON=1 or OFF=0 state;
1219  binary variable f_c(t)  cooling state;
1220  binary variable f_h(t)  heating state;
1221  binary variable f_b1(t) cooling ancillary variables;
1222  binary variable f_b2(t) cooling ancillary variables;
1223  binary variable f_b3(t) heating ancillary variables;
1224  binary variable f_b4(t) heating ancillary variables;
1225   
1226   
1227  ********************************** End HVAC Variables ***********************************************************
1228   
1229  ***********************************  WH variables  **************************************************************
1230  binary variable f_WHON(nWH,t);
1231  binary variable f_bbb1(nWH,t);
1232  binary variable f_bbb2(nWH,t);
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 23
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1233   
1234  ***********************************  End WH variables  **************************************************************
1235   
1236  ***********************************  EV variables  ***************************************************************
1237   
1238  binary variable f_EVChargeState(nEV,t);
1239  binary variable f_EVDischargeState(nEV,t);
1240   
1241  ***********************************  End of EV variables *********************************************************
1242  *********************************** Storage variables ************************************************************
1243   
1244  binary variable f_storChargeState(nStorage,t);
1245  binary variable f_storDischargeState(nStorage,t);
1246   
1247  *********************************** end storage variables ********************************************************
1248   
1249   
1250  **********************************  HVAC equaitons ***********************************************************
1251  equations
1252  f_thermEqONCool1
1253  f_thermEqONCool2
1254  f_ancON1
1255  f_ancON2
1256  f_ancON3
1257  f_ancON4
1258  f_thermEqOFF1
1259  f_thermEqOFF2
1260  f_ubpHVACONCool                  upper bound of HVAC power
1261  f_lbpHVACONCool
1262  f_ubpHVACOFF1
1263  f_ubpHVACOFF2
1264  f_calPHVACSP1
1265  f_calPHVACSP2               calculate power consumption of HVAC system with room temperature setpoint
1266  f_ancbin1
1267  f_ancbin2
1268  f_ancbin3
1269  f_ancbin4
1270  f_ancbin5
1271  f_ancbin6
1272  f_ancbin7
1273  f_ancbin8
1274  f_ancbin9
1275  f_ancbin10
1276  f_ancbin11
1277  f_ancbin12
1278  f_ancbin13
1279  f_ancbin14
1280  f_ancbin15
1281  f_ancbin16
1282  f_extraCon1
1283  f_extraCon2
1284  ;
1285   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 24
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1286  equations
1287  f_calPHVACHeatSP1               calculate power consumption of HVAC system with room temperature setpoint
1288  f_calPHVACHeatSP2
1289  f_thermEqONHeat1
1290  f_thermEqONHeat2
1291  f_ubpHVACONHeat
1292  f_lbpHVACONHeat
1293  f_ancbin17
1294  f_ancbin18
1295  f_ancbin19
1296  f_ancbin20
1297  f_ancbin21
1298  f_ancbin22
1299  f_ancbin23
1300  f_ancbin24
1301  f_ancbin25
1302  f_ancbin26
1303  f_ancbin27
1304  f_ancbin28
1305  f_ancbin29
1306  f_ancbin30
1307  f_ancbin31
1308  f_ancbin32
1309  f_lbrmSetPoint1
1310  f_lbrmSetPoint2
1311  f_branch1
1312  ;
1313  **********************************  End HVAC Equations ***********************************************************
1314   
1315  ************************************* WH equations *************************************************************
1316  Equations
1317  f_ubpWHONHeat
1318  f_ubpWHOFF1
1319  f_ubpWHOFF2
1320  f_calPWHSP1
1321  f_calPWHSP2
1322  f_ancbin1WH
1323  f_ancbin2WH
1324  f_ancbin3WH
1325  f_ancbin4WH
1326  f_ancbin5WH
1327  f_ancbin6WH
1328  f_ancbin7WH
1329  f_ancbin8WH
1330  f_ancbin9WH
1331  f_ancbin10WH
1332  f_ancbin11WH
1333  f_ancbin12WH
1334  f_ancbin13WH
1335  f_ancbin14WH
1336  f_ancbin15WH
1337  f_ancbin16WH
1338  f_lbWHSetPoint1
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 25
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1339  f_lbWHSetPoint2
1340  f_lbpWHONHeat
1341  f_extraWHCon1
1342  f_extraWHCon2
1343  ;
1344  ************************************* End WH equations *********************************************************
1345   
1346  ************************************* EV equations *************************************************************
1347  equations
1348  f_EVSOCdynamicEq1Charge
1349  f_EVSOCdynamicEq2Charge
1350  f_EVSOCdynamicEq1Discharge
1351  f_EVSOCdynamicEq2Discharge
1352  f_EVSOCdynamicEq1Idle
1353  f_EVSOCdynamicEq2Idle
1354  f_EVubChargeCon
1355  f_EVlbChargeCon
1356  f_EVubDischargeCon
1357  f_EVlbDischargeCon
1358  f_EVStateCon
1359  ;
1360   
1361  ****************************************************************************************************************
1362  ************************************** Storage Equations *******************************************************
1363  equations
1364  f_storSOCdynamicEq1Charge
1365  f_storSOCdynamicEq2Charge
1366  f_storSOCdynamicEq1Discharge
1367  f_storSOCdynamicEq2Discharge
1368  f_storSOCdynamicEq1Idle
1369  f_storSOCdynamicEq2Idle
1370  f_storUbChargeCon
1371  f_storLbChargeCon
1372  f_storUbDischargeCon
1373  f_storLbDischargeCon
1374  f_storStateCon
1375  ;
1376  ************************************** End Storage Equations ***************************************************
1377   
1378   
1379  *added on 02-04-15
1380  f_thermEqOFF1(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-coRmTemp('cooling')*rmTemp(t-1,s)-coOutTemp('cooling')*tempOut(t,s)-coSolarInsolation('cooling')*solarIns(t,s)-coInternalSource('cooling')*interSource(t,s) =l=M*f_ON(t);
1381  f_thermEqOFF2(t,s)$(ord(t)>1 and ss(s)).. -rmTemp(t,s)+coRmTemp('cooling')*rmTemp(t-1,s)+coOutTemp('cooling')*tempOut(t,s)+coSolarInsolation('cooling')*solarIns(t,s)+coInternalSource('cooling')*interSource(t,s) =l=M*f_ON(t);
1382  *end added
1383   
1384  f_ubpHVACOFF1(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s) =l= M*f_ON(t);
1385  f_ubpHVACOFF2(t,s)$(ord(t)>1  and ss(s)).. -pHVAC(t,s) =l= M*f_ON(t);
1386   
1387  ************************   End of HVAC is OFF  *************************************
1388   
1389  ************************   HVAC is ON  *************************************
1390  f_ancON1(t)$(ord(t)>1)..  f_c(t)-1 =l= M*(1-f_ON(t));
1391  f_ancON2(t)$(ord(t)>1)..  -f_c(t)+1 =l= M*(1-f_ON(t));
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 26
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1392  f_ancON3(t)$(ord(t)>1).. f_c(t) =l= M*f_ON(t);
1393  f_ancON4(t)$(ord(t)>1).. -f_c(t) =l= M*f_ON(t);
1394   
1395  *added on 11-17-14
1396  f_extraCon1(t,ss)$(ord(t)>1)..  rmTempSP(t)-calRmTemp_noCool(t,ss) =l= M*(1-f_c(t));
1397  f_extraCon2(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss)+epsilon-rmTempSP(t) =l= M*f_c(t);
1398   
1399  *end added on 11-17-14
1400   
1401   
1402  **added on 02-04-15
1403  f_calPHVACSP1(t,ss)$(ord(t)>1)..  calPHVAC_CoolSP(t,ss)-(rmTempSP(t)-coRmTemp('cooling')*rmTemp(t-1,ss)-coOutTemp('cooling')*tempOut(t,ss)-coSolarInsolation('cooling')*solarIns(t,ss)-coInternalSource('cooling')*interSource(t,ss))/coPowerToTemp('Cool
      ing') =l= 0;
1404  f_calPHVACSP2(t,ss)$(ord(t)>1)..  -calPHVAC_CoolSP(t,ss)+(rmTempSP(t)-coRmTemp('cooling')*rmTemp(t-1,ss)-coOutTemp('cooling')*tempOut(t,ss)-coSolarInsolation('cooling')*solarIns(t,ss)-coInternalSource('cooling')*interSource(t,ss))/coPowerToTemp('Coo
      ling') =l= 0;
1405  *Cooling Constraint when ON(t) and c(t) are both equal to 1
1406  f_thermEqONCool1(t,ss)$(ord(t)>1).. rmTemp(t,ss)-coRmTemp('cooling')*rmTemp(t-1,ss)-coPowerToTemp('Cooling')*pHVAC(t,ss)-coOutTemp('cooling')*tempOut(t,ss)-coSolarInsolation('cooling')*solarIns(t,ss)-coInternalSource('cooling')*interSource(t,ss) =l=
      0;
1407  f_thermEqONCool2(t,ss)$(ord(t)>1).. -rmTemp(t,ss)+coRmTemp('cooling')*rmTemp(t-1,ss)+coPowerToTemp('Cooling')*pHVAC(t,ss)+coOutTemp('cooling')*tempOut(t,ss)+coSolarInsolation('cooling')*solarIns(t,ss)+coInternalSource('cooling')*interSource(t,ss) =l
      =0;
1408  **end added
1409   
1410   
1411  f_ubpHVACONCool(t,ss).. pHVAC(t,ss)=l=ratedHVACPower('Cooling');
1412  f_lbpHVACONCool(t,ss).. 0=l=pHVAC(t,ss);
1413   
1414  *Cooling constraint regarding ancillary binary variable
1415  f_ancbin1(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss)-rmTempSP(t) =l= M*(1-f_b1(t));
1416  f_ancbin2(t,ss)$(ord(t)>1)..  pHVAC(t,ss) =l= M*(1-f_b1(t));
1417  f_ancbin3(t,ss)$(ord(t)>1)..  -pHVAC(t,ss) =l= M*(1-f_b1(t));
1418  f_ancbin4(t,ss)$(ord(t)>1)..  rmTemp(t,ss)-calRmTemp_noCool(t,ss) =l= M*(1-f_b1(t));
1419  f_ancbin5(t,ss)$(ord(t)>1)..  calRmTemp_noCool(t,ss)-rmTemp(t,ss) =l= M*(1-f_b1(t));
1420  f_ancbin6(t,ss)$(ord(t)>1)..  rmTempSP(t)+epsilon-calRmTemp_noCool(t,ss) =l= M*(f_b1(t));
1421  f_ancbin7(t,ss)$(ord(t)>1)..  ratedHVACPower('Cooling')-calPHVAC_CoolSP(t,ss) =l=M*(f_b1(t)+1-f_b2(t));
1422  f_ancbin8(t,ss)$(ord(t)>1)..  pHVAC(t,ss)-ratedHVACPower('Cooling') =l= M*(f_b1(t)+1-f_b2(t));
1423  f_ancbin9(t,ss)$(ord(t)>1)..  ratedHVACPower('Cooling')-pHVAC(t,ss) =l= M*(f_b1(t)+1-f_b2(t));
1424  f_ancbin10(t,ss)$(ord(t)>1).. rmTemp(t,ss)-calRmTemp_ratedCool(t,ss) =l= M*(f_b1(t)+1-f_b2(t));
1425  f_ancbin11(t,ss)$(ord(t)>1).. calRmTemp_ratedCool(t,ss)-rmTemp(t,ss) =l= M*(f_b1(t)+1-f_b2(t));
1426  f_ancbin12(t,ss)$(ord(t)>1).. calPHVAC_CoolSP(t,ss)+epsilon-ratedHVACPower('Cooling') =l= M*(f_b1(t)+f_b2(t));
1427  f_ancbin13(t,ss)$(ord(t)>1).. pHVAC(t,ss)-calPHVAC_CoolSP(t,ss) =l= M*(f_b1(t)+f_b2(t));
1428  f_ancbin14(t,ss)$(ord(t)>1).. calPHVAC_CoolSP(t,ss)-pHVAC(t,ss) =l= M*(f_b1(t)+f_b2(t));
1429  f_ancbin15(t,ss)$(ord(t)>1).. rmTemp(t,ss)-rmTempSP(t) =l= M*(f_b1(t)+f_b2(t));
1430  f_ancbin16(t,ss)$(ord(t)>1).. rmTempSP(t)-rmTemp(t,ss) =l= M*(f_b1(t)+f_b2(t));
1431   
1432  *********************************   Heating   ***********************************************************************
1433  f_calPHVACHeatSP1(t,s)$(ord(t)>1 and ss(s))..  calpHVAC_HeatSP(t,s)-(rmTempSP(t)-coRmTemp('heating')*rmTemp(t-1,s)-coOutTemp('heating')*tempOut(t,s))/coPowerToTemp('heating') =l= M*(1-f_h(t));
1434  f_calPHVACHeatSP2(t,s)$(ord(t)>1 and ss(s))..  -calpHVAC_HeatSP(t,s)+(rmTempSP(t)-coRmTemp('heating')*rmTemp(t-1,s)-coOutTemp('heating')*tempOut(t,s))/coPowerToTemp('heating') =l= M*(1-f_h(t));
1435   
1436  *the following is to consider CHP revised on 05-20-2014
1437  f_thermEqONHeat1(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-coRmTemp('heating')*rmTemp(t-1,s)-coPowerToTemp('heating')*pHVAC(t,s)-coOutTemp('heating')*tempOut(t,s)
1439                                 =l=M*(1-f_h(t));
1440  f_thermEqONHeat2(t,s)$(ord(t)>1 and ss(s)).. -rmTemp(t,s)+coRmTemp('heating')*rmTemp(t-1,s)+coPowerToTemp('heating')*pHVAC(t,s)+coOutTemp('heating')*tempOut(t,s)
1442                                 =l=M*(1-f_h(t));
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 27
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1443   
1444  f_ubpHVACONHeat(t,s)$ss(s).. pHVAC(t,s)=l=ratedHVACPower('Heating')*f_h(t)+f_c(t)*M;
1445  f_lbpHVACONHeat(t,s)$ss(s).. minHVACPower('Heating')*f_h(t)=l=pHVAC(t,s)+f_c(t)*M;
1446   
1447  * heating constraint regarding ancillary binary variable
1448  f_ancbin17(t,s)$(ord(t)>1 and ss(s))..  rmTempSP(t)-calRmTemp_noHeat(t,s) =l= M*(2-f_b3(t)-f_h(t));
1449  f_ancbin18(t,s)$(ord(t)>1 and ss(s))..  pHVAC(t,s) =l= M*(2-f_b3(t)-f_h(t));
1450  f_ancbin19(t,s)$(ord(t)>1 and ss(s))..  -pHVAC(t,s) =l= M*(2-f_b3(t)-f_h(t));
1451  f_ancbin20(t,s)$(ord(t)>1 and ss(s))..  rmTemp(t,s)-calRmTemp_noHeat(t,s) =l= M*(2-f_b3(t)-f_h(t));
1452  f_ancbin21(t,s)$(ord(t)>1 and ss(s))..  calRmTemp_noHeat(t,s)-rmTemp(t,s) =l= M*(2-f_b3(t)-f_h(t));
1453  f_ancbin22(t,s)$(ord(t)>1 and ss(s))..  calRmTemp_noHeat(t,s)-rmTempSP(t) =l= M*(1-f_h(t)+f_b3(t));
1454  f_ancbin23(t,s)$(ord(t)>1 and ss(s))..  ratedHVACPower('Heating')-calPHVAC_HeatSP(t,s) =l=M*(f_b3(t)+2-f_b4(t)-f_h(t));
1455  f_ancbin24(t,s)$(ord(t)>1 and ss(s))..  pHVAC(t,s)-ratedHVACPower('Heating') =l= M*(f_b3(t)+2-f_b4(t)-f_h(t));
1456  f_ancbin25(t,s)$(ord(t)>1 and ss(s))..  ratedHVACPower('Heating')-pHVAC(t,s) =l= M*(f_b3(t)+2-f_b4(t)-f_h(t));
1457  f_ancbin26(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-calRmTemp_ratedHeat(t,s) =l= M*(f_b3(t)+2-f_b4(t)-f_h(t));
1458  f_ancbin27(t,s)$(ord(t)>1 and ss(s)).. calRmTemp_ratedHeat(t,s)-rmTemp(t,s) =l= M*(f_b3(t)+2-f_b4(t)-f_h(t));
1459  f_ancbin28(t,s)$(ord(t)>1 and ss(s)).. calPHVAC_HeatSP(t,s)-ratedHVACPower('Heating') =l= M*(f_b3(t)+f_b4(t)+1-f_h(t));
1460  f_ancbin29(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s)-calPHVAC_HeatSP(t,s) =l= M*(f_b3(t)+f_b4(t)+1-f_h(t));
1461  f_ancbin30(t,s)$(ord(t)>1 and ss(s)).. calPHVAC_HeatSP(t,s)-pHVAC(t,s) =l= M*(f_b3(t)+f_b4(t)+1-f_h(t));
1462  f_ancbin31(t,s)$(ord(t)>1 and ss(s)).. rmTemp(t,s)-rmTempSP(t) =l= M*(f_b3(t)+f_b4(t)+1-f_h(t));
1463  f_ancbin32(t,s)$(ord(t)>1 and ss(s)).. rmTempSP(t)-rmTemp(t,s) =l= M*(f_b3(t)+f_b4(t)+1-f_h(t));
1464   
1465  f_branch1(t,s)$((ord(t)>1  and ss(s))) .. f_h(t)=e=0;
1466   
1467  ************************   WH is OFF  *************************************
1468  f_ubpWHOFF1(nWH,t,ss)$(ord(t)>1).. pWH(nWH,t,ss) =l= M*f_WHON(nWH,t);
1469  f_ubpWHOFF2(nWH,t,ss)$(ord(t)>1).. -pWH(nWH,t,ss) =l= M*f_WHON(nWH,t);
1470   
1471  *added on 06-30-14
1472  f_lbWHSetPoint1(nWH,t,ss)$(ord(t)>1).. WHTempSP(nWH,t)-desiredTEMP(t,'DESIRED_WH_TEMP_LB')=l=M*f_WHON(nWH,t);
1473  f_lbWHSetPoint2(nWH,t,ss)$(ord(t)>1).. -WHTempSP(nWH,t)+desiredTEMP(t,'DESIRED_WH_TEMP_LB')=l=M*f_WHON(nWH,t);
1474   
1475   
1476   
1477  *********************************   WH Heating   ***********************************************************************
1478  f_calPWHSP1(nWH,t,ss)$(ord(t)>1)..  calPWH_HeatSP(nWH,t,ss)-(WHTempSP(nWH,t)-coWHTemp(nWH)*WHTemp(nWH,t-1,ss)-coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)-coWaterUsage(nWH)*waterUsage(t,ss))/coWHPowerToTemp(nWH) =l= M*(1-f_WHON(nWH,t));
1479  f_calPWHSP2(nWH,t,ss)$(ord(t)>1)..  -calPWH_HeatSP(nWH,t,ss)+(WHTempSP(nWH,t)-coWHTemp(nWH)*WHTemp(nWH,t-1,ss)-coWHAmbTemp(nWH)*WHAmbTemp(nWH,t,ss)-coWaterUsage(nWH)*waterUsage(t,ss))/coWHPowerToTemp(nWH) =l= M*(1-f_WHON(nWH,t));
1480  f_ubpWHONHeat(nWH,t,ss).. pWH(nWH,t,ss)=l=ratedWHPower(nWH)*f_WHON(nWH,t);
1481  f_lbpWHONHeat(nWH,t,ss).. pWH(nWH,t,ss)=g=minWHPower(nWH)*f_WHON(nWH,t);
1482   
1483  *added on 03-06-2017
1484  f_extraWHCon1(nWH,t,ss)$(ord(t)>1)..  WHTempSP(nWH,t)-calWHTemp_noHeat(nWH,t,ss) =g= -M*(1-f_WHON(nWH,t));
1485  f_extraWHCon2(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss)-epsilon-WHTempSP(nWH,t) =g= -M*f_WHON(nWH,t);
1486   
1487   
1488  f_ancbin1WH(nWH,t,ss)$(ord(t)>1)..  WHTempSP(nWH,t)-calWHTemp_noHeat(nWH,t,ss) =l= M*(2-f_bbb1(nWH,t)-f_WHON(nWH,t));
1489  f_ancbin2WH(nWH,t,ss)$(ord(t)>1)..  pWH(nWH,t,ss) =l= M*(2-f_bbb1(nWH,t)-f_WHON(nWH,t));
1490  f_ancbin3WH(nWH,t,ss)$(ord(t)>1)..  -pWH(nWH,t,ss) =l= M*(2-f_bbb1(nWH,t)-f_WHON(nWH,t));
1491  f_ancbin4WH(nWH,t,ss)$(ord(t)>1)..  WHTemp(nWH,t,ss)-calWHTemp_noHeat(nWH,t,ss) =l= M*(2-f_bbb1(nWH,t)-f_WHON(nWH,t));
1492  f_ancbin5WH(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss)-WHTemp(nWH,t,ss) =l= M*(2-f_bbb1(nWH,t)-f_WHON(nWH,t));
1493  f_ancbin6WH(nWH,t,ss)$(ord(t)>1)..  calWHTemp_noHeat(nWH,t,ss)-WHTempSP(nWH,t) =l= M*(1+f_bbb1(nWH,t)-f_WHON(nWH,t));
1494  f_ancbin7WH(nWH,t,ss)$(ord(t)>1)..  ratedWHPower(nWH)-calPWH_HeatSP(nWH,t,ss) =l=M*(f_bbb1(nWH,t)+2-f_bbb2(nWH,t)-f_WHON(nWH,t));
1495  f_ancbin8WH(nWH,t,ss)$(ord(t)>1)..  pWH(nWH,t,ss)-ratedWHPower(nWH) =l= M*(f_bbb1(nWH,t)+2-f_bbb2(nWH,t)-f_WHON(nWH,t));
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 28
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1496  f_ancbin9WH(nWH,t,ss)$(ord(t)>1)..  ratedWHPower(nWH)-pWH(nWH,t,ss) =l= M*(f_bbb1(nWH,t)+2-f_bbb2(nWH,t)-f_WHON(nWH,t));
1497  f_ancbin10WH(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss)-calWHTemp_ratedHeat(nWH,t,ss) =l= M*(f_bbb1(nWH,t)+2-f_bbb2(nWH,t)-f_WHON(nWH,t));
1498  f_ancbin11WH(nWH,t,ss)$(ord(t)>1).. calWHTemp_ratedHeat(nWH,t,ss)-WHTemp(nWH,t,ss) =l= M*(f_bbb1(nWH,t)+2-f_bbb2(nWH,t)-f_WHON(nWH,t));
1499  f_ancbin12WH(nWH,t,ss)$(ord(t)>1).. calPWH_HeatSP(nWH,t,ss)-ratedWHPower(nWH) =l= M*(f_bbb1(nWH,t)+f_bbb2(nWH,t)+1-f_WHON(nWH,t));
1500  f_ancbin13WH(nWH,t,ss)$(ord(t)>1).. pWH(nWH,t,ss)-calPWH_HeatSP(nWH,t,ss) =l= M*(f_bbb1(nWH,t)+f_bbb2(nWH,t)+1-f_WHON(nWH,t));
1501  f_ancbin14WH(nWH,t,ss)$(ord(t)>1).. calPWH_HeatSP(nWH,t,ss)-pWH(nWH,t,ss) =l= M*(f_bbb1(nWH,t)+f_bbb2(nWH,t)+1-f_WHON(nWH,t));
1502  f_ancbin15WH(nWH,t,ss)$(ord(t)>1).. WHTemp(nWH,t,ss)-WHTempSP(nWH,t) =l= M*(f_bbb1(nWH,t)+f_bbb2(nWH,t)+1-f_WHON(nWH,t));
1503  f_ancbin16WH(nWH,t,ss)$(ord(t)>1).. WHTempSP(nWH,t)-WHTemp(nWH,t,ss) =l= M*(f_bbb1(nWH,t)+f_bbb2(nWH,t)+1-f_WHON(nWH,t));
1504  ***************************************** End WH Constraints ***********************************************
1505   
1506  ****************************************** EV Constraints **************************************************
1507   
1508  f_EVSOCdynamicEq1Charge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. EVSOC(nEV,t,ss)-EVSOC(nEV,t-1,ss)-EVEff(nEV)*EVCharRate(nEV,t,ss)*intervalLength/EVCapac(nEV) =l= M*(1-f_EVChargeState(nEV,t));
1509  f_EVSOCdynamicEq2Charge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. -EVSOC(nEV,t,ss)+EVSOC(nEV,t-1,ss)+EVEff(nEV)*EVCharRate(nEV,t,ss)*intervalLength/EVCapac(nEV) =l= M*(1-f_EVChargeState(nEV,t));
1510  f_EVSOCdynamicEq1Discharge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. EVSOC(nEV,t,ss)-EVSOC(nEV,t-1,ss)+EVDischarRate(nEV,t,ss)*intervalLength/EVCapac(nEV)/EVEff(nEV)=l= M*(1-f_EVDischargeState(nEV,t));
1511  f_EVSOCdynamicEq2Discharge(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1).. -EVSOC(nEV,t,ss)+EVSOC(nEV,t-1,ss)-EVDischarRate(nEV,t,ss)*intervalLength/EVCapac(nEV)/EVEff(nEV)=l= M*(1-f_EVDischargeState(nEV,t));
1512  f_EVSOCdynamicEq1Idle(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1)..  EVSOC(nEV,t,ss)-EVSOC(nEV,t-1,ss)=l= M*(f_EVChargeState(nEV,t)+f_EVDischargeState(nEV,t));
1513  f_EVSOCdynamicEq2Idle(nEV,t,ss)$(ord(t)>=StartChargeTime(nEV)+2 and ord(t)<=StopChargeTime(nEV)+1)..  -EVSOC(nEV,t,ss)+EVSOC(nEV,t-1,ss)=l= M*(f_EVChargeState(nEV,t)+f_EVDischargeState(nEV,t));
1514  f_EVubChargeCon(nEV,t,ss)$(ord(t)>1)..   EVCharRate(nEV,t,ss) =l= maxEVCharge(nEV)*f_EVChargeState(nEV,t);
1515  f_EVlbChargeCon(nEV,t,ss)$(ord(t)>1)..   EVCharRate(nEV,t,ss) =g= minEVCharge(nEV)*f_EVChargeState(nEV,t);
1516  f_EVubDischargeCon(nEV,t,ss)$(ord(t)>1)..   EVDischarRate(nEV,t,ss) =l= maxEVDischarge(nEV)*f_EVDischargeState(nEV,t);
1517  f_EVlbDischargeCon(nEV,t,ss)$(ord(t)>1)..   EVDischarRate(nEV,t,ss) =g= minEVDischarge(nEV)*f_EVDischargeState(nEV,t);
1518  f_EVStateCon(nEV,t,ss)$(ord(t)>1)..  f_EVChargeState(nEV,t)+f_EVDischargeState(nEV,t) =l= 1;
1519   
1520   
1521  ************************************************************************************************************
1522  *********************************** Storage constraints ****************************************************
1523  f_storSOCdynamicEq1Charge(nStorage,t,ss)$(ord(t)>1).. storSOC(nStorage,t,ss)-storSOC(nStorage,t-1,ss)-storEff(nStorage)*storCharRate(nStorage,t,ss)*intervalLength/storCapac(nStorage) =l= M*(1-f_storChargeState(nStorage,t));
1524  f_storSOCdynamicEq2Charge(nStorage,t,ss)$(ord(t)>1).. -storSOC(nStorage,t,ss)+storSOC(nStorage,t-1,ss)+storEff(nStorage)*storCharRate(nStorage,t,ss)*intervalLength/storCapac(nStorage) =l= M*(1-f_storChargeState(nStorage,t));
1525  f_storSOCdynamicEq1Discharge(nStorage,t,ss)$(ord(t)>1).. storSOC(nStorage,t,ss)-storSOC(nStorage,t-1,ss)+storDischarRate(nStorage,t,ss)*intervalLength/storCapac(nStorage)/storEff(nStorage)=l= M*(1-f_storDischargeState(nStorage,t));
1526  f_storSOCdynamicEq2Discharge(nStorage,t,ss)$(ord(t)>1).. -storSOC(nStorage,t,ss)+storSOC(nStorage,t-1,ss)-storDischarRate(nStorage,t,ss)*intervalLength/storCapac(nStorage)/storEff(nStorage)=l= M*(1-f_storDischargeState(nStorage,t));
1527  f_storSOCdynamicEq1Idle(nStorage,t,ss)$(ord(t)>1)..  storSOC(nStorage,t,ss)-storSOC(nStorage,t-1,ss)=l= M*(f_storChargeState(nStorage,t)+f_storDischargeState(nStorage,t));
1528  f_storSOCdynamicEq2Idle(nStorage,t,ss)$(ord(t)>1)..  -storSOC(nStorage,t,ss)+storSOC(nStorage,t-1,ss)=l= M*(f_storChargeState(nStorage,t)+f_storDischargeState(nStorage,t));
1529  f_storubChargeCon(nStorage,t,ss)$(ord(t)>1)..   storCharRate(nStorage,t,ss) =l= maxstorCharge(nStorage)*f_storChargeState(nStorage,t);
1530  f_storlbChargeCon(nStorage,t,ss)$(ord(t)>1)..   storCharRate(nStorage,t,ss) =g= minStorCharge(nStorage)*f_storChargeState(nStorage,t);
1531  f_storubDischargeCon(nStorage,t,ss)$(ord(t)>1)..   storDischarRate(nStorage,t,ss) =l= maxStorDischarge(nStorage)*f_storDischargeState(nStorage,t);
1532  f_storlbDischargeCon(nStorage,t,ss)$(ord(t)>1)..   storDisCharRate(nStorage,t,ss) =g= minStorDischarge(nStorage)*f_storDischargeState(nStorage,t);
1533  f_storStateCon(nStorage,t,ss)$(ord(t)>1)..  f_storChargeState(nStorage,t)+f_storDischargeState(nStorage,t) =l= 1;
1534   
1535  *********************************** End Storage Constraints ************************************************
1536   
1537   
1538  ************************** added on 12-10-2014
1539  positive variable posDiff(t);
1540  positive variable negDiff(t);
1541  binary variable ifrated(t),ifzero(t);
1542  variable sumObjDisp;
1543  equations
1544  SumobjdispDef
1545  ABSDIFF
1546  SPTOUB1
1547  SPTOUB2
1548  SPTOUB3
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 29
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1549  SPTOUB4
1550  SPTOUB5
1551  SPTOLB1
1552  SPTOLB2
1553  SPTOLB3
1554  SPTOLB4
1555  SPTOLB5;
1556   
1557   
1558  ABSDIFF(t)$(ord(t)>1).. rmTempSP(t)-rmTempUB(t)=e=posDiff(t)-negDiff(t);
1559   
1560  SPTOUB1(t)$(ord(t)>1).. rmTempSP(t)-rmTempUB(t)=l=(1-ifzero(t))*M;
1561  SPTOUB2(t)$(ord(t)>1).. rmTempUB(t)-rmTempSP(t)=l=(1-ifzero(t))*M;
1562  SPTOUB3(t,s)$(ord(t)>1 and ss(s)).. epsilon-pHVAC(t,s)=l=ifzero(t)*M;
1563  SPTOUB4(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s)=l=(1-ifzero(t))*M;
1564  SPTOUB5(t)$(ord(t)>1).. ifzero(t)+f_ON(t)=e=1;
1565  SPTOLB1(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s)-ratedHVACPower('Cooling')=l=(1-ifrated(t))*M;
1566  SPTOLB2(t,s)$(ord(t)>1 and ss(s)).. ratedHVACPower('Cooling')-pHVAC(t,s)=l=(1-ifrated(t))*M;
1567  SPTOLB5(t,s)$(ord(t)>1 and ss(s)).. pHVAC(t,s)+epsilon-ratedHVACPower('Cooling')=l=ifrated(t)*M;
1568  SPTOLB3(t)$(ord(t)>1).. rmTempLB(t)-rmTempSP(t)=l=(1-ifrated(t))*M;
1569  SPTOLB4(t)$(ord(t)>1).. rmTempSP(t)-rmTempLB(t)=l=(1-ifrated(t))*M;
1570   
1571  SumObjdispDef..  sumObjDisp =e= sumObj+sum(t$(ord(t)=2),0.01*(posDiff(t)+negDiff(t)));
1572  *********************** added on 12-10-2014
1573   
1574  *MINIMIZE OVERALL MODEL DISCOMFORT TO GET OVERALL MODEL ENERGY COST UPPER BOUND
1575  model SHEMS_GET4OBJUB /
1576   
1577  SPTOUB1
1578  SPTOUB2
1579  SPTOUB3
1580  SPTOUB4
1581  SPTOLB1
1582  SPTOLB2
1583  SPTOLB3
1584  SPTOLB4
1585  SPTOLB5
1586   
1587   
1588  objDefEnerCost
1589  objDefDiscom
1590  objDefElecConsump
1591  objDefPeakLoad
1592  elecLoadBalanceCon
1593   
1594  inirmTempcon f_thermEqONCool1 f_thermEqONCool2  ubrmtemp lbrmtemp
1595  f_ubpHVACONCool f_lbpHVACONCool f_ubpHVACOFF1 f_ubpHVACOFF2 calRmTempNoCooling calRmTempRatedCooling f_calPHVACSP1 f_calPHVACSP2
1596  *$IFI "%HVAC_INC%"=="YES" f_ancbin1 f_ancbin2 f_ancbin3 f_ancbin4 f_ancbin5 f_ancbin6 f_ancbin7 f_ancbin8 f_ancbin9 f_ancbin10 f_ancbin11 f_ancbin12 f_ancbin13 f_ancbin14 f_ancbin15 f_ancbin16
1598  lbrmSetTemp ubrmSetTemp
1599  f_branch1
1600   
1601   
1602   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 30
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1603   
1604  iniWHTempcon thermEqWH ubWHtemp lbWHtemp ubWHSetTemp lbWHSetTemp f_ubpWHONHeat f_ubpWHOFF1 f_ubpWHOFF2 calWHTempNoHeating f_extraWHCon1 f_extraWHCon2
1605  calWHTempRatedHeating f_calPWHSP1 f_calPWHSP2 f_ancbin1WH ancbin2WH f_ancbin3WH f_ancbin4WH f_ancbin5WH f_ancbin6WH f_ancbin7WH f_ancbin8WH f_ancbin9WH f_ancbin10WH
1606  *$IFI "%WH_INC%"=="YES" f_ancbin11WH f_ancbin12WH f_ancbin13WH f_ancbin14WH f_ancbin15WH f_ancbin16WH f_lbWHSetPoint1 f_lbWHSetPoint2 AmbTempCal f_lbpWHONHeat
1608   
1609  f_EVSOCdynamicEq1Charge f_EVSOCdynamicEq2Charge f_EVSOCdynamicEq1Discharge f_EVSOCdynamicEq2Discharge f_EVSOCdynamicEq1Idle f_EVSOCdynamicEq2Idle
1610  EVOfflineEq1 EVOfflineEq2 EViniSOCEq EVendSOCEq f_EVubChargeCon f_EVlbChargeCon f_EVubDischargeCon f_EVlbDischargeCon f_EVStateCon EVubSOC EVlbSOC
1611   
1614   
1618   
1619  /;
1620  SHEMS_GET4OBJUB.OptCR=0.01;
1621  SHEMS_GET4OBJUB.ResLim=60;
1622   
1623  * if not single objctive and energy cost is no-zero
1624  *if(coObj('ENERGY_COST')>0 and ifSingleObjective=0,
1625   
1626  *solve SHEMS_GET4OBJUB using mip minimizing discom;
1627  *UbEnergyCost=energyCost.l;
1628  *ubElecConsump=ElecConsump.l;
1629  *ubPeakLoad=PeakLoad.l;
1630  *);
1631   
1632  *display 'Second Run Results (Minimizing overall model discomfort)';
1633  *display objcounter,energyCost.l, discom.l, ubEnergyCost,ubElecConsump,ubCarbFoot,ubPeakLoad,ubDiscom,pHVAC.l,rmTempSP.l;
1634   
1635  objDefSumObj..  sumObj =e= energyCost
1636                             +discom;
1637  *                           +coObj('ELEC_CONSUMPTION')*elecConsump/(ubElecConsump+epsilon)
1638  *                           +coObj('PEAK_LOAD')*peakLoad/(ubPeakLoad+epsilon);
1639   
1640   
1641  EVEnergyCostDef.. EVEnergyCost =e= sum((nEV,t,ss)$(ord(t)>1),sceProbability(ss)*EPrice(t,ss)*(EVCharRate(nEV,t,ss)-EVDischarRate(nEV,t,ss))*intervalLength);
1642  StorEnergyCostDef.. StorEnergyCost =e= sum((nStorage,t,ss)$(ord(t)>1),sceProbability(ss)*EPrice(t,ss)*(storCharRate(nStorage,t,ss)-storDischarRate(nStorage,t,ss))*intervalLength);
1643  PVEnergyCostDef.. PVEnergyCost =e= 0
1645  ;
1646  WindEnergyCostDef.. WindEnergycost =e= 0
1648  ;
1649  NCLEnergyCostDef..  NCLEnergycost =e=  0
1651  ;
1652   
1653   
1654  *final run
1655  **************************
1656  model SHEMS_overall /
1657  SPTOUB1
1658  SPTOUB2
1659  SPTOUB3
1660  SPTOUB4
1661  SPTOLB1
1662  SPTOLB2
1663  SPTOLB3
1664  SPTOLB4
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 31
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1665  SPTOLB5
1666   
1667  objDefSumObj
1668  objDefEnerCost
1669  objDefDiscom
1670  objDefElecConsump
1671  objDefPeakLoad
1672  elecLoadBalanceCon
1673   
1674  inirmTempcon f_thermEqONCool1 f_thermEqONCool2  ubrmtemp lbrmtemp
1675  f_ubpHVACONCool f_lbpHVACONCool f_ubpHVACOFF1 f_ubpHVACOFF2 calRmTempNoCooling calRmTempRatedCooling f_calPHVACSP1 f_calPHVACSP2
1676  *$IFI "%HVAC_INC%"=="YES" f_ancbin1 f_ancbin2 f_ancbin3 f_ancbin4 f_ancbin5 f_ancbin6 f_ancbin7 f_ancbin8 f_ancbin9 f_ancbin10 f_ancbin11 f_ancbin12 f_ancbin13 f_ancbin14 f_ancbin15 f_ancbin16
1678  lbrmSetTemp ubrmSetTemp
1679  f_branch1
1680   
1681   
1682   
1683  iniWHTempcon thermEqWH ubWHtemp lbWHtemp ubWHSetTemp lbWHSetTemp f_ubpWHONHeat f_ubpWHOFF1 f_ubpWHOFF2 calWHTempNoHeating f_extraWHCon1 f_extraWHCon2
1684  calWHTempRatedHeating f_calPWHSP1 f_calPWHSP2 f_ancbin1WH ancbin2WH f_ancbin3WH f_ancbin4WH f_ancbin5WH f_ancbin6WH f_ancbin7WH f_ancbin8WH f_ancbin9WH f_ancbin10WH
1685  *$IFI "%WH_INC%"=="YES" f_ancbin11WH f_ancbin12WH f_ancbin13WH f_ancbin14WH f_ancbin15WH f_ancbin16WH f_lbWHSetPoint1 f_lbWHSetPoint2 AmbTempCal f_lbpWHONHeat
1687   
1688  f_EVSOCdynamicEq1Charge f_EVSOCdynamicEq2Charge f_EVSOCdynamicEq1Discharge f_EVSOCdynamicEq2Discharge f_EVSOCdynamicEq1Idle f_EVSOCdynamicEq2Idle
1689  EVOfflineEq1 EVOfflineEq2 EViniSOCEq EVendSOCEq f_EVubChargeCon f_EVlbChargeCon f_EVubDischargeCon f_EVlbDischargeCon f_EVStateCon EVubSOC EVlbSOC
1690   
1693   
1695   
1700   
1701   
1702   
1703  ****** included for battery degradation ******
1711  ************** End ***************************
1712   
1715   
1718   
1721   
1723   
1725   
1728   
1729  *added on 07-09-14
1730   
1731  HVACEnergyCostDef
1732  WHEnergyCostDef
1733  EVEnergyCostDef
1734  StorEnergyCostDef
1735  PVEnergyCostDef
1736  WindEnergyCostDef
1737  NCLEnergyCostDef
1738  /;
1739   
1740  SHEMS_overall.OptCR=0.0001;
1741  SHEMS_overall.ResLim=300;
1742   
1743   
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 32
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


1744   
1745  solve SHEMS_overall using mip minimizing sumObj;
1746   
1747   
1748  if(f_ON.l('1')=1,
1749  coolingSP=rmTempSP.l('1');
1750  heatingSP=desiredTEMP('1','DESIRED_HEATING_TEMP');
1751  ******Li******
1752  display coolingSP;
1753  **********************************
1754  else
1755  heatingSP=rmTempSP.l('1');
1756  coolingSP=rmTempSP.l('1');
1757  ******Li******
1758  display coolingSP;
1759  display heatingSP;
1760  **********************************
1761  );
1762   
1763  Parameter WHSP;
1764  WHSP=WHTempSP.l('WH_1','1');
1765   
1766  display WHSP;
1767   
1768  EVCharRateResult = EVCharRate.l('EV_1','1','BASE_CASE');
1769   
1770  display EVCharRateResult;
1771  display EVCharRate.l, EVSOC.l;
1772   
1773  **************************
1774  * end final run
1775   
1776  execute_unload "Results.gdx" rmTemp.l,rmTempSP.l,pHVAC.l,
1777  WHTemp.l,WHTempSP.l,pWH.l,WHON.l,t,s,ss,f_ON.l,f_c.l,WHSP,
1778  nWH,nEV nStorage rmTempUB rmTempLB desiredRmTemp
1779  WHTempUB WHTempLB desiredWHTemp EVCharRate EVDischarRate EVSOC storCharRate storDischarRate storSOC
1780  sumObj energyCost elecConsump carbFoot peakLoad discom EPrice tempOut HVACEnergyCost  pGridSlack1.l
1781  WHEnergyCost hotWaterUsage EVEnergyCost  StorEnergyCost PVEnergyCost  WindEnergyCost  NCLEnergyCost sceProbability elecPricef outTempf hotWaterUsagef nObj,coObj, objWeight, windGen,dispSolarGen,heatingSP,coolingSP,pGrid,WHPar,ubEnergyCost,ubDiscom;

**** LIST OF STRAY NAMES - CHECK DECLARATIONS FOR SPURIOUS COMMAS
**** STRAY NAME GPrice OF TYPE PARAM
**** STRAY NAME fridgePar OF TYPE PARAM
**** STRAY NAME dishWasherPar OF TYPE PARAM
**** STRAY NAME clothesWasherDryerPar OF TYPE PARAM
**** STRAY NAME poolPumpPar OF TYPE PARAM
**** STRAY NAME gasPrice OF TYPE PARAM
**** STRAY NAME ancPrice OF TYPE PARAM
**** STRAY NAME occupLevel OF TYPE PARAM
**** STRAY NAME lightingPar OF TYPE PARAM
**** STRAY NAME tsLighting OF TYPE PARAM
**** STRAY NAME CHPPar OF TYPE PARAM
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 33
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  D:\PSOC\LWang\GAMS_HEMS_test\HEMS.gms
     2       36 CALL           1      36  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\HVAC_PAR id=HVACTable index=1 values=2..10 useheader=y StoreZero=y
     3       37 GDXIN          1      37  D:\PSOC\LWang\GAMS_HEMS_test\HVAC_PAR.gdx
     4       42 CALL           1      42  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\CONTROL_DEV id=appTable index=1 values=2 useheader=y StoreZero=y
     5       43 GDXIN          1      43  D:\PSOC\LWang\GAMS_HEMS_test\CONTROL_DEV.gdx
     6       48 CALL           1      48  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\2_from_GLD\TS_ELEC_PRICE id=elecPriceTable index=1 values=5..56 useheader=y StoreZero=y
     7       49 GDXIN          1      49  D:\PSOC\LWang\GAMS_HEMS_test\TS_ELEC_PRICE.gdx
     8       54 CALL           1      54  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_OUTDOOR_TEMP id=outDoorTempTable index=1 values=5..56 useheader=y StoreZero=y
     9       55 GDXIN          1      55  D:\PSOC\LWang\GAMS_HEMS_test\TS_OUTDOOR_TEMP.gdx
    10       60 CALL           1      60  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_SOLAR_INSOLATION id=solarInsolationTable index=1 values=5..56 useheader=y StoreZero=y
    11       61 GDXIN          1      61  D:\PSOC\LWang\GAMS_HEMS_test\TS_SOLAR_INSOLATION.gdx
    12       65 CALL           1      65  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_INTERNAL_SOURCE id=internalSourceTable index=1 values=5..56 useheader=y StoreZero=y
    13       66 GDXIN          1      66  D:\PSOC\LWang\GAMS_HEMS_test\TS_INTERNAL_SOURCE.gdx
    14       71 CALL           1      71  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_DESIRED_TEMP id=desiredTempTable index=1 values=5..16 useheader=y StoreZero=y
    15       72 GDXIN          1      72  D:\PSOC\LWang\GAMS_HEMS_test\TS_DESIRED_TEMP.gdx
    16       76 CALL           1      76  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\WATER_HEATER_PAR id=WHTable index=1 values=2..9 useheader=y StoreZero=y
    17       77 GDXIN          1      77  D:\PSOC\LWang\GAMS_HEMS_test\WATER_HEATER_PAR.gdx
    18       81 CALL           1      81  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_HOTWATER_USAGE id=waterUseTable index=1 values=5..56 useheader=y StoreZero=y
    19       82 GDXIN          1      82  D:\PSOC\LWang\GAMS_HEMS_test\TS_HOTWATER_USAGE.gdx
    20       86 CALL           1      86  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\EV_PAR id=EVTable index=1 values=2..21 useheader=y StoreZero=y
    21       87 GDXIN          1      87  D:\PSOC\LWang\GAMS_HEMS_test\EV_PAR.gdx
    22       91 CALL           1      91  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\STORAGE_PAR id=storageTable index=1 values=2..11 useheader=y StoreZero=y
    23       92 GDXIN          1      92  D:\PSOC\LWang\GAMS_HEMS_test\STORAGE_PAR.gdx
    24       97 CALL           1      97  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_WIND_GEN id=windGenTable index=1 values=5..56 useheader=y StoreZero=y
    25       98 GDXIN          1      98  D:\PSOC\LWang\GAMS_HEMS_test\TS_WIND_GEN.gdx
    26      102 CALL           1     102  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\3_from_input_file\TS_SOLAR_GEN id=solarGenTable index=1 values=6..56 useheader=y StoreZero=y
    27      103 GDXIN          1     103  D:\PSOC\LWang\GAMS_HEMS_test\TS_SOLAR_GEN.gdx
    28      107 CALL           1     107  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\2_from_GLD\TS_NONCONTROL_LOAD id=nonControlLoadTable index=1 values=6..56 useheader=y StoreZero=y
    29      108 GDXIN          1     108  D:\PSOC\LWang\GAMS_HEMS_test\TS_NONCONTROL_LOAD.gdx
    30      113 CALL           1     113  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\OBJECTIVE id=objTable index=1 values=2 useheader=y StoreZero=y
    31      114 GDXIN          1     114  D:\PSOC\LWang\GAMS_HEMS_test\OBJECTIVE.gdx
    32      119 CALL           1     119  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\PENALTY id=penTable index=1 values=2 useheader=y StoreZero=y
    33      120 GDXIN          1     120  D:\PSOC\LWang\GAMS_HEMS_test\PENALTY.gdx
    34      126 CALL           1     126  csv2gdx D:\PSOC\LWang\GAMS_HEMS_test\1_Static\SYSTIME_PAR id=sysTimeTable index=1 values=2 useheader=y StoreZero=y
    35      127 GDXIN          1     127  D:\PSOC\LWang\GAMS_HEMS_test\SYSTIME_PAR.gdx


COMPILATION TIME     =        1.031 SECONDS      4 MB  24.7.4 r58773 WEX-WEI
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 34
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    135 PARAMETER waterUsage  

     BASE_CASE  SCENARIO_1  SCENARIO_2  SCENARIO_3  SCENARIO_4  SCENARIO_5  SCENARIO_6  SCENARIO_7  SCENARIO_8  SCENARIO_9  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8        1.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10       1.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11       1.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12       5.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 35
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    135 PARAMETER tempOut  

     BASE_CASE  SCENARIO_1  SCENARIO_2  SCENARIO_3  SCENARIO_4  SCENARIO_5  SCENARIO_6  SCENARIO_7  SCENARIO_8  SCENARIO_9  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0       85.300         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1       86.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2       88.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3       86.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9       86.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10      89.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11      92.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12      95.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 36
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    135 SET nEV  Domain loaded from EVTable position 1

EV_1


----    135 SET s  scenario for stochastic

BASE_CASE  ,    SCENARIO_1 ,    SCENARIO_2 ,    SCENARIO_3 ,    SCENARIO_4 ,    SCENARIO_5 ,    SCENARIO_6 ,    SCENARIO_7 ,    SCENARIO_8 ,    SCENARIO_9 ,    SCENARIO_10,    SCENARIO_11,    SCENARIO_12,    SCENARIO_13,    SCENARIO_14,    SCENARIO_15
SCENARIO_16,    SCENARIO_17,    SCENARIO_18,    SCENARIO_19,    SCENARIO_20,    SCENARIO_21,    SCENARIO_22,    SCENARIO_23,    SCENARIO_24,    SCENARIO_25,    SCENARIO_26,    SCENARIO_27,    SCENARIO_28,    SCENARIO_29,    SCENARIO_30,    SCENARIO_31
SCENARIO_32,    SCENARIO_33,    SCENARIO_34,    SCENARIO_35,    SCENARIO_36,    SCENARIO_37,    SCENARIO_38,    SCENARIO_39,    SCENARIO_40,    SCENARIO_41,    SCENARIO_42,    SCENARIO_43,    SCENARIO_44,    SCENARIO_45,    SCENARIO_46,    SCENARIO_47
SCENARIO_48,    SCENARIO_49,    SCENARIO_50,    SCENARIO_51


----    135 SET ss  subset of s

BASE_CASE


----    135 SET t  time period

0 ,    1 ,    2 ,    3 ,    4 ,    5 ,    6 ,    7 ,    8 ,    9 ,    10,    11,    12


----    135 PARAMETER EPrice  

     BASE_CASE  SCENARIO_1  SCENARIO_2  SCENARIO_3  SCENARIO_4  SCENARIO_5  SCENARIO_6  SCENARIO_7  SCENARIO_8  SCENARIO_9  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0        0.044         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9        0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10       0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11       0.244         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12       0.320         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 37
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


        135 PARAMETER EPrice  

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS


----    135 PARAMETER penPar  

EV_SOC_INSUF 1.000,    PGRID_UB_VIO   EPS,    PGRID_LB_VIO   EPS,    PEV_DELTA    0.001,    PBAT_DELTA   0.050


----    198 PARAMETER tempOut  

     BASE_CASE  SCENARIO_1  SCENARIO_2  SCENARIO_3  SCENARIO_4  SCENARIO_5  SCENARIO_6  SCENARIO_7  SCENARIO_8  SCENARIO_9  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0       85.300         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1       86.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2       88.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3       86.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8       85.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9       86.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10      89.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11      92.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12      95.000         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 38
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


        198 PARAMETER tempOut  

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS

 +  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~  SCENARIO_~

0          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
1          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
2          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
3          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
4          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
5          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
6          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
7          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
8          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
9          EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
10         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
11         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS
12         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS         EPS


----    209 PARAMETER sceProbability  

BASE_CASE 1.000


----    217 PARAMETER HVACPar  

         CO_RM_TEMP  CO_OUT_TE~  CO_POWER_~         COP  RATED_POW~   MIN_POWER  INI_RM_TE~  CO_SOLAR_~  CO_INTERN~

HEATING       0.992       0.008       0.206       3.500       5.600         EPS      77.000         EPS         EPS
COOLING       0.900       0.100      -0.189       3.230      21.200         EPS      75.241         EPS         EPS


----    221 PARAMETER coOutTemp  

HEATING 0.008,    COOLING 0.100

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 39
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    225 PARAMETER coPowerToTemp  

HEATING  0.206,    COOLING -0.189


----    230 PARAMETER coSolarInsolation  

HEATING EPS,    COOLING EPS


----    234 PARAMETER coInternalSource  

HEATING EPS,    COOLING EPS


----    239 PARAMETER ratedHVACPower  

HEATING  5.600,    COOLING 21.200


----    249 PARAMETER iniRmTemp            =       75.241  

----    253 PARAMETER HVACCOP  

HEATING 3.500,    COOLING 3.230


----    259 PARAMETER rmTempUB  

0  85.000,    1  85.000,    2  85.000,    3  85.000,    4  85.000,    5  85.000,    6  85.000,    7  85.000,    8  85.000,    9  85.000,    10 85.000,    11 85.000,    12 85.000


----    265 PARAMETER rmTempLB  

0  70.000,    1  70.000,    2  70.000,    3  70.000,    4  70.000,    5  70.000,    6  70.000,    7  70.000,    8  70.000,    9  70.000,    10 70.000,    11 70.000,    12 70.000


----    270 PARAMETER desiredRmTemp  

0  75.000,    1  75.000,    2  75.000,    3  75.000,    4  75.000,    5  75.000,    6  75.000,    7  75.000,    8  75.000,    9  75.000,    10 75.000,    11 75.000,    12 75.000


----    270 PARAMETER desiredTEMP  

    DESIRED_H~  DESIRED_H~  DESIRED_H~  DESIRED_C~  DESIRED_C~  DESIRED_C~  DESIRED_W~  DESIRED_W~  DESIRED_W~  LIGHTING_~     PENALTY    INTERVAL

0          EPS         EPS         EPS      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500         EPS
1        1.000       1.000       1.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       1.000
2        2.000       2.000       2.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       2.000
3        3.000       3.000       3.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       3.000
4        4.000       4.000       4.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       4.000
5        5.000       5.000       5.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       5.000
6        6.000       6.000       6.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       6.000
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 40
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


        270 PARAMETER desiredTEMP  

    DESIRED_H~  DESIRED_H~  DESIRED_H~  DESIRED_C~  DESIRED_C~  DESIRED_C~  DESIRED_W~  DESIRED_W~  DESIRED_W~  LIGHTING_~     PENALTY    INTERVAL

7        7.000       7.000       7.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       7.000
8        8.000       8.000       8.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       8.000
9        9.000       9.000       9.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500       9.000
10      10.000      10.000      10.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500      10.000
11      11.000      11.000      11.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500      11.000
12      12.000      12.000      12.000      70.000      85.000      75.000     108.000     118.000     113.000         EPS       0.500      12.000


----    368 PARAMETER InitEVSOC  

EV_1 0.007


----    368 PARAMETER EndEVSOC  

EV_1 1.000


----    401 PARAMETER StartChargeTime  

                      ( ALL       0.000 )


----    401 PARAMETER StartChargeEVSOC  

EV_1 0.007


----    401 PARAMETER StopChargeTime  

EV_1 10.000


----    401 PARAMETER StopChargeEVSOC  

EV_1 0.920

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 41
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- SPTOUB1  =L=  

SPTOUB1(1)..  rmTempSP(1) + 10000*ifzero(1) =L= 10085 ; (LHS = 0)
     
SPTOUB1(2)..  rmTempSP(2) + 10000*ifzero(2) =L= 10085 ; (LHS = 0)
     
SPTOUB1(3)..  rmTempSP(3) + 10000*ifzero(3) =L= 10085 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOUB2  =L=  

SPTOUB2(1)..  - rmTempSP(1) + 10000*ifzero(1) =L= 9915 ; (LHS = 0)
     
SPTOUB2(2)..  - rmTempSP(2) + 10000*ifzero(2) =L= 9915 ; (LHS = 0)
     
SPTOUB2(3)..  - rmTempSP(3) + 10000*ifzero(3) =L= 9915 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOUB3  =L=  

SPTOUB3(1,BASE_CASE)..  - pHVAC(1,BASE_CASE) - 10000*ifzero(1) =L= -0.01 ; (LHS = 0, INFES = 0.01 ****)
     
SPTOUB3(2,BASE_CASE)..  - pHVAC(2,BASE_CASE) - 10000*ifzero(2) =L= -0.01 ; (LHS = 0, INFES = 0.01 ****)
     
SPTOUB3(3,BASE_CASE)..  - pHVAC(3,BASE_CASE) - 10000*ifzero(3) =L= -0.01 ; (LHS = 0, INFES = 0.01 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOUB4  =L=  

SPTOUB4(1,BASE_CASE)..  pHVAC(1,BASE_CASE) + 10000*ifzero(1) =L= 10000 ; (LHS = 0)
     
SPTOUB4(2,BASE_CASE)..  pHVAC(2,BASE_CASE) + 10000*ifzero(2) =L= 10000 ; (LHS = 0)
     
SPTOUB4(3,BASE_CASE)..  pHVAC(3,BASE_CASE) + 10000*ifzero(3) =L= 10000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOLB1  =L=  

SPTOLB1(1,BASE_CASE)..  pHVAC(1,BASE_CASE) + 10000*ifrated(1) =L= 10021.2 ; (LHS = 0)
     
SPTOLB1(2,BASE_CASE)..  pHVAC(2,BASE_CASE) + 10000*ifrated(2) =L= 10021.2 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 42
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     SPTOLB1  =L=  

SPTOLB1(3,BASE_CASE)..  pHVAC(3,BASE_CASE) + 10000*ifrated(3) =L= 10021.2 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOLB2  =L=  

SPTOLB2(1,BASE_CASE)..  - pHVAC(1,BASE_CASE) + 10000*ifrated(1) =L= 9978.8 ; (LHS = 0)
     
SPTOLB2(2,BASE_CASE)..  - pHVAC(2,BASE_CASE) + 10000*ifrated(2) =L= 9978.8 ; (LHS = 0)
     
SPTOLB2(3,BASE_CASE)..  - pHVAC(3,BASE_CASE) + 10000*ifrated(3) =L= 9978.8 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOLB3  =L=  

SPTOLB3(1)..  - rmTempSP(1) + 10000*ifrated(1) =L= 9930 ; (LHS = 0)
     
SPTOLB3(2)..  - rmTempSP(2) + 10000*ifrated(2) =L= 9930 ; (LHS = 0)
     
SPTOLB3(3)..  - rmTempSP(3) + 10000*ifrated(3) =L= 9930 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOLB4  =L=  

SPTOLB4(1)..  rmTempSP(1) + 10000*ifrated(1) =L= 10070 ; (LHS = 0)
     
SPTOLB4(2)..  rmTempSP(2) + 10000*ifrated(2) =L= 10070 ; (LHS = 0)
     
SPTOLB4(3)..  rmTempSP(3) + 10000*ifrated(3) =L= 10070 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- SPTOLB5  =L=  

SPTOLB5(1,BASE_CASE)..  pHVAC(1,BASE_CASE) - 10000*ifrated(1) =L= 21.19 ; (LHS = 0)
     
SPTOLB5(2,BASE_CASE)..  pHVAC(2,BASE_CASE) - 10000*ifrated(2) =L= 21.19 ; (LHS = 0)
     
SPTOLB5(3,BASE_CASE)..  pHVAC(3,BASE_CASE) - 10000*ifrated(3) =L= 21.19 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 43
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- objDefSumObj  =E=  

objDefSumObj..  - energyCost - discom + sumObj =E= 0 ; (LHS = 0)
     

---- objDefEnerCost  =E=  

objDefEnerCost..  - 0.244*pGrid(1,BASE_CASE) - 0.244*pGrid(2,BASE_CASE) - 0.244*pGrid(3,BASE_CASE) - 0.244*pGrid(4,BASE_CASE) - 0.244*pGrid(5,BASE_CASE) - 0.244*pGrid(6,BASE_CASE) - 0.244*pGrid(7,BASE_CASE) - 0.244*pGrid(8,BASE_CASE)
     
      - 0.244*pGrid(9,BASE_CASE) - 0.244*pGrid(10,BASE_CASE) - 0.244*pGrid(11,BASE_CASE) - 0.32*pGrid(12,BASE_CASE) + EPS*pGridSlack1(1,BASE_CASE) + EPS*pGridSlack1(2,BASE_CASE) + EPS*pGridSlack1(3,BASE_CASE) + EPS*pGridSlack1(4,BASE_CASE)
     
      + EPS*pGridSlack1(5,BASE_CASE) + EPS*pGridSlack1(6,BASE_CASE) + EPS*pGridSlack1(7,BASE_CASE) + EPS*pGridSlack1(8,BASE_CASE) + EPS*pGridSlack1(9,BASE_CASE) + EPS*pGridSlack1(10,BASE_CASE) + EPS*pGridSlack1(11,BASE_CASE)
     
      + EPS*pGridSlack1(12,BASE_CASE) + EPS*pGridSlack2(1,BASE_CASE) + EPS*pGridSlack2(2,BASE_CASE) + EPS*pGridSlack2(3,BASE_CASE) + EPS*pGridSlack2(4,BASE_CASE) + EPS*pGridSlack2(5,BASE_CASE) + EPS*pGridSlack2(6,BASE_CASE) + EPS*pGridSlack2(7,BASE_CASE)
     
      + EPS*pGridSlack2(8,BASE_CASE) + EPS*pGridSlack2(9,BASE_CASE) + EPS*pGridSlack2(10,BASE_CASE) + EPS*pGridSlack2(11,BASE_CASE) + EPS*pGridSlack2(12,BASE_CASE) + energyCost - 45*EVSOCSlack(1) - 45*EVSOCSlack(2) - 45*EVSOCSlack(3) - 45*EVSOCSlack(4)
     
      - 45*EVSOCSlack(5) - 45*EVSOCSlack(6) - 45*EVSOCSlack(7) - 45*EVSOCSlack(8) - 45*EVSOCSlack(9) - 45*EVSOCSlack(10) - 45*EVSOCSlack(11) - 45*EVSOCSlack(12) =E= 0 ; (LHS = 0)
     

---- objDefDiscom  =E=  

objDefDiscom..  discom - 0.38*s1(1,BASE_CASE) - 0.38*s1(2,BASE_CASE) - 0.38*s1(3,BASE_CASE) - 0.38*s1(4,BASE_CASE) - 0.38*s1(5,BASE_CASE) - 0.38*s1(6,BASE_CASE) - 0.38*s1(7,BASE_CASE) - 0.38*s1(8,BASE_CASE) - 0.38*s1(9,BASE_CASE) - 0.38*s1(10,BASE_CASE)
     
      - 0.38*s1(11,BASE_CASE) - 0.38*s1(12,BASE_CASE) - 0.38*s2(1,BASE_CASE) - 0.38*s2(2,BASE_CASE) - 0.38*s2(3,BASE_CASE) - 0.38*s2(4,BASE_CASE) - 0.38*s2(5,BASE_CASE) - 0.38*s2(6,BASE_CASE) - 0.38*s2(7,BASE_CASE) - 0.38*s2(8,BASE_CASE)
     
      - 0.38*s2(9,BASE_CASE) - 0.38*s2(10,BASE_CASE) - 0.38*s2(11,BASE_CASE) - 0.38*s2(12,BASE_CASE) - 0.12*s5(WH_1,1,BASE_CASE) - 0.12*s5(WH_1,2,BASE_CASE) - 0.12*s5(WH_1,3,BASE_CASE) - 0.12*s5(WH_1,4,BASE_CASE) - 0.12*s5(WH_1,5,BASE_CASE)
     
      - 0.12*s5(WH_1,6,BASE_CASE) - 0.12*s5(WH_1,7,BASE_CASE) - 0.12*s5(WH_1,8,BASE_CASE) - 0.12*s5(WH_1,9,BASE_CASE) - 0.12*s5(WH_1,10,BASE_CASE) - 0.12*s5(WH_1,11,BASE_CASE) - 0.12*s5(WH_1,12,BASE_CASE) - 0.12*s6(WH_1,1,BASE_CASE)
     
      - 0.12*s6(WH_1,2,BASE_CASE) - 0.12*s6(WH_1,3,BASE_CASE) - 0.12*s6(WH_1,4,BASE_CASE) - 0.12*s6(WH_1,5,BASE_CASE) - 0.12*s6(WH_1,6,BASE_CASE) - 0.12*s6(WH_1,7,BASE_CASE) - 0.12*s6(WH_1,8,BASE_CASE) - 0.12*s6(WH_1,9,BASE_CASE)
     
      - 0.12*s6(WH_1,10,BASE_CASE) - 0.12*s6(WH_1,11,BASE_CASE) - 0.12*s6(WH_1,12,BASE_CASE) =E= 0 ; (LHS = 0)
     

---- objDefElecConsump  =E=  

objDefElecConsump..  - 0.08*pGrid(1,BASE_CASE) - 0.08*pGrid(2,BASE_CASE) - 0.08*pGrid(3,BASE_CASE) - 0.08*pGrid(4,BASE_CASE) - 0.08*pGrid(5,BASE_CASE) - 0.08*pGrid(6,BASE_CASE) - 0.08*pGrid(7,BASE_CASE) - 0.08*pGrid(8,BASE_CASE) - 0.08*pGrid(9,BASE_CASE)
     
      - 0.08*pGrid(10,BASE_CASE) - 0.08*pGrid(11,BASE_CASE) - 0.08*pGrid(12,BASE_CASE) + EPS*pGridSlack1(1,BASE_CASE) + EPS*pGridSlack1(2,BASE_CASE) + EPS*pGridSlack1(3,BASE_CASE) + EPS*pGridSlack1(4,BASE_CASE) + EPS*pGridSlack1(5,BASE_CASE)
     
      + EPS*pGridSlack1(6,BASE_CASE) + EPS*pGridSlack1(7,BASE_CASE) + EPS*pGridSlack1(8,BASE_CASE) + EPS*pGridSlack1(9,BASE_CASE) + EPS*pGridSlack1(10,BASE_CASE) + EPS*pGridSlack1(11,BASE_CASE) + EPS*pGridSlack1(12,BASE_CASE)
     
      + EPS*pGridSlack2(1,BASE_CASE) + EPS*pGridSlack2(2,BASE_CASE) + EPS*pGridSlack2(3,BASE_CASE) + EPS*pGridSlack2(4,BASE_CASE) + EPS*pGridSlack2(5,BASE_CASE) + EPS*pGridSlack2(6,BASE_CASE) + EPS*pGridSlack2(7,BASE_CASE) + EPS*pGridSlack2(8,BASE_CASE)
     
      + EPS*pGridSlack2(9,BASE_CASE) + EPS*pGridSlack2(10,BASE_CASE) + EPS*pGridSlack2(11,BASE_CASE) + EPS*pGridSlack2(12,BASE_CASE) + elecConsump - 45*EVSOCSlack(1) - 45*EVSOCSlack(2) - 45*EVSOCSlack(3) - 45*EVSOCSlack(4) - 45*EVSOCSlack(5)
     
      - 45*EVSOCSlack(6) - 45*EVSOCSlack(7) - 45*EVSOCSlack(8) - 45*EVSOCSlack(9) - 45*EVSOCSlack(10) - 45*EVSOCSlack(11) - 45*EVSOCSlack(12) =E= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 44
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- objDefPeakLoad  =E=  

objDefPeakLoad..  - pGridUB + peakLoad - EVSOCSlack(1) - EVSOCSlack(2) - EVSOCSlack(3) - EVSOCSlack(4) - EVSOCSlack(5) - EVSOCSlack(6) - EVSOCSlack(7) - EVSOCSlack(8) - EVSOCSlack(9) - EVSOCSlack(10) - EVSOCSlack(11) - EVSOCSlack(12) =E= 0 ; (LHS = 0)
     

---- elecLoadBalanceCon  =E=  

elecLoadBalanceCon(1,BASE_CASE)..  pGrid(1,BASE_CASE) - pHVAC(1,BASE_CASE) - pWH(WH_1,1,BASE_CASE) - EVCharRate(EV_1,1,BASE_CASE) + EVDischarRate(EV_1,1,BASE_CASE) =E= 0 ; (LHS = 0)
     
elecLoadBalanceCon(2,BASE_CASE)..  pGrid(2,BASE_CASE) - pHVAC(2,BASE_CASE) - pWH(WH_1,2,BASE_CASE) - EVCharRate(EV_1,2,BASE_CASE) + EVDischarRate(EV_1,2,BASE_CASE) =E= 0 ; (LHS = 0)
     
elecLoadBalanceCon(3,BASE_CASE)..  pGrid(3,BASE_CASE) - pHVAC(3,BASE_CASE) - pWH(WH_1,3,BASE_CASE) - EVCharRate(EV_1,3,BASE_CASE) + EVDischarRate(EV_1,3,BASE_CASE) =E= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- inirmTempcon  =E=  

inirmTempcon(0,BASE_CASE)..  rmTemp(0,BASE_CASE) =E= 75.2408586485391 ; (LHS = 0, INFES = 75.2408586485391 ****)
     

---- f_thermEqONCool1  =L=  

f_thermEqONCool1(1,BASE_CASE)..  - 0.9*rmTemp(0,BASE_CASE) + rmTemp(1,BASE_CASE) + 0.1887*pHVAC(1,BASE_CASE) =L= 8.6 ; (LHS = 0)
     
f_thermEqONCool1(2,BASE_CASE)..  - 0.9*rmTemp(1,BASE_CASE) + rmTemp(2,BASE_CASE) + 0.1887*pHVAC(2,BASE_CASE) =L= 8.8 ; (LHS = 0)
     
f_thermEqONCool1(3,BASE_CASE)..  - 0.9*rmTemp(2,BASE_CASE) + rmTemp(3,BASE_CASE) + 0.1887*pHVAC(3,BASE_CASE) =L= 8.6 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_thermEqONCool2  =L=  

f_thermEqONCool2(1,BASE_CASE)..  0.9*rmTemp(0,BASE_CASE) - rmTemp(1,BASE_CASE) - 0.1887*pHVAC(1,BASE_CASE) =L= -8.6 ; (LHS = 0, INFES = 8.6 ****)
     
f_thermEqONCool2(2,BASE_CASE)..  0.9*rmTemp(1,BASE_CASE) - rmTemp(2,BASE_CASE) - 0.1887*pHVAC(2,BASE_CASE) =L= -8.8 ; (LHS = 0, INFES = 8.8 ****)
     
f_thermEqONCool2(3,BASE_CASE)..  0.9*rmTemp(2,BASE_CASE) - rmTemp(3,BASE_CASE) - 0.1887*pHVAC(3,BASE_CASE) =L= -8.6 ; (LHS = 0, INFES = 8.6 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- ubrmtemp  =L=  upper bound of room temperature

ubrmtemp(1,BASE_CASE)..  rmTemp(1,BASE_CASE) - s1(1,BASE_CASE) =L= 75 ; (LHS = 0)
     
ubrmtemp(2,BASE_CASE)..  rmTemp(2,BASE_CASE) - s1(2,BASE_CASE) =L= 75 ; (LHS = 0)
     
ubrmtemp(3,BASE_CASE)..  rmTemp(3,BASE_CASE) - s1(3,BASE_CASE) =L= 75 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 45
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- lbrmtemp  =G=  

lbrmtemp(1,BASE_CASE)..  rmTemp(1,BASE_CASE) + s2(1,BASE_CASE) =G= 75 ; (LHS = 0, INFES = 75 ****)
     
lbrmtemp(2,BASE_CASE)..  rmTemp(2,BASE_CASE) + s2(2,BASE_CASE) =G= 75 ; (LHS = 0, INFES = 75 ****)
     
lbrmtemp(3,BASE_CASE)..  rmTemp(3,BASE_CASE) + s2(3,BASE_CASE) =G= 75 ; (LHS = 0, INFES = 75 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ubpHVACONCool  =L=  upper bound of HVAC power

f_ubpHVACONCool(0,BASE_CASE)..  pHVAC(0,BASE_CASE) =L= 21.2 ; (LHS = 0)
     
f_ubpHVACONCool(1,BASE_CASE)..  pHVAC(1,BASE_CASE) =L= 21.2 ; (LHS = 0)
     
f_ubpHVACONCool(2,BASE_CASE)..  pHVAC(2,BASE_CASE) =L= 21.2 ; (LHS = 0)
     
REMAINING 10 ENTRIES SKIPPED


---- f_lbpHVACONCool  =L=  

f_lbpHVACONCool(0,BASE_CASE)..  - pHVAC(0,BASE_CASE) =L= 0 ; (LHS = 0)
     
f_lbpHVACONCool(1,BASE_CASE)..  - pHVAC(1,BASE_CASE) =L= 0 ; (LHS = 0)
     
f_lbpHVACONCool(2,BASE_CASE)..  - pHVAC(2,BASE_CASE) =L= 0 ; (LHS = 0)
     
REMAINING 10 ENTRIES SKIPPED


---- f_ubpHVACOFF1  =L=  

f_ubpHVACOFF1(1,BASE_CASE)..  pHVAC(1,BASE_CASE) - 10000*f_ON(1) =L= 0 ; (LHS = 0)
     
f_ubpHVACOFF1(2,BASE_CASE)..  pHVAC(2,BASE_CASE) - 10000*f_ON(2) =L= 0 ; (LHS = 0)
     
f_ubpHVACOFF1(3,BASE_CASE)..  pHVAC(3,BASE_CASE) - 10000*f_ON(3) =L= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ubpHVACOFF2  =L=  

f_ubpHVACOFF2(1,BASE_CASE)..  - pHVAC(1,BASE_CASE) - 10000*f_ON(1) =L= 0 ; (LHS = 0)
     
f_ubpHVACOFF2(2,BASE_CASE)..  - pHVAC(2,BASE_CASE) - 10000*f_ON(2) =L= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 46
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     f_ubpHVACOFF2  =L=  

f_ubpHVACOFF2(3,BASE_CASE)..  - pHVAC(3,BASE_CASE) - 10000*f_ON(3) =L= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- calRmTempNoCooling  =E=  calculate room temperature without cooling from HVAC

calRmTempNoCooling(1,BASE_CASE)..  - 0.9*rmTemp(0,BASE_CASE) + calRmTemp_noCool(1,BASE_CASE) =E= 8.6 ; (LHS = 0, INFES = 8.6 ****)
     
calRmTempNoCooling(2,BASE_CASE)..  - 0.9*rmTemp(1,BASE_CASE) + calRmTemp_noCool(2,BASE_CASE) =E= 8.8 ; (LHS = 0, INFES = 8.8 ****)
     
calRmTempNoCooling(3,BASE_CASE)..  - 0.9*rmTemp(2,BASE_CASE) + calRmTemp_noCool(3,BASE_CASE) =E= 8.6 ; (LHS = 0, INFES = 8.6 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- calRmTempRatedCooling  =E=  calculate room temperature with full power from HVAC

calRmTempRatedCooling(1,BASE_CASE)..  - 0.9*rmTemp(0,BASE_CASE) + calRmTemp_ratedCool(1,BASE_CASE) =E= 4.59956 ; (LHS = 0, INFES = 4.59956 ****)
     
calRmTempRatedCooling(2,BASE_CASE)..  - 0.9*rmTemp(1,BASE_CASE) + calRmTemp_ratedCool(2,BASE_CASE) =E= 4.79956 ; (LHS = 0, INFES = 4.79956 ****)
     
calRmTempRatedCooling(3,BASE_CASE)..  - 0.9*rmTemp(2,BASE_CASE) + calRmTemp_ratedCool(3,BASE_CASE) =E= 4.59956 ; (LHS = 0, INFES = 4.59956 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- f_calPHVACSP1  =L=  

f_calPHVACSP1(1,BASE_CASE)..  - 4.76947535771065*rmTemp(0,BASE_CASE) + 5.29941706412295*rmTempSP(1) + calPHVAC_CoolSP(1,BASE_CASE) =L= 45.5749867514573 ; (LHS = 0)
     
f_calPHVACSP1(2,BASE_CASE)..  - 4.76947535771065*rmTemp(1,BASE_CASE) + 5.29941706412295*rmTempSP(2) + calPHVAC_CoolSP(2,BASE_CASE) =L= 46.6348701642819 ; (LHS = 0)
     
f_calPHVACSP1(3,BASE_CASE)..  - 4.76947535771065*rmTemp(2,BASE_CASE) + 5.29941706412295*rmTempSP(3) + calPHVAC_CoolSP(3,BASE_CASE) =L= 45.5749867514573 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_calPHVACSP2  =L=  calculate power consumption of HVAC system with room temperature setpoint

f_calPHVACSP2(1,BASE_CASE)..  4.76947535771065*rmTemp(0,BASE_CASE) - 5.29941706412295*rmTempSP(1) - calPHVAC_CoolSP(1,BASE_CASE) =L= -45.5749867514573 ; (LHS = 0, INFES = 45.5749867514573 ****)
     
f_calPHVACSP2(2,BASE_CASE)..  4.76947535771065*rmTemp(1,BASE_CASE) - 5.29941706412295*rmTempSP(2) - calPHVAC_CoolSP(2,BASE_CASE) =L= -46.6348701642819 ; (LHS = 0, INFES = 46.6348701642819 ****)
     
f_calPHVACSP2(3,BASE_CASE)..  4.76947535771065*rmTemp(2,BASE_CASE) - 5.29941706412295*rmTempSP(3) - calPHVAC_CoolSP(3,BASE_CASE) =L= -45.5749867514573 ; (LHS = 0, INFES = 45.5749867514573 ****)
     
REMAINING 9 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 47
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- lbrmSetTemp  =G=  lower bound of room set temprature

lbrmSetTemp(1)..  rmTempSP(1) =G= 70 ; (LHS = 0, INFES = 70 ****)
     
lbrmSetTemp(2)..  rmTempSP(2) =G= 70 ; (LHS = 0, INFES = 70 ****)
     
lbrmSetTemp(3)..  rmTempSP(3) =G= 70 ; (LHS = 0, INFES = 70 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- ubrmSetTemp  =L=  upper bound of room set temprature

ubrmSetTemp(1)..  rmTempSP(1) =L= 85 ; (LHS = 0)
     
ubrmSetTemp(2)..  rmTempSP(2) =L= 85 ; (LHS = 0)
     
ubrmSetTemp(3)..  rmTempSP(3) =L= 85 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_branch1  =E=  

f_branch1(1,BASE_CASE)..  f_h(1) =E= 0 ; (LHS = 0)
     
f_branch1(2,BASE_CASE)..  f_h(2) =E= 0 ; (LHS = 0)
     
f_branch1(3,BASE_CASE)..  f_h(3) =E= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- iniWHTempcon  =E=  

iniWHTempcon(WH_1,0,BASE_CASE)..  WHTemp(WH_1,0,BASE_CASE) =E= 111.16105227748 ; (LHS = 0, INFES = 111.16105227748 ****)
     

---- thermEqWH  =E=  

thermEqWH(WH_1,1,BASE_CASE)..  - 0.9986*WHTemp(WH_1,0,BASE_CASE) + WHTemp(WH_1,1,BASE_CASE) - 1.389*pWH(WH_1,1,BASE_CASE) + EPS*WHAmbTemp(WH_1,1,BASE_CASE) =E= EPS ; (LHS = EPS)
     
thermEqWH(WH_1,2,BASE_CASE)..  - 0.9986*WHTemp(WH_1,1,BASE_CASE) + WHTemp(WH_1,2,BASE_CASE) - 1.389*pWH(WH_1,2,BASE_CASE) + EPS*WHAmbTemp(WH_1,2,BASE_CASE) =E= EPS ; (LHS = EPS)
     
thermEqWH(WH_1,3,BASE_CASE)..  - 0.9986*WHTemp(WH_1,2,BASE_CASE) + WHTemp(WH_1,3,BASE_CASE) - 1.389*pWH(WH_1,3,BASE_CASE) + EPS*WHAmbTemp(WH_1,3,BASE_CASE) =E= EPS ; (LHS = EPS)
     
REMAINING 9 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 48
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- ubWHtemp  =L=  

ubWHtemp(WH_1,1,BASE_CASE)..  WHTemp(WH_1,1,BASE_CASE) - s5(WH_1,1,BASE_CASE) =L= 113 ; (LHS = 0)
     
ubWHtemp(WH_1,2,BASE_CASE)..  WHTemp(WH_1,2,BASE_CASE) - s5(WH_1,2,BASE_CASE) =L= 113 ; (LHS = 0)
     
ubWHtemp(WH_1,3,BASE_CASE)..  WHTemp(WH_1,3,BASE_CASE) - s5(WH_1,3,BASE_CASE) =L= 113 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- lbWHtemp  =G=  

lbWHtemp(WH_1,1,BASE_CASE)..  WHTemp(WH_1,1,BASE_CASE) + s6(WH_1,1,BASE_CASE) =G= 113 ; (LHS = 0, INFES = 113 ****)
     
lbWHtemp(WH_1,2,BASE_CASE)..  WHTemp(WH_1,2,BASE_CASE) + s6(WH_1,2,BASE_CASE) =G= 113 ; (LHS = 0, INFES = 113 ****)
     
lbWHtemp(WH_1,3,BASE_CASE)..  WHTemp(WH_1,3,BASE_CASE) + s6(WH_1,3,BASE_CASE) =G= 113 ; (LHS = 0, INFES = 113 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- ubWHSetTemp  =L=  

ubWHSetTemp(WH_1,1)..  WHTempSP(WH_1,1) =L= 118 ; (LHS = 0)
     
ubWHSetTemp(WH_1,2)..  WHTempSP(WH_1,2) =L= 118 ; (LHS = 0)
     
ubWHSetTemp(WH_1,3)..  WHTempSP(WH_1,3) =L= 118 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- lbWHSetTemp  =G=  

lbWHSetTemp(WH_1,1)..  WHTempSP(WH_1,1) =G= 108 ; (LHS = 0, INFES = 108 ****)
     
lbWHSetTemp(WH_1,2)..  WHTempSP(WH_1,2) =G= 108 ; (LHS = 0, INFES = 108 ****)
     
lbWHSetTemp(WH_1,3)..  WHTempSP(WH_1,3) =G= 108 ; (LHS = 0, INFES = 108 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ubpWHONHeat  =L=  

f_ubpWHONHeat(WH_1,0,BASE_CASE)..  pWH(WH_1,0,BASE_CASE) - 8.3*f_WHON(WH_1,0) =L= 0 ; (LHS = 0)
     
f_ubpWHONHeat(WH_1,1,BASE_CASE)..  pWH(WH_1,1,BASE_CASE) - 8.3*f_WHON(WH_1,1) =L= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 49
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     f_ubpWHONHeat  =L=  

f_ubpWHONHeat(WH_1,2,BASE_CASE)..  pWH(WH_1,2,BASE_CASE) - 8.3*f_WHON(WH_1,2) =L= 0 ; (LHS = 0)
     
REMAINING 10 ENTRIES SKIPPED


---- f_ubpWHOFF1  =L=  

f_ubpWHOFF1(WH_1,1,BASE_CASE)..  pWH(WH_1,1,BASE_CASE) - 10000*f_WHON(WH_1,1) =L= 0 ; (LHS = 0)
     
f_ubpWHOFF1(WH_1,2,BASE_CASE)..  pWH(WH_1,2,BASE_CASE) - 10000*f_WHON(WH_1,2) =L= 0 ; (LHS = 0)
     
f_ubpWHOFF1(WH_1,3,BASE_CASE)..  pWH(WH_1,3,BASE_CASE) - 10000*f_WHON(WH_1,3) =L= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ubpWHOFF2  =L=  

f_ubpWHOFF2(WH_1,1,BASE_CASE)..  - pWH(WH_1,1,BASE_CASE) - 10000*f_WHON(WH_1,1) =L= 0 ; (LHS = 0)
     
f_ubpWHOFF2(WH_1,2,BASE_CASE)..  - pWH(WH_1,2,BASE_CASE) - 10000*f_WHON(WH_1,2) =L= 0 ; (LHS = 0)
     
f_ubpWHOFF2(WH_1,3,BASE_CASE)..  - pWH(WH_1,3,BASE_CASE) - 10000*f_WHON(WH_1,3) =L= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- calWHTempNoHeating  =E=  

calWHTempNoHeating(WH_1,1,BASE_CASE)..  - 0.9986*WHTemp(WH_1,0,BASE_CASE) + calWHTemp_noHeat(WH_1,1,BASE_CASE) + EPS*WHAmbTemp(WH_1,1,BASE_CASE) =E= EPS ; (LHS = EPS)
     
calWHTempNoHeating(WH_1,2,BASE_CASE)..  - 0.9986*WHTemp(WH_1,1,BASE_CASE) + calWHTemp_noHeat(WH_1,2,BASE_CASE) + EPS*WHAmbTemp(WH_1,2,BASE_CASE) =E= EPS ; (LHS = EPS)
     
calWHTempNoHeating(WH_1,3,BASE_CASE)..  - 0.9986*WHTemp(WH_1,2,BASE_CASE) + calWHTemp_noHeat(WH_1,3,BASE_CASE) + EPS*WHAmbTemp(WH_1,3,BASE_CASE) =E= EPS ; (LHS = EPS)
     
REMAINING 9 ENTRIES SKIPPED


---- f_extraWHCon1  =G=  

f_extraWHCon1(WH_1,1,BASE_CASE)..  WHTempSP(WH_1,1) - calWHTemp_noHeat(WH_1,1,BASE_CASE) - 10000*f_WHON(WH_1,1) =G= -10000 ; (LHS = 0)
     
f_extraWHCon1(WH_1,2,BASE_CASE)..  WHTempSP(WH_1,2) - calWHTemp_noHeat(WH_1,2,BASE_CASE) - 10000*f_WHON(WH_1,2) =G= -10000 ; (LHS = 0)
     
f_extraWHCon1(WH_1,3,BASE_CASE)..  WHTempSP(WH_1,3) - calWHTemp_noHeat(WH_1,3,BASE_CASE) - 10000*f_WHON(WH_1,3) =G= -10000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 50
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- f_extraWHCon2  =G=  

f_extraWHCon2(WH_1,1,BASE_CASE)..  - WHTempSP(WH_1,1) + calWHTemp_noHeat(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) =G= 0.01 ; (LHS = 0, INFES = 0.01 ****)
     
f_extraWHCon2(WH_1,2,BASE_CASE)..  - WHTempSP(WH_1,2) + calWHTemp_noHeat(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) =G= 0.01 ; (LHS = 0, INFES = 0.01 ****)
     
f_extraWHCon2(WH_1,3,BASE_CASE)..  - WHTempSP(WH_1,3) + calWHTemp_noHeat(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) =G= 0.01 ; (LHS = 0, INFES = 0.01 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- calWHTempRatedHeating  =E=  

calWHTempRatedHeating(WH_1,1,BASE_CASE)..  - 0.9986*WHTemp(WH_1,0,BASE_CASE) + calWHTemp_ratedHeat(WH_1,1,BASE_CASE) + EPS*WHAmbTemp(WH_1,1,BASE_CASE) =E= 11.5287 ; (LHS = 0, INFES = 11.5287 ****)
     
calWHTempRatedHeating(WH_1,2,BASE_CASE)..  - 0.9986*WHTemp(WH_1,1,BASE_CASE) + calWHTemp_ratedHeat(WH_1,2,BASE_CASE) + EPS*WHAmbTemp(WH_1,2,BASE_CASE) =E= 11.5287 ; (LHS = 0, INFES = 11.5287 ****)
     
calWHTempRatedHeating(WH_1,3,BASE_CASE)..  - 0.9986*WHTemp(WH_1,2,BASE_CASE) + calWHTemp_ratedHeat(WH_1,3,BASE_CASE) + EPS*WHAmbTemp(WH_1,3,BASE_CASE) =E= 11.5287 ; (LHS = 0, INFES = 11.5287 ****)
     
REMAINING 9 ENTRIES SKIPPED


---- f_calPWHSP1  =L=  

f_calPWHSP1(WH_1,1,BASE_CASE)..  0.718934485241181*WHTemp(WH_1,0,BASE_CASE) - 0.719942404607631*WHTempSP(WH_1,1) + calPWH_HeatSP(WH_1,1,BASE_CASE) + EPS*WHAmbTemp(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) =L= 10000 ; (LHS = 0)
     
f_calPWHSP1(WH_1,2,BASE_CASE)..  0.718934485241181*WHTemp(WH_1,1,BASE_CASE) - 0.719942404607631*WHTempSP(WH_1,2) + calPWH_HeatSP(WH_1,2,BASE_CASE) + EPS*WHAmbTemp(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) =L= 10000 ; (LHS = 0)
     
f_calPWHSP1(WH_1,3,BASE_CASE)..  0.718934485241181*WHTemp(WH_1,2,BASE_CASE) - 0.719942404607631*WHTempSP(WH_1,3) + calPWH_HeatSP(WH_1,3,BASE_CASE) + EPS*WHAmbTemp(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_calPWHSP2  =L=  

f_calPWHSP2(WH_1,1,BASE_CASE)..  - 0.718934485241181*WHTemp(WH_1,0,BASE_CASE) + 0.719942404607631*WHTempSP(WH_1,1) - calPWH_HeatSP(WH_1,1,BASE_CASE) + EPS*WHAmbTemp(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) =L= 10000 ; (LHS = 0)
     
f_calPWHSP2(WH_1,2,BASE_CASE)..  - 0.718934485241181*WHTemp(WH_1,1,BASE_CASE) + 0.719942404607631*WHTempSP(WH_1,2) - calPWH_HeatSP(WH_1,2,BASE_CASE) + EPS*WHAmbTemp(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) =L= 10000 ; (LHS = 0)
     
f_calPWHSP2(WH_1,3,BASE_CASE)..  - 0.718934485241181*WHTemp(WH_1,2,BASE_CASE) + 0.719942404607631*WHTempSP(WH_1,3) - calPWH_HeatSP(WH_1,3,BASE_CASE) + EPS*WHAmbTemp(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin1WH  =L=  

f_ancbin1WH(WH_1,1,BASE_CASE)..  WHTempSP(WH_1,1) - calWHTemp_noHeat(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) + 10000*f_bbb1(WH_1,1) =L= 20000 ; (LHS = 0)
     
f_ancbin1WH(WH_1,2,BASE_CASE)..  WHTempSP(WH_1,2) - calWHTemp_noHeat(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) + 10000*f_bbb1(WH_1,2) =L= 20000 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 51
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     f_ancbin1WH  =L=  

f_ancbin1WH(WH_1,3,BASE_CASE)..  WHTempSP(WH_1,3) - calWHTemp_noHeat(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) + 10000*f_bbb1(WH_1,3) =L= 20000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- ancbin2WH  =L=  

ancbin2WH(WH_1,1,BASE_CASE)..  pWH(WH_1,1,BASE_CASE) + 10000*WHON(WH_1,1) + 10000*bbb1(WH_1,1) =L= 20000 ; (LHS = 0)
     
ancbin2WH(WH_1,2,BASE_CASE)..  pWH(WH_1,2,BASE_CASE) + 10000*WHON(WH_1,2) + 10000*bbb1(WH_1,2) =L= 20000 ; (LHS = 0)
     
ancbin2WH(WH_1,3,BASE_CASE)..  pWH(WH_1,3,BASE_CASE) + 10000*WHON(WH_1,3) + 10000*bbb1(WH_1,3) =L= 20000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin3WH  =L=  

f_ancbin3WH(WH_1,1,BASE_CASE)..  - pWH(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) + 10000*f_bbb1(WH_1,1) =L= 20000 ; (LHS = 0)
     
f_ancbin3WH(WH_1,2,BASE_CASE)..  - pWH(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) + 10000*f_bbb1(WH_1,2) =L= 20000 ; (LHS = 0)
     
f_ancbin3WH(WH_1,3,BASE_CASE)..  - pWH(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) + 10000*f_bbb1(WH_1,3) =L= 20000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin4WH  =L=  

f_ancbin4WH(WH_1,1,BASE_CASE)..  WHTemp(WH_1,1,BASE_CASE) - calWHTemp_noHeat(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) + 10000*f_bbb1(WH_1,1) =L= 20000 ; (LHS = 0)
     
f_ancbin4WH(WH_1,2,BASE_CASE)..  WHTemp(WH_1,2,BASE_CASE) - calWHTemp_noHeat(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) + 10000*f_bbb1(WH_1,2) =L= 20000 ; (LHS = 0)
     
f_ancbin4WH(WH_1,3,BASE_CASE)..  WHTemp(WH_1,3,BASE_CASE) - calWHTemp_noHeat(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) + 10000*f_bbb1(WH_1,3) =L= 20000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin5WH  =L=  

f_ancbin5WH(WH_1,1,BASE_CASE)..  - WHTemp(WH_1,1,BASE_CASE) + calWHTemp_noHeat(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) + 10000*f_bbb1(WH_1,1) =L= 20000 ; (LHS = 0)
     
f_ancbin5WH(WH_1,2,BASE_CASE)..  - WHTemp(WH_1,2,BASE_CASE) + calWHTemp_noHeat(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) + 10000*f_bbb1(WH_1,2) =L= 20000 ; (LHS = 0)
     
f_ancbin5WH(WH_1,3,BASE_CASE)..  - WHTemp(WH_1,3,BASE_CASE) + calWHTemp_noHeat(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) + 10000*f_bbb1(WH_1,3) =L= 20000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 52
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- f_ancbin6WH  =L=  

f_ancbin6WH(WH_1,1,BASE_CASE)..  - WHTempSP(WH_1,1) + calWHTemp_noHeat(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) - 10000*f_bbb1(WH_1,1) =L= 10000 ; (LHS = 0)
     
f_ancbin6WH(WH_1,2,BASE_CASE)..  - WHTempSP(WH_1,2) + calWHTemp_noHeat(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) - 10000*f_bbb1(WH_1,2) =L= 10000 ; (LHS = 0)
     
f_ancbin6WH(WH_1,3,BASE_CASE)..  - WHTempSP(WH_1,3) + calWHTemp_noHeat(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) - 10000*f_bbb1(WH_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin7WH  =L=  

f_ancbin7WH(WH_1,1,BASE_CASE)..  - calPWH_HeatSP(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) - 10000*f_bbb1(WH_1,1) + 10000*f_bbb2(WH_1,1) =L= 19991.7 ; (LHS = 0)
     
f_ancbin7WH(WH_1,2,BASE_CASE)..  - calPWH_HeatSP(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) - 10000*f_bbb1(WH_1,2) + 10000*f_bbb2(WH_1,2) =L= 19991.7 ; (LHS = 0)
     
f_ancbin7WH(WH_1,3,BASE_CASE)..  - calPWH_HeatSP(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) - 10000*f_bbb1(WH_1,3) + 10000*f_bbb2(WH_1,3) =L= 19991.7 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin8WH  =L=  

f_ancbin8WH(WH_1,1,BASE_CASE)..  pWH(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) - 10000*f_bbb1(WH_1,1) + 10000*f_bbb2(WH_1,1) =L= 20008.3 ; (LHS = 0)
     
f_ancbin8WH(WH_1,2,BASE_CASE)..  pWH(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) - 10000*f_bbb1(WH_1,2) + 10000*f_bbb2(WH_1,2) =L= 20008.3 ; (LHS = 0)
     
f_ancbin8WH(WH_1,3,BASE_CASE)..  pWH(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) - 10000*f_bbb1(WH_1,3) + 10000*f_bbb2(WH_1,3) =L= 20008.3 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin9WH  =L=  

f_ancbin9WH(WH_1,1,BASE_CASE)..  - pWH(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) - 10000*f_bbb1(WH_1,1) + 10000*f_bbb2(WH_1,1) =L= 19991.7 ; (LHS = 0)
     
f_ancbin9WH(WH_1,2,BASE_CASE)..  - pWH(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) - 10000*f_bbb1(WH_1,2) + 10000*f_bbb2(WH_1,2) =L= 19991.7 ; (LHS = 0)
     
f_ancbin9WH(WH_1,3,BASE_CASE)..  - pWH(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) - 10000*f_bbb1(WH_1,3) + 10000*f_bbb2(WH_1,3) =L= 19991.7 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_ancbin10WH  =L=  

f_ancbin10WH(WH_1,1,BASE_CASE)..  WHTemp(WH_1,1,BASE_CASE) - calWHTemp_ratedHeat(WH_1,1,BASE_CASE) + 10000*f_WHON(WH_1,1) - 10000*f_bbb1(WH_1,1) + 10000*f_bbb2(WH_1,1) =L= 20000 ; (LHS = 0)
     
f_ancbin10WH(WH_1,2,BASE_CASE)..  WHTemp(WH_1,2,BASE_CASE) - calWHTemp_ratedHeat(WH_1,2,BASE_CASE) + 10000*f_WHON(WH_1,2) - 10000*f_bbb1(WH_1,2) + 10000*f_bbb2(WH_1,2) =L= 20000 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 53
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     f_ancbin10WH  =L=  

f_ancbin10WH(WH_1,3,BASE_CASE)..  WHTemp(WH_1,3,BASE_CASE) - calWHTemp_ratedHeat(WH_1,3,BASE_CASE) + 10000*f_WHON(WH_1,3) - 10000*f_bbb1(WH_1,3) + 10000*f_bbb2(WH_1,3) =L= 20000 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_EVSOCdynamicEq1Charge  =L=  

f_EVSOCdynamicEq1Charge(EV_1,1,BASE_CASE)..  - 0.0222222222222222*EVCharRate(EV_1,1,BASE_CASE) - EVSOC(EV_1,0,BASE_CASE) + EVSOC(EV_1,1,BASE_CASE) + 10000*f_EVChargeState(EV_1,1) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq1Charge(EV_1,2,BASE_CASE)..  - 0.0222222222222222*EVCharRate(EV_1,2,BASE_CASE) - EVSOC(EV_1,1,BASE_CASE) + EVSOC(EV_1,2,BASE_CASE) + 10000*f_EVChargeState(EV_1,2) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq1Charge(EV_1,3,BASE_CASE)..  - 0.0222222222222222*EVCharRate(EV_1,3,BASE_CASE) - EVSOC(EV_1,2,BASE_CASE) + EVSOC(EV_1,3,BASE_CASE) + 10000*f_EVChargeState(EV_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED


---- f_EVSOCdynamicEq2Charge  =L=  

f_EVSOCdynamicEq2Charge(EV_1,1,BASE_CASE)..  0.0222222222222222*EVCharRate(EV_1,1,BASE_CASE) + EVSOC(EV_1,0,BASE_CASE) - EVSOC(EV_1,1,BASE_CASE) + 10000*f_EVChargeState(EV_1,1) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq2Charge(EV_1,2,BASE_CASE)..  0.0222222222222222*EVCharRate(EV_1,2,BASE_CASE) + EVSOC(EV_1,1,BASE_CASE) - EVSOC(EV_1,2,BASE_CASE) + 10000*f_EVChargeState(EV_1,2) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq2Charge(EV_1,3,BASE_CASE)..  0.0222222222222222*EVCharRate(EV_1,3,BASE_CASE) + EVSOC(EV_1,2,BASE_CASE) - EVSOC(EV_1,3,BASE_CASE) + 10000*f_EVChargeState(EV_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED


---- f_EVSOCdynamicEq1Discharge  =L=  

f_EVSOCdynamicEq1Discharge(EV_1,1,BASE_CASE)..  0.0222222222222222*EVDischarRate(EV_1,1,BASE_CASE) - EVSOC(EV_1,0,BASE_CASE) + EVSOC(EV_1,1,BASE_CASE) + 10000*f_EVDischargeState(EV_1,1) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq1Discharge(EV_1,2,BASE_CASE)..  0.0222222222222222*EVDischarRate(EV_1,2,BASE_CASE) - EVSOC(EV_1,1,BASE_CASE) + EVSOC(EV_1,2,BASE_CASE) + 10000*f_EVDischargeState(EV_1,2) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq1Discharge(EV_1,3,BASE_CASE)..  0.0222222222222222*EVDischarRate(EV_1,3,BASE_CASE) - EVSOC(EV_1,2,BASE_CASE) + EVSOC(EV_1,3,BASE_CASE) + 10000*f_EVDischargeState(EV_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED


---- f_EVSOCdynamicEq2Discharge  =L=  

f_EVSOCdynamicEq2Discharge(EV_1,1,BASE_CASE)..  - 0.0222222222222222*EVDischarRate(EV_1,1,BASE_CASE) + EVSOC(EV_1,0,BASE_CASE) - EVSOC(EV_1,1,BASE_CASE) + 10000*f_EVDischargeState(EV_1,1) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq2Discharge(EV_1,2,BASE_CASE)..  - 0.0222222222222222*EVDischarRate(EV_1,2,BASE_CASE) + EVSOC(EV_1,1,BASE_CASE) - EVSOC(EV_1,2,BASE_CASE) + 10000*f_EVDischargeState(EV_1,2) =L= 10000 ; (LHS = 0)
     
f_EVSOCdynamicEq2Discharge(EV_1,3,BASE_CASE)..  - 0.0222222222222222*EVDischarRate(EV_1,3,BASE_CASE) + EVSOC(EV_1,2,BASE_CASE) - EVSOC(EV_1,3,BASE_CASE) + 10000*f_EVDischargeState(EV_1,3) =L= 10000 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 54
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- f_EVSOCdynamicEq1Idle  =L=  

f_EVSOCdynamicEq1Idle(EV_1,1,BASE_CASE)..  - EVSOC(EV_1,0,BASE_CASE) + EVSOC(EV_1,1,BASE_CASE) - 10000*f_EVChargeState(EV_1,1) - 10000*f_EVDischargeState(EV_1,1) =L= 0 ; (LHS = 0)
     
f_EVSOCdynamicEq1Idle(EV_1,2,BASE_CASE)..  - EVSOC(EV_1,1,BASE_CASE) + EVSOC(EV_1,2,BASE_CASE) - 10000*f_EVChargeState(EV_1,2) - 10000*f_EVDischargeState(EV_1,2) =L= 0 ; (LHS = 0)
     
f_EVSOCdynamicEq1Idle(EV_1,3,BASE_CASE)..  - EVSOC(EV_1,2,BASE_CASE) + EVSOC(EV_1,3,BASE_CASE) - 10000*f_EVChargeState(EV_1,3) - 10000*f_EVDischargeState(EV_1,3) =L= 0 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED


---- f_EVSOCdynamicEq2Idle  =L=  

f_EVSOCdynamicEq2Idle(EV_1,1,BASE_CASE)..  EVSOC(EV_1,0,BASE_CASE) - EVSOC(EV_1,1,BASE_CASE) - 10000*f_EVChargeState(EV_1,1) - 10000*f_EVDischargeState(EV_1,1) =L= 0 ; (LHS = 0)
     
f_EVSOCdynamicEq2Idle(EV_1,2,BASE_CASE)..  EVSOC(EV_1,1,BASE_CASE) - EVSOC(EV_1,2,BASE_CASE) - 10000*f_EVChargeState(EV_1,2) - 10000*f_EVDischargeState(EV_1,2) =L= 0 ; (LHS = 0)
     
f_EVSOCdynamicEq2Idle(EV_1,3,BASE_CASE)..  EVSOC(EV_1,2,BASE_CASE) - EVSOC(EV_1,3,BASE_CASE) - 10000*f_EVChargeState(EV_1,3) - 10000*f_EVDischargeState(EV_1,3) =L= 0 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED


---- EVOfflineEq1  =E=  

EVOfflineEq1(EV_1,0,BASE_CASE)..  EVCharRate(EV_1,0,BASE_CASE) =E= 0 ; (LHS = 0)
     
EVOfflineEq1(EV_1,11,BASE_CASE)..  EVCharRate(EV_1,11,BASE_CASE) =E= 0 ; (LHS = 0)
     
EVOfflineEq1(EV_1,12,BASE_CASE)..  EVCharRate(EV_1,12,BASE_CASE) =E= 0 ; (LHS = 0)
     

---- EVOfflineEq2  =E=  

EVOfflineEq2(EV_1,0,BASE_CASE)..  EVDischarRate(EV_1,0,BASE_CASE) =E= 0 ; (LHS = 0)
     
EVOfflineEq2(EV_1,11,BASE_CASE)..  EVDischarRate(EV_1,11,BASE_CASE) =E= 0 ; (LHS = 0)
     
EVOfflineEq2(EV_1,12,BASE_CASE)..  EVDischarRate(EV_1,12,BASE_CASE) =E= 0 ; (LHS = 0)
     

---- EViniSOCEq  =E=  

EViniSOCEq(EV_1,0,BASE_CASE)..  EVSOC(EV_1,0,BASE_CASE) =E= 0.00668 ; (LHS = 0, INFES = 0.00668 ****)
     

---- EVendSOCEq  =E=  

EVendSOCEq(EV_1,10,BASE_CASE)..  EVSOC(EV_1,10,BASE_CASE) + EVSOCSlack(10) =E= 0.92 ; (LHS = 0, INFES = 0.92 ****)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 55
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


---- f_EVubChargeCon  =L=  

f_EVubChargeCon(EV_1,1,BASE_CASE)..  EVCharRate(EV_1,1,BASE_CASE) - 5.4*f_EVChargeState(EV_1,1) =L= 0 ; (LHS = 0)
     
f_EVubChargeCon(EV_1,2,BASE_CASE)..  EVCharRate(EV_1,2,BASE_CASE) - 5.4*f_EVChargeState(EV_1,2) =L= 0 ; (LHS = 0)
     
f_EVubChargeCon(EV_1,3,BASE_CASE)..  EVCharRate(EV_1,3,BASE_CASE) - 5.4*f_EVChargeState(EV_1,3) =L= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_EVlbChargeCon  =G=  

f_EVlbChargeCon(EV_1,1,BASE_CASE)..  EVCharRate(EV_1,1,BASE_CASE) - 0.01*f_EVChargeState(EV_1,1) =G= 0 ; (LHS = 0)
     
f_EVlbChargeCon(EV_1,2,BASE_CASE)..  EVCharRate(EV_1,2,BASE_CASE) - 0.01*f_EVChargeState(EV_1,2) =G= 0 ; (LHS = 0)
     
f_EVlbChargeCon(EV_1,3,BASE_CASE)..  EVCharRate(EV_1,3,BASE_CASE) - 0.01*f_EVChargeState(EV_1,3) =G= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_EVubDischargeCon  =L=  

f_EVubDischargeCon(EV_1,1,BASE_CASE)..  EVDischarRate(EV_1,1,BASE_CASE) + EPS*f_EVDischargeState(EV_1,1) =L= 0 ; (LHS = 0)
     
f_EVubDischargeCon(EV_1,2,BASE_CASE)..  EVDischarRate(EV_1,2,BASE_CASE) + EPS*f_EVDischargeState(EV_1,2) =L= 0 ; (LHS = 0)
     
f_EVubDischargeCon(EV_1,3,BASE_CASE)..  EVDischarRate(EV_1,3,BASE_CASE) + EPS*f_EVDischargeState(EV_1,3) =L= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_EVlbDischargeCon  =G=  

f_EVlbDischargeCon(EV_1,1,BASE_CASE)..  EVDischarRate(EV_1,1,BASE_CASE) - 0.01*f_EVDischargeState(EV_1,1) =G= 0 ; (LHS = 0)
     
f_EVlbDischargeCon(EV_1,2,BASE_CASE)..  EVDischarRate(EV_1,2,BASE_CASE) - 0.01*f_EVDischargeState(EV_1,2) =G= 0 ; (LHS = 0)
     
f_EVlbDischargeCon(EV_1,3,BASE_CASE)..  EVDischarRate(EV_1,3,BASE_CASE) - 0.01*f_EVDischargeState(EV_1,3) =G= 0 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- f_EVStateCon  =L=  

f_EVStateCon(EV_1,1,BASE_CASE)..  f_EVChargeState(EV_1,1) + f_EVDischargeState(EV_1,1) =L= 1 ; (LHS = 0)
     
f_EVStateCon(EV_1,2,BASE_CASE)..  f_EVChargeState(EV_1,2) + f_EVDischargeState(EV_1,2) =L= 1 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 56
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     f_EVStateCon  =L=  

f_EVStateCon(EV_1,3,BASE_CASE)..  f_EVChargeState(EV_1,3) + f_EVDischargeState(EV_1,3) =L= 1 ; (LHS = 0)
     
REMAINING 9 ENTRIES SKIPPED


---- EVubSOC  =L=  

EVubSOC(EV_1,1,BASE_CASE)..  EVSOC(EV_1,1,BASE_CASE) =L= 1 ; (LHS = 0)
     
EVubSOC(EV_1,2,BASE_CASE)..  EVSOC(EV_1,2,BASE_CASE) =L= 1 ; (LHS = 0)
     
EVubSOC(EV_1,3,BASE_CASE)..  EVSOC(EV_1,3,BASE_CASE) =L= 1 ; (LHS = 0)
     
REMAINING 7 ENTRIES SKIPPED


---- EVlbSOC  =G=  

EVlbSOC(EV_1,1,BASE_CASE)..  EVSOC(EV_1,1,BASE_CASE) =G= EPS ; (LHS = EPS)
     
EVlbSOC(EV_1,2,BASE_CASE)..  EVSOC(EV_1,2,BASE_CASE) =G= EPS ; (LHS = EPS)
     
EVlbSOC(EV_1,3,BASE_CASE)..  EVSOC(EV_1,3,BASE_CASE) =G= EPS ; (LHS = EPS)
     
REMAINING 7 ENTRIES SKIPPED


---- HVACEnergyCostDef  =E=  

HVACEnergyCostDef..  HVACEnergyCost - 0.244*pHVAC(1,BASE_CASE) - 0.244*pHVAC(2,BASE_CASE) - 0.244*pHVAC(3,BASE_CASE) - 0.244*pHVAC(4,BASE_CASE) - 0.244*pHVAC(5,BASE_CASE) - 0.244*pHVAC(6,BASE_CASE) - 0.244*pHVAC(7,BASE_CASE) - 0.244*pHVAC(8,BASE_CASE)
     
      - 0.244*pHVAC(9,BASE_CASE) - 0.244*pHVAC(10,BASE_CASE) - 0.244*pHVAC(11,BASE_CASE) - 0.32*pHVAC(12,BASE_CASE) =E= 0 ; (LHS = 0)
     

---- WHEnergyCostDef  =E=  

WHEnergyCostDef..  WHEnergyCost - 0.244*pWH(WH_1,1,BASE_CASE) - 0.244*pWH(WH_1,2,BASE_CASE) - 0.244*pWH(WH_1,3,BASE_CASE) - 0.244*pWH(WH_1,4,BASE_CASE) - 0.244*pWH(WH_1,5,BASE_CASE) - 0.244*pWH(WH_1,6,BASE_CASE) - 0.244*pWH(WH_1,7,BASE_CASE)
     
      - 0.244*pWH(WH_1,8,BASE_CASE) - 0.244*pWH(WH_1,9,BASE_CASE) - 0.244*pWH(WH_1,10,BASE_CASE) - 0.244*pWH(WH_1,11,BASE_CASE) - 0.32*pWH(WH_1,12,BASE_CASE) =E= 0 ; (LHS = 0)
     

---- EVEnergyCostDef  =E=  

EVEnergyCostDef..  EVEnergyCost - 0.244*EVCharRate(EV_1,1,BASE_CASE) - 0.244*EVCharRate(EV_1,2,BASE_CASE) - 0.244*EVCharRate(EV_1,3,BASE_CASE) - 0.244*EVCharRate(EV_1,4,BASE_CASE) - 0.244*EVCharRate(EV_1,5,BASE_CASE) - 0.244*EVCharRate(EV_1,6,BASE_CASE)
     
      - 0.244*EVCharRate(EV_1,7,BASE_CASE) - 0.244*EVCharRate(EV_1,8,BASE_CASE) - 0.244*EVCharRate(EV_1,9,BASE_CASE) - 0.244*EVCharRate(EV_1,10,BASE_CASE) - 0.244*EVCharRate(EV_1,11,BASE_CASE) - 0.32*EVCharRate(EV_1,12,BASE_CASE)
     
      + 0.244*EVDischarRate(EV_1,1,BASE_CASE) + 0.244*EVDischarRate(EV_1,2,BASE_CASE) + 0.244*EVDischarRate(EV_1,3,BASE_CASE) + 0.244*EVDischarRate(EV_1,4,BASE_CASE) + 0.244*EVDischarRate(EV_1,5,BASE_CASE) + 0.244*EVDischarRate(EV_1,6,BASE_CASE)
     
      + 0.244*EVDischarRate(EV_1,7,BASE_CASE) + 0.244*EVDischarRate(EV_1,8,BASE_CASE) + 0.244*EVDischarRate(EV_1,9,BASE_CASE) + 0.244*EVDischarRate(EV_1,10,BASE_CASE) + 0.244*EVDischarRate(EV_1,11,BASE_CASE) + 0.32*EVDischarRate(EV_1,12,BASE_CASE) =E= 0 ;
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 57
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE SHEMS_overall Using MIP From line 1745


     EVEnergyCostDef  =E=       
     
      (LHS = 0)
     

---- StorEnergyCostDef  =E=  

StorEnergyCostDef..  StorEnergyCost - 0.244*storCharRate(STORAGE_1,1,BASE_CASE) - 0.244*storCharRate(STORAGE_1,2,BASE_CASE) - 0.244*storCharRate(STORAGE_1,3,BASE_CASE) - 0.244*storCharRate(STORAGE_1,4,BASE_CASE) - 0.244*storCharRate(STORAGE_1,5,BASE_CASE)
     
      - 0.244*storCharRate(STORAGE_1,6,BASE_CASE) - 0.244*storCharRate(STORAGE_1,7,BASE_CASE) - 0.244*storCharRate(STORAGE_1,8,BASE_CASE) - 0.244*storCharRate(STORAGE_1,9,BASE_CASE) - 0.244*storCharRate(STORAGE_1,10,BASE_CASE)
     
      - 0.244*storCharRate(STORAGE_1,11,BASE_CASE) - 0.32*storCharRate(STORAGE_1,12,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,1,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,2,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,3,BASE_CASE)
     
      + 0.244*storDischarRate(STORAGE_1,4,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,5,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,6,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,7,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,8,BASE_CASE)
     
      + 0.244*storDischarRate(STORAGE_1,9,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,10,BASE_CASE) + 0.244*storDischarRate(STORAGE_1,11,BASE_CASE) + 0.32*storDischarRate(STORAGE_1,12,BASE_CASE) =E= 0 ; (LHS = 0)
     

---- PVEnergyCostDef  =E=  

PVEnergyCostDef..  PVEnergyCost =E= 0 ; (LHS = 0)
     

---- WindEnergyCostDef  =E=  

WindEnergyCostDef..  WindEnergyCost =E= 0 ; (LHS = 0)
     

---- NCLEnergycostDef  =E=  

NCLEnergycostDef..  NCLEnergycost =E= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 58
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- pGrid  

pGrid(1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -0.244   objDefEnerCost
       -0.08    objDefElecConsump
        1       elecLoadBalanceCon(1,BASE_CASE)

pGrid(2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -0.244   objDefEnerCost
       -0.08    objDefElecConsump
        1       elecLoadBalanceCon(2,BASE_CASE)

pGrid(3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -0.244   objDefEnerCost
       -0.08    objDefElecConsump
        1       elecLoadBalanceCon(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- pGridUB  

pGridUB
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       objDefPeakLoad


---- pGridSlack1  

pGridSlack1(1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
           EPS  objDefEnerCost
           EPS  objDefElecConsump

pGridSlack1(2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
           EPS  objDefEnerCost
           EPS  objDefElecConsump

pGridSlack1(3,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
           EPS  objDefEnerCost
           EPS  objDefElecConsump

REMAINING 9 ENTRIES SKIPPED

---- pGridSlack2  

pGridSlack2(1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
           EPS  objDefEnerCost
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 59
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     pGridSlack2  

           EPS  objDefElecConsump

pGridSlack2(2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
           EPS  objDefEnerCost
           EPS  objDefElecConsump

pGridSlack2(3,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
           EPS  objDefEnerCost
           EPS  objDefElecConsump

REMAINING 9 ENTRIES SKIPPED

---- energyCost  total energy cost

energyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       objDefSumObj
        1       objDefEnerCost


---- discom  total discomfort

discom
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       objDefSumObj
        1       objDefDiscom


---- elecConsump  total energy comsumption

elecConsump
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       objDefElecConsump


---- peakLoad  peak load

peakLoad
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       objDefPeakLoad


---- sumObj  overall objective function

sumObj
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       objDefSumObj

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 60
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- HVACEnergyCost  

HVACEnergyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       HVACEnergyCostDef


---- WHEnergyCost  

WHEnergyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       WHEnergyCostDef


---- EVEnergyCost  

EVEnergyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       EVEnergyCostDef


---- StorEnergyCost  

StorEnergyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       StorEnergyCostDef


---- PVEnergyCost  

PVEnergyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       PVEnergyCostDef


---- WindEnergyCost  

WindEnergyCost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       WindEnergyCostDef


---- NCLEnergycost  

NCLEnergycost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       NCLEnergycostDef

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 61
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- rmTemp  

rmTemp(0,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       inirmTempcon(0,BASE_CASE)
       -0.9     f_thermEqONCool1(1,BASE_CASE)
        0.9     f_thermEqONCool2(1,BASE_CASE)
       -0.9     calRmTempNoCooling(1,BASE_CASE)
       -0.9     calRmTempRatedCooling(1,BASE_CASE)
       -4.7695  f_calPHVACSP1(1,BASE_CASE)
        4.7695  f_calPHVACSP2(1,BASE_CASE)

rmTemp(1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_thermEqONCool1(1,BASE_CASE)
       -0.9     f_thermEqONCool1(2,BASE_CASE)
       -1       f_thermEqONCool2(1,BASE_CASE)
        0.9     f_thermEqONCool2(2,BASE_CASE)
        1       ubrmtemp(1,BASE_CASE)
        1       lbrmtemp(1,BASE_CASE)
       -0.9     calRmTempNoCooling(2,BASE_CASE)
       -0.9     calRmTempRatedCooling(2,BASE_CASE)
       -4.7695  f_calPHVACSP1(2,BASE_CASE)
        4.7695  f_calPHVACSP2(2,BASE_CASE)

rmTemp(2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_thermEqONCool1(2,BASE_CASE)
       -0.9     f_thermEqONCool1(3,BASE_CASE)
       -1       f_thermEqONCool2(2,BASE_CASE)
        0.9     f_thermEqONCool2(3,BASE_CASE)
        1       ubrmtemp(2,BASE_CASE)
        1       lbrmtemp(2,BASE_CASE)
       -0.9     calRmTempNoCooling(3,BASE_CASE)
       -0.9     calRmTempRatedCooling(3,BASE_CASE)
       -4.7695  f_calPHVACSP1(3,BASE_CASE)
        4.7695  f_calPHVACSP2(3,BASE_CASE)

REMAINING 10 ENTRIES SKIPPED

---- rmTempSP  room temperature set point

rmTempSP(1)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       SPTOUB1(1)
       -1       SPTOUB2(1)
       -1       SPTOLB3(1)
        1       SPTOLB4(1)
        5.2994  f_calPHVACSP1(1,BASE_CASE)
       -5.2994  f_calPHVACSP2(1,BASE_CASE)
        1       lbrmSetTemp(1)
        1       ubrmSetTemp(1)

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 62
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     rmTempSP  room temperature set point

rmTempSP(2)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       SPTOUB1(2)
       -1       SPTOUB2(2)
       -1       SPTOLB3(2)
        1       SPTOLB4(2)
        5.2994  f_calPHVACSP1(2,BASE_CASE)
       -5.2994  f_calPHVACSP2(2,BASE_CASE)
        1       lbrmSetTemp(2)
        1       ubrmSetTemp(2)

rmTempSP(3)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       SPTOUB1(3)
       -1       SPTOUB2(3)
       -1       SPTOLB3(3)
        1       SPTOLB4(3)
        5.2994  f_calPHVACSP1(3,BASE_CASE)
       -5.2994  f_calPHVACSP2(3,BASE_CASE)
        1       lbrmSetTemp(3)
        1       ubrmSetTemp(3)

REMAINING 9 ENTRIES SKIPPED

---- pHVAC  HVAC power consumption

pHVAC(0,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       f_ubpHVACONCool(0,BASE_CASE)
       -1       f_lbpHVACONCool(0,BASE_CASE)

pHVAC(1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       SPTOUB3(1,BASE_CASE)
        1       SPTOUB4(1,BASE_CASE)
        1       SPTOLB1(1,BASE_CASE)
       -1       SPTOLB2(1,BASE_CASE)
        1       SPTOLB5(1,BASE_CASE)
       -1       elecLoadBalanceCon(1,BASE_CASE)
        0.1887  f_thermEqONCool1(1,BASE_CASE)
       -0.1887  f_thermEqONCool2(1,BASE_CASE)
        1       f_ubpHVACONCool(1,BASE_CASE)
       -1       f_lbpHVACONCool(1,BASE_CASE)
        1       f_ubpHVACOFF1(1,BASE_CASE)
       -1       f_ubpHVACOFF2(1,BASE_CASE)
       -0.244   HVACEnergyCostDef

pHVAC(2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       SPTOUB3(2,BASE_CASE)
        1       SPTOUB4(2,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 63
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     pHVAC  HVAC power consumption

        1       SPTOLB1(2,BASE_CASE)
       -1       SPTOLB2(2,BASE_CASE)
        1       SPTOLB5(2,BASE_CASE)
       -1       elecLoadBalanceCon(2,BASE_CASE)
        0.1887  f_thermEqONCool1(2,BASE_CASE)
       -0.1887  f_thermEqONCool2(2,BASE_CASE)
        1       f_ubpHVACONCool(2,BASE_CASE)
       -1       f_lbpHVACONCool(2,BASE_CASE)
        1       f_ubpHVACOFF1(2,BASE_CASE)
       -1       f_ubpHVACOFF2(2,BASE_CASE)
       -0.244   HVACEnergyCostDef

REMAINING 10 ENTRIES SKIPPED

---- calRmTemp_noCool  calculated room temperature without HVAC

calRmTemp_noCool(1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calRmTempNoCooling(1,BASE_CASE)

calRmTemp_noCool(2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calRmTempNoCooling(2,BASE_CASE)

calRmTemp_noCool(3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calRmTempNoCooling(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- calRmTemp_ratedCool  calculated room temperature with rated HVAC power

calRmTemp_ratedCool(1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calRmTempRatedCooling(1,BASE_CASE)

calRmTemp_ratedCool(2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calRmTempRatedCooling(2,BASE_CASE)

calRmTemp_ratedCool(3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calRmTempRatedCooling(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- calPHVAC_CoolSP  calculated HVAC power with room temperature cooling setpoint

calPHVAC_CoolSP(1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_calPHVACSP1(1,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 64
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     calPHVAC_CoolSP  calculated HVAC power with room temperature cooling setpoint

       -1       f_calPHVACSP2(1,BASE_CASE)

calPHVAC_CoolSP(2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_calPHVACSP1(2,BASE_CASE)
       -1       f_calPHVACSP2(2,BASE_CASE)

calPHVAC_CoolSP(3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_calPHVACSP1(3,BASE_CASE)
       -1       f_calPHVACSP2(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- s1  

s1(1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.38    objDefDiscom
       -1       ubrmtemp(1,BASE_CASE)

s1(2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.38    objDefDiscom
       -1       ubrmtemp(2,BASE_CASE)

s1(3,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.38    objDefDiscom
       -1       ubrmtemp(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- s2  

s2(1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.38    objDefDiscom
        1       lbrmtemp(1,BASE_CASE)

s2(2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.38    objDefDiscom
        1       lbrmtemp(2,BASE_CASE)

s2(3,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.38    objDefDiscom
        1       lbrmtemp(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 65
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- WHTemp  

WHTemp(WH_1,0,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       iniWHTempcon(WH_1,0,BASE_CASE)
       -0.9986  thermEqWH(WH_1,1,BASE_CASE)
       -0.9986  calWHTempNoHeating(WH_1,1,BASE_CASE)
       -0.9986  calWHTempRatedHeating(WH_1,1,BASE_CASE)
        0.7189  f_calPWHSP1(WH_1,1,BASE_CASE)
       -0.7189  f_calPWHSP2(WH_1,1,BASE_CASE)

WHTemp(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       thermEqWH(WH_1,1,BASE_CASE)
       -0.9986  thermEqWH(WH_1,2,BASE_CASE)
        1       ubWHtemp(WH_1,1,BASE_CASE)
        1       lbWHtemp(WH_1,1,BASE_CASE)
       -0.9986  calWHTempNoHeating(WH_1,2,BASE_CASE)
       -0.9986  calWHTempRatedHeating(WH_1,2,BASE_CASE)
        0.7189  f_calPWHSP1(WH_1,2,BASE_CASE)
       -0.7189  f_calPWHSP2(WH_1,2,BASE_CASE)
        1       f_ancbin4WH(WH_1,1,BASE_CASE)
       -1       f_ancbin5WH(WH_1,1,BASE_CASE)
        1       f_ancbin10WH(WH_1,1,BASE_CASE)

WHTemp(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       thermEqWH(WH_1,2,BASE_CASE)
       -0.9986  thermEqWH(WH_1,3,BASE_CASE)
        1       ubWHtemp(WH_1,2,BASE_CASE)
        1       lbWHtemp(WH_1,2,BASE_CASE)
       -0.9986  calWHTempNoHeating(WH_1,3,BASE_CASE)
       -0.9986  calWHTempRatedHeating(WH_1,3,BASE_CASE)
        0.7189  f_calPWHSP1(WH_1,3,BASE_CASE)
       -0.7189  f_calPWHSP2(WH_1,3,BASE_CASE)
        1       f_ancbin4WH(WH_1,2,BASE_CASE)
       -1       f_ancbin5WH(WH_1,2,BASE_CASE)
        1       f_ancbin10WH(WH_1,2,BASE_CASE)

REMAINING 10 ENTRIES SKIPPED

---- WHTempSP  

WHTempSP(WH_1,1)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       ubWHSetTemp(WH_1,1)
        1       lbWHSetTemp(WH_1,1)
        1       f_extraWHCon1(WH_1,1,BASE_CASE)
       -1       f_extraWHCon2(WH_1,1,BASE_CASE)
       -0.7199  f_calPWHSP1(WH_1,1,BASE_CASE)
        0.7199  f_calPWHSP2(WH_1,1,BASE_CASE)
        1       f_ancbin1WH(WH_1,1,BASE_CASE)
       -1       f_ancbin6WH(WH_1,1,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 66
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     WHTempSP  


WHTempSP(WH_1,2)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       ubWHSetTemp(WH_1,2)
        1       lbWHSetTemp(WH_1,2)
        1       f_extraWHCon1(WH_1,2,BASE_CASE)
       -1       f_extraWHCon2(WH_1,2,BASE_CASE)
       -0.7199  f_calPWHSP1(WH_1,2,BASE_CASE)
        0.7199  f_calPWHSP2(WH_1,2,BASE_CASE)
        1       f_ancbin1WH(WH_1,2,BASE_CASE)
       -1       f_ancbin6WH(WH_1,2,BASE_CASE)

WHTempSP(WH_1,3)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       ubWHSetTemp(WH_1,3)
        1       lbWHSetTemp(WH_1,3)
        1       f_extraWHCon1(WH_1,3,BASE_CASE)
       -1       f_extraWHCon2(WH_1,3,BASE_CASE)
       -0.7199  f_calPWHSP1(WH_1,3,BASE_CASE)
        0.7199  f_calPWHSP2(WH_1,3,BASE_CASE)
        1       f_ancbin1WH(WH_1,3,BASE_CASE)
       -1       f_ancbin6WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- pWH  

pWH(WH_1,0,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       f_ubpWHONHeat(WH_1,0,BASE_CASE)

pWH(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       elecLoadBalanceCon(1,BASE_CASE)
       -1.389   thermEqWH(WH_1,1,BASE_CASE)
        1       f_ubpWHONHeat(WH_1,1,BASE_CASE)
        1       f_ubpWHOFF1(WH_1,1,BASE_CASE)
       -1       f_ubpWHOFF2(WH_1,1,BASE_CASE)
        1       ancbin2WH(WH_1,1,BASE_CASE)
       -1       f_ancbin3WH(WH_1,1,BASE_CASE)
        1       f_ancbin8WH(WH_1,1,BASE_CASE)
       -1       f_ancbin9WH(WH_1,1,BASE_CASE)
       -0.244   WHEnergyCostDef

pWH(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       elecLoadBalanceCon(2,BASE_CASE)
       -1.389   thermEqWH(WH_1,2,BASE_CASE)
        1       f_ubpWHONHeat(WH_1,2,BASE_CASE)
        1       f_ubpWHOFF1(WH_1,2,BASE_CASE)
       -1       f_ubpWHOFF2(WH_1,2,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 67
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     pWH  

        1       ancbin2WH(WH_1,2,BASE_CASE)
       -1       f_ancbin3WH(WH_1,2,BASE_CASE)
        1       f_ancbin8WH(WH_1,2,BASE_CASE)
       -1       f_ancbin9WH(WH_1,2,BASE_CASE)
       -0.244   WHEnergyCostDef

REMAINING 10 ENTRIES SKIPPED

---- calWHTemp_noHeat  

calWHTemp_noHeat(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calWHTempNoHeating(WH_1,1,BASE_CASE)
       -1       f_extraWHCon1(WH_1,1,BASE_CASE)
        1       f_extraWHCon2(WH_1,1,BASE_CASE)
       -1       f_ancbin1WH(WH_1,1,BASE_CASE)
       -1       f_ancbin4WH(WH_1,1,BASE_CASE)
        1       f_ancbin5WH(WH_1,1,BASE_CASE)
        1       f_ancbin6WH(WH_1,1,BASE_CASE)

calWHTemp_noHeat(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calWHTempNoHeating(WH_1,2,BASE_CASE)
       -1       f_extraWHCon1(WH_1,2,BASE_CASE)
        1       f_extraWHCon2(WH_1,2,BASE_CASE)
       -1       f_ancbin1WH(WH_1,2,BASE_CASE)
       -1       f_ancbin4WH(WH_1,2,BASE_CASE)
        1       f_ancbin5WH(WH_1,2,BASE_CASE)
        1       f_ancbin6WH(WH_1,2,BASE_CASE)

calWHTemp_noHeat(WH_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calWHTempNoHeating(WH_1,3,BASE_CASE)
       -1       f_extraWHCon1(WH_1,3,BASE_CASE)
        1       f_extraWHCon2(WH_1,3,BASE_CASE)
       -1       f_ancbin1WH(WH_1,3,BASE_CASE)
       -1       f_ancbin4WH(WH_1,3,BASE_CASE)
        1       f_ancbin5WH(WH_1,3,BASE_CASE)
        1       f_ancbin6WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- calWHTemp_ratedHeat  

calWHTemp_ratedHeat(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calWHTempRatedHeating(WH_1,1,BASE_CASE)
       -1       f_ancbin10WH(WH_1,1,BASE_CASE)

calWHTemp_ratedHeat(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 68
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     calWHTemp_ratedHeat  

        1       calWHTempRatedHeating(WH_1,2,BASE_CASE)
       -1       f_ancbin10WH(WH_1,2,BASE_CASE)

calWHTemp_ratedHeat(WH_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       calWHTempRatedHeating(WH_1,3,BASE_CASE)
       -1       f_ancbin10WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- calPWH_HeatSP  

calPWH_HeatSP(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_calPWHSP1(WH_1,1,BASE_CASE)
       -1       f_calPWHSP2(WH_1,1,BASE_CASE)
       -1       f_ancbin7WH(WH_1,1,BASE_CASE)

calPWH_HeatSP(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_calPWHSP1(WH_1,2,BASE_CASE)
       -1       f_calPWHSP2(WH_1,2,BASE_CASE)
       -1       f_ancbin7WH(WH_1,2,BASE_CASE)

calPWH_HeatSP(WH_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       f_calPWHSP1(WH_1,3,BASE_CASE)
       -1       f_calPWHSP2(WH_1,3,BASE_CASE)
       -1       f_ancbin7WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- s5  

s5(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.12    objDefDiscom
       -1       ubWHtemp(WH_1,1,BASE_CASE)

s5(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.12    objDefDiscom
       -1       ubWHtemp(WH_1,2,BASE_CASE)

s5(WH_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.12    objDefDiscom
       -1       ubWHtemp(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 69
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- s6  

s6(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.12    objDefDiscom
        1       lbWHtemp(WH_1,1,BASE_CASE)

s6(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.12    objDefDiscom
        1       lbWHtemp(WH_1,2,BASE_CASE)

s6(WH_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.12    objDefDiscom
        1       lbWHtemp(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- WHON  

WHON(WH_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       ancbin2WH(WH_1,1,BASE_CASE)

WHON(WH_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       ancbin2WH(WH_1,2,BASE_CASE)

WHON(WH_1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       ancbin2WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- bbb1  

bbb1(WH_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       ancbin2WH(WH_1,1,BASE_CASE)

bbb1(WH_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       ancbin2WH(WH_1,2,BASE_CASE)

bbb1(WH_1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       ancbin2WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 70
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- WHAmbTemp  

WHAmbTemp(WH_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
           EPS  thermEqWH(WH_1,1,BASE_CASE)
           EPS  calWHTempNoHeating(WH_1,1,BASE_CASE)
           EPS  calWHTempRatedHeating(WH_1,1,BASE_CASE)
           EPS  f_calPWHSP1(WH_1,1,BASE_CASE)
           EPS  f_calPWHSP2(WH_1,1,BASE_CASE)

WHAmbTemp(WH_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
           EPS  thermEqWH(WH_1,2,BASE_CASE)
           EPS  calWHTempNoHeating(WH_1,2,BASE_CASE)
           EPS  calWHTempRatedHeating(WH_1,2,BASE_CASE)
           EPS  f_calPWHSP1(WH_1,2,BASE_CASE)
           EPS  f_calPWHSP2(WH_1,2,BASE_CASE)

WHAmbTemp(WH_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
           EPS  thermEqWH(WH_1,3,BASE_CASE)
           EPS  calWHTempNoHeating(WH_1,3,BASE_CASE)
           EPS  calWHTempRatedHeating(WH_1,3,BASE_CASE)
           EPS  f_calPWHSP1(WH_1,3,BASE_CASE)
           EPS  f_calPWHSP2(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- EVCharRate  

EVCharRate(EV_1,0,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       EVOfflineEq1(EV_1,0,BASE_CASE)

EVCharRate(EV_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       elecLoadBalanceCon(1,BASE_CASE)
       -0.0222  f_EVSOCdynamicEq1Charge(EV_1,1,BASE_CASE)
        0.0222  f_EVSOCdynamicEq2Charge(EV_1,1,BASE_CASE)
        1       f_EVubChargeCon(EV_1,1,BASE_CASE)
        1       f_EVlbChargeCon(EV_1,1,BASE_CASE)
       -0.244   EVEnergyCostDef

EVCharRate(EV_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       elecLoadBalanceCon(2,BASE_CASE)
       -0.0222  f_EVSOCdynamicEq1Charge(EV_1,2,BASE_CASE)
        0.0222  f_EVSOCdynamicEq2Charge(EV_1,2,BASE_CASE)
        1       f_EVubChargeCon(EV_1,2,BASE_CASE)
        1       f_EVlbChargeCon(EV_1,2,BASE_CASE)
       -0.244   EVEnergyCostDef

REMAINING 10 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 71
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- EVDischarRate  

EVDischarRate(EV_1,0,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       EVOfflineEq2(EV_1,0,BASE_CASE)

EVDischarRate(EV_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       elecLoadBalanceCon(1,BASE_CASE)
        0.0222  f_EVSOCdynamicEq1Discharge(EV_1,1,BASE_CASE)
       -0.0222  f_EVSOCdynamicEq2Discharge(EV_1,1,BASE_CASE)
        1       f_EVubDischargeCon(EV_1,1,BASE_CASE)
        1       f_EVlbDischargeCon(EV_1,1,BASE_CASE)
        0.244   EVEnergyCostDef

EVDischarRate(EV_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       elecLoadBalanceCon(2,BASE_CASE)
        0.0222  f_EVSOCdynamicEq1Discharge(EV_1,2,BASE_CASE)
       -0.0222  f_EVSOCdynamicEq2Discharge(EV_1,2,BASE_CASE)
        1       f_EVubDischargeCon(EV_1,2,BASE_CASE)
        1       f_EVlbDischargeCon(EV_1,2,BASE_CASE)
        0.244   EVEnergyCostDef

REMAINING 10 ENTRIES SKIPPED

---- EVSOC  

EVSOC(EV_1,0,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       f_EVSOCdynamicEq1Charge(EV_1,1,BASE_CASE)
        1       f_EVSOCdynamicEq2Charge(EV_1,1,BASE_CASE)
       -1       f_EVSOCdynamicEq1Discharge(EV_1,1,BASE_CASE)
        1       f_EVSOCdynamicEq2Discharge(EV_1,1,BASE_CASE)
       -1       f_EVSOCdynamicEq1Idle(EV_1,1,BASE_CASE)
        1       f_EVSOCdynamicEq2Idle(EV_1,1,BASE_CASE)
        1       EViniSOCEq(EV_1,0,BASE_CASE)

EVSOC(EV_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       f_EVSOCdynamicEq1Charge(EV_1,1,BASE_CASE)
       -1       f_EVSOCdynamicEq1Charge(EV_1,2,BASE_CASE)
       -1       f_EVSOCdynamicEq2Charge(EV_1,1,BASE_CASE)
        1       f_EVSOCdynamicEq2Charge(EV_1,2,BASE_CASE)
        1       f_EVSOCdynamicEq1Discharge(EV_1,1,BASE_CASE)
       -1       f_EVSOCdynamicEq1Discharge(EV_1,2,BASE_CASE)
       -1       f_EVSOCdynamicEq2Discharge(EV_1,1,BASE_CASE)
        1       f_EVSOCdynamicEq2Discharge(EV_1,2,BASE_CASE)
        1       f_EVSOCdynamicEq1Idle(EV_1,1,BASE_CASE)
       -1       f_EVSOCdynamicEq1Idle(EV_1,2,BASE_CASE)
       -1       f_EVSOCdynamicEq2Idle(EV_1,1,BASE_CASE)
        1       f_EVSOCdynamicEq2Idle(EV_1,2,BASE_CASE)
        1       EVubSOC(EV_1,1,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 72
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     EVSOC  

        1       EVlbSOC(EV_1,1,BASE_CASE)

EVSOC(EV_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       f_EVSOCdynamicEq1Charge(EV_1,2,BASE_CASE)
       -1       f_EVSOCdynamicEq1Charge(EV_1,3,BASE_CASE)
       -1       f_EVSOCdynamicEq2Charge(EV_1,2,BASE_CASE)
        1       f_EVSOCdynamicEq2Charge(EV_1,3,BASE_CASE)
        1       f_EVSOCdynamicEq1Discharge(EV_1,2,BASE_CASE)
       -1       f_EVSOCdynamicEq1Discharge(EV_1,3,BASE_CASE)
       -1       f_EVSOCdynamicEq2Discharge(EV_1,2,BASE_CASE)
        1       f_EVSOCdynamicEq2Discharge(EV_1,3,BASE_CASE)
        1       f_EVSOCdynamicEq1Idle(EV_1,2,BASE_CASE)
       -1       f_EVSOCdynamicEq1Idle(EV_1,3,BASE_CASE)
       -1       f_EVSOCdynamicEq2Idle(EV_1,2,BASE_CASE)
        1       f_EVSOCdynamicEq2Idle(EV_1,3,BASE_CASE)
        1       EVubSOC(EV_1,2,BASE_CASE)
        1       EVlbSOC(EV_1,2,BASE_CASE)

REMAINING 8 ENTRIES SKIPPED

---- EVSOCSlack  

EVSOCSlack(1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      -45       objDefEnerCost
      -45       objDefElecConsump
       -1       objDefPeakLoad

EVSOCSlack(2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      -45       objDefEnerCost
      -45       objDefElecConsump
       -1       objDefPeakLoad

EVSOCSlack(3)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      -45       objDefEnerCost
      -45       objDefElecConsump
       -1       objDefPeakLoad

REMAINING 9 ENTRIES SKIPPED

---- storCharRate  

storCharRate(STORAGE_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -0.244   StorEnergyCostDef

storCharRate(STORAGE_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 73
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     storCharRate  

       -0.244   StorEnergyCostDef

storCharRate(STORAGE_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -0.244   StorEnergyCostDef

REMAINING 9 ENTRIES SKIPPED

---- storDischarRate  

storDischarRate(STORAGE_1,1,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        0.244   StorEnergyCostDef

storDischarRate(STORAGE_1,2,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        0.244   StorEnergyCostDef

storDischarRate(STORAGE_1,3,BASE_CASE)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        0.244   StorEnergyCostDef

REMAINING 9 ENTRIES SKIPPED

---- f_ON  HVAC ON=1 or OFF=0 state

f_ON(1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
   -10000       f_ubpHVACOFF1(1,BASE_CASE)
   -10000       f_ubpHVACOFF2(1,BASE_CASE)

f_ON(2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
   -10000       f_ubpHVACOFF1(2,BASE_CASE)
   -10000       f_ubpHVACOFF2(2,BASE_CASE)

f_ON(3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
   -10000       f_ubpHVACOFF1(3,BASE_CASE)
   -10000       f_ubpHVACOFF2(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- f_h  heating state

f_h(1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       f_branch1(1,BASE_CASE)

f_h(2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 74
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     f_h  heating state

        1       f_branch1(2,BASE_CASE)

f_h(3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       f_branch1(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- f_WHON  

f_WHON(WH_1,0)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
       -8.3     f_ubpWHONHeat(WH_1,0,BASE_CASE)

f_WHON(WH_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
       -8.3     f_ubpWHONHeat(WH_1,1,BASE_CASE)
   -10000       f_ubpWHOFF1(WH_1,1,BASE_CASE)
   -10000       f_ubpWHOFF2(WH_1,1,BASE_CASE)
   -10000       f_extraWHCon1(WH_1,1,BASE_CASE)
    10000       f_extraWHCon2(WH_1,1,BASE_CASE)
    10000       f_calPWHSP1(WH_1,1,BASE_CASE)
    10000       f_calPWHSP2(WH_1,1,BASE_CASE)
    10000       f_ancbin1WH(WH_1,1,BASE_CASE)
    10000       f_ancbin3WH(WH_1,1,BASE_CASE)
    10000       f_ancbin4WH(WH_1,1,BASE_CASE)
    10000       f_ancbin5WH(WH_1,1,BASE_CASE)
    10000       f_ancbin6WH(WH_1,1,BASE_CASE)
    10000       f_ancbin7WH(WH_1,1,BASE_CASE)
    10000       f_ancbin8WH(WH_1,1,BASE_CASE)
    10000       f_ancbin9WH(WH_1,1,BASE_CASE)
    10000       f_ancbin10WH(WH_1,1,BASE_CASE)

f_WHON(WH_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
       -8.3     f_ubpWHONHeat(WH_1,2,BASE_CASE)
   -10000       f_ubpWHOFF1(WH_1,2,BASE_CASE)
   -10000       f_ubpWHOFF2(WH_1,2,BASE_CASE)
   -10000       f_extraWHCon1(WH_1,2,BASE_CASE)
    10000       f_extraWHCon2(WH_1,2,BASE_CASE)
    10000       f_calPWHSP1(WH_1,2,BASE_CASE)
    10000       f_calPWHSP2(WH_1,2,BASE_CASE)
    10000       f_ancbin1WH(WH_1,2,BASE_CASE)
    10000       f_ancbin3WH(WH_1,2,BASE_CASE)
    10000       f_ancbin4WH(WH_1,2,BASE_CASE)
    10000       f_ancbin5WH(WH_1,2,BASE_CASE)
    10000       f_ancbin6WH(WH_1,2,BASE_CASE)
    10000       f_ancbin7WH(WH_1,2,BASE_CASE)
    10000       f_ancbin8WH(WH_1,2,BASE_CASE)
    10000       f_ancbin9WH(WH_1,2,BASE_CASE)
    10000       f_ancbin10WH(WH_1,2,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 75
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     f_WHON  


REMAINING 10 ENTRIES SKIPPED

---- f_bbb1  

f_bbb1(WH_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_ancbin1WH(WH_1,1,BASE_CASE)
    10000       f_ancbin3WH(WH_1,1,BASE_CASE)
    10000       f_ancbin4WH(WH_1,1,BASE_CASE)
    10000       f_ancbin5WH(WH_1,1,BASE_CASE)
   -10000       f_ancbin6WH(WH_1,1,BASE_CASE)
   -10000       f_ancbin7WH(WH_1,1,BASE_CASE)
   -10000       f_ancbin8WH(WH_1,1,BASE_CASE)
   -10000       f_ancbin9WH(WH_1,1,BASE_CASE)
   -10000       f_ancbin10WH(WH_1,1,BASE_CASE)

f_bbb1(WH_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_ancbin1WH(WH_1,2,BASE_CASE)
    10000       f_ancbin3WH(WH_1,2,BASE_CASE)
    10000       f_ancbin4WH(WH_1,2,BASE_CASE)
    10000       f_ancbin5WH(WH_1,2,BASE_CASE)
   -10000       f_ancbin6WH(WH_1,2,BASE_CASE)
   -10000       f_ancbin7WH(WH_1,2,BASE_CASE)
   -10000       f_ancbin8WH(WH_1,2,BASE_CASE)
   -10000       f_ancbin9WH(WH_1,2,BASE_CASE)
   -10000       f_ancbin10WH(WH_1,2,BASE_CASE)

f_bbb1(WH_1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_ancbin1WH(WH_1,3,BASE_CASE)
    10000       f_ancbin3WH(WH_1,3,BASE_CASE)
    10000       f_ancbin4WH(WH_1,3,BASE_CASE)
    10000       f_ancbin5WH(WH_1,3,BASE_CASE)
   -10000       f_ancbin6WH(WH_1,3,BASE_CASE)
   -10000       f_ancbin7WH(WH_1,3,BASE_CASE)
   -10000       f_ancbin8WH(WH_1,3,BASE_CASE)
   -10000       f_ancbin9WH(WH_1,3,BASE_CASE)
   -10000       f_ancbin10WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- f_bbb2  

f_bbb2(WH_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_ancbin7WH(WH_1,1,BASE_CASE)
    10000       f_ancbin8WH(WH_1,1,BASE_CASE)
    10000       f_ancbin9WH(WH_1,1,BASE_CASE)
    10000       f_ancbin10WH(WH_1,1,BASE_CASE)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 76
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     f_bbb2  


f_bbb2(WH_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_ancbin7WH(WH_1,2,BASE_CASE)
    10000       f_ancbin8WH(WH_1,2,BASE_CASE)
    10000       f_ancbin9WH(WH_1,2,BASE_CASE)
    10000       f_ancbin10WH(WH_1,2,BASE_CASE)

f_bbb2(WH_1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_ancbin7WH(WH_1,3,BASE_CASE)
    10000       f_ancbin8WH(WH_1,3,BASE_CASE)
    10000       f_ancbin9WH(WH_1,3,BASE_CASE)
    10000       f_ancbin10WH(WH_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- f_EVChargeState  

f_EVChargeState(EV_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_EVSOCdynamicEq1Charge(EV_1,1,BASE_CASE)
    10000       f_EVSOCdynamicEq2Charge(EV_1,1,BASE_CASE)
   -10000       f_EVSOCdynamicEq1Idle(EV_1,1,BASE_CASE)
   -10000       f_EVSOCdynamicEq2Idle(EV_1,1,BASE_CASE)
       -5.4     f_EVubChargeCon(EV_1,1,BASE_CASE)
       -0.01    f_EVlbChargeCon(EV_1,1,BASE_CASE)
        1       f_EVStateCon(EV_1,1,BASE_CASE)

f_EVChargeState(EV_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_EVSOCdynamicEq1Charge(EV_1,2,BASE_CASE)
    10000       f_EVSOCdynamicEq2Charge(EV_1,2,BASE_CASE)
   -10000       f_EVSOCdynamicEq1Idle(EV_1,2,BASE_CASE)
   -10000       f_EVSOCdynamicEq2Idle(EV_1,2,BASE_CASE)
       -5.4     f_EVubChargeCon(EV_1,2,BASE_CASE)
       -0.01    f_EVlbChargeCon(EV_1,2,BASE_CASE)
        1       f_EVStateCon(EV_1,2,BASE_CASE)

f_EVChargeState(EV_1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_EVSOCdynamicEq1Charge(EV_1,3,BASE_CASE)
    10000       f_EVSOCdynamicEq2Charge(EV_1,3,BASE_CASE)
   -10000       f_EVSOCdynamicEq1Idle(EV_1,3,BASE_CASE)
   -10000       f_EVSOCdynamicEq2Idle(EV_1,3,BASE_CASE)
       -5.4     f_EVubChargeCon(EV_1,3,BASE_CASE)
       -0.01    f_EVlbChargeCon(EV_1,3,BASE_CASE)
        1       f_EVStateCon(EV_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 77
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


---- f_EVDischargeState  

f_EVDischargeState(EV_1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_EVSOCdynamicEq1Discharge(EV_1,1,BASE_CASE)
    10000       f_EVSOCdynamicEq2Discharge(EV_1,1,BASE_CASE)
   -10000       f_EVSOCdynamicEq1Idle(EV_1,1,BASE_CASE)
   -10000       f_EVSOCdynamicEq2Idle(EV_1,1,BASE_CASE)
           EPS  f_EVubDischargeCon(EV_1,1,BASE_CASE)
       -0.01    f_EVlbDischargeCon(EV_1,1,BASE_CASE)
        1       f_EVStateCon(EV_1,1,BASE_CASE)

f_EVDischargeState(EV_1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_EVSOCdynamicEq1Discharge(EV_1,2,BASE_CASE)
    10000       f_EVSOCdynamicEq2Discharge(EV_1,2,BASE_CASE)
   -10000       f_EVSOCdynamicEq1Idle(EV_1,2,BASE_CASE)
   -10000       f_EVSOCdynamicEq2Idle(EV_1,2,BASE_CASE)
           EPS  f_EVubDischargeCon(EV_1,2,BASE_CASE)
       -0.01    f_EVlbDischargeCon(EV_1,2,BASE_CASE)
        1       f_EVStateCon(EV_1,2,BASE_CASE)

f_EVDischargeState(EV_1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       f_EVSOCdynamicEq1Discharge(EV_1,3,BASE_CASE)
    10000       f_EVSOCdynamicEq2Discharge(EV_1,3,BASE_CASE)
   -10000       f_EVSOCdynamicEq1Idle(EV_1,3,BASE_CASE)
   -10000       f_EVSOCdynamicEq2Idle(EV_1,3,BASE_CASE)
           EPS  f_EVubDischargeCon(EV_1,3,BASE_CASE)
       -0.01    f_EVlbDischargeCon(EV_1,3,BASE_CASE)
        1       f_EVStateCon(EV_1,3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- ifrated  

ifrated(1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       SPTOLB1(1,BASE_CASE)
    10000       SPTOLB2(1,BASE_CASE)
    10000       SPTOLB3(1)
    10000       SPTOLB4(1)
   -10000       SPTOLB5(1,BASE_CASE)

ifrated(2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       SPTOLB1(2,BASE_CASE)
    10000       SPTOLB2(2,BASE_CASE)
    10000       SPTOLB3(2)
    10000       SPTOLB4(2)
   -10000       SPTOLB5(2,BASE_CASE)

ifrated(3)
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 78
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE SHEMS_overall Using MIP From line 1745


     ifrated  

                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       SPTOLB1(3,BASE_CASE)
    10000       SPTOLB2(3,BASE_CASE)
    10000       SPTOLB3(3)
    10000       SPTOLB4(3)
   -10000       SPTOLB5(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED

---- ifzero  

ifzero(1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       SPTOUB1(1)
    10000       SPTOUB2(1)
   -10000       SPTOUB3(1,BASE_CASE)
    10000       SPTOUB4(1,BASE_CASE)

ifzero(2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       SPTOUB1(2)
    10000       SPTOUB2(2)
   -10000       SPTOUB3(2,BASE_CASE)
    10000       SPTOUB4(2,BASE_CASE)

ifzero(3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       SPTOUB1(3)
    10000       SPTOUB2(3)
   -10000       SPTOUB3(3,BASE_CASE)
    10000       SPTOUB4(3,BASE_CASE)

REMAINING 9 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 79
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE SHEMS_overall Using MIP From line 1745


MODEL STATISTICS

BLOCKS OF EQUATIONS          80     SINGLE EQUATIONS          753
BLOCKS OF VARIABLES          50     SINGLE VARIABLES          463
NON ZERO ELEMENTS         2,186     DISCRETE VARIABLES        133


GENERATION TIME      =        0.016 SECONDS      4 MB  24.7.4 r58773 WEX-WEI


EXECUTION TIME       =        0.031 SECONDS      4 MB  24.7.4 r58773 WEX-WEI
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 80
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


               S O L V E      S U M M A R Y

     MODEL   SHEMS_overall       OBJECTIVE  sumObj
     TYPE    MIP                 DIRECTION  MINIMIZE
     SOLVER  CPLEX               FROM LINE  1745

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      1 Optimal                   
**** OBJECTIVE VALUE               28.8675

 RESOURCE USAGE, LIMIT          0.062       300.000
 ITERATION COUNT, LIMIT        47    2000000000

IBM ILOG CPLEX   24.7.4 r58773 Released Sep 19, 2016 WEI x86 64bit/MS Windows 
--- GAMS/Cplex licensed for continuous and discrete problems.
Cplex 12.6.3.0

Space for names approximately 0.04 Mb
Use option 'names no' to turn use of names off
MIP status(101): integer optimal solution
Cplex Time: 0.06sec (det. 15.25 ticks)
Fixing integer variables, and solving final LP...
Fixed MIP status(1): optimal
Cplex Time: 0.00sec (det. 0.83 ticks)
Proven optimal solution.

MIP Solution:           28.867462    (16 iterations, 0 nodes)
Final Solve:            28.867462    (31 iterations)

Best possible:          28.867462
Absolute gap:            0.000000
Relative gap:            0.000000


---- EQU SPTOUB1  

          LOWER          LEVEL          UPPER         MARGINAL

1         -INF           70.0000     10085.0000          .          
2         -INF           70.0000     10085.0000          .          
3         -INF           70.0000     10085.0000          .          
4         -INF           70.0000     10085.0000          .          
5         -INF           70.0000     10085.0000          .          
6         -INF           70.0000     10085.0000          .          
7         -INF           70.0000     10085.0000          .          
8         -INF           70.0000     10085.0000          .          
9         -INF           70.0000     10085.0000          .          
10        -INF        10085.0000     10085.0000          .          
11        -INF        10085.0000     10085.0000          .          
12        -INF        10085.0000     10085.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 81
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU SPTOUB2  

          LOWER          LEVEL          UPPER         MARGINAL

1         -INF          -70.0000      9915.0000          .          
2         -INF          -70.0000      9915.0000          .          
3         -INF          -70.0000      9915.0000          .          
4         -INF          -70.0000      9915.0000          .          
5         -INF          -70.0000      9915.0000          .          
6         -INF          -70.0000      9915.0000          .          
7         -INF          -70.0000      9915.0000          .          
8         -INF          -70.0000      9915.0000          .          
9         -INF          -70.0000      9915.0000          .          
10        -INF         9915.0000      9915.0000         EPS         
11        -INF         9915.0000      9915.0000         EPS         
12        -INF         9915.0000      9915.0000         EPS         

---- EQU SPTOUB3  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           -6.9781        -0.0100          .          
2 .BASE_CASE        -INF           -6.8892        -0.0100          .          
3 .BASE_CASE        -INF           -5.8294        -0.0100          .          
4 .BASE_CASE        -INF           -5.2994        -0.0100          .          
5 .BASE_CASE        -INF           -5.2994        -0.0100          .          
6 .BASE_CASE        -INF           -5.2994        -0.0100          .          
7 .BASE_CASE        -INF           -5.2994        -0.0100          .          
8 .BASE_CASE        -INF           -5.2994        -0.0100          .          
9 .BASE_CASE        -INF           -5.8294        -0.0100          .          
10.BASE_CASE        -INF       -10000.0000        -0.0100          .          
11.BASE_CASE        -INF       -10000.0000        -0.0100          .          
12.BASE_CASE        -INF       -10000.0000        -0.0100          .          

---- EQU SPTOUB4  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF            6.9781     10000.0000          .          
2 .BASE_CASE        -INF            6.8892     10000.0000          .          
3 .BASE_CASE        -INF            5.8294     10000.0000          .          
4 .BASE_CASE        -INF            5.2994     10000.0000          .          
5 .BASE_CASE        -INF            5.2994     10000.0000          .          
6 .BASE_CASE        -INF            5.2994     10000.0000          .          
7 .BASE_CASE        -INF            5.2994     10000.0000          .          
8 .BASE_CASE        -INF            5.2994     10000.0000          .          
9 .BASE_CASE        -INF            5.8294     10000.0000          .          
10.BASE_CASE        -INF        10000.0000     10000.0000          .          
11.BASE_CASE        -INF        10000.0000     10000.0000          .          
12.BASE_CASE        -INF        10000.0000     10000.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 82
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU SPTOLB1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF            6.9781     10021.2000          .          
2 .BASE_CASE        -INF            6.8892     10021.2000          .          
3 .BASE_CASE        -INF            5.8294     10021.2000          .          
4 .BASE_CASE        -INF            5.2994     10021.2000          .          
5 .BASE_CASE        -INF            5.2994     10021.2000          .          
6 .BASE_CASE        -INF            5.2994     10021.2000          .          
7 .BASE_CASE        -INF            5.2994     10021.2000          .          
8 .BASE_CASE        -INF            5.2994     10021.2000          .          
9 .BASE_CASE        -INF            5.8294     10021.2000          .          
10.BASE_CASE        -INF             .         10021.2000          .          
11.BASE_CASE        -INF             .         10021.2000          .          
12.BASE_CASE        -INF             .         10021.2000          .          

---- EQU SPTOLB2  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           -6.9781      9978.8000          .          
2 .BASE_CASE        -INF           -6.8892      9978.8000          .          
3 .BASE_CASE        -INF           -5.8294      9978.8000          .          
4 .BASE_CASE        -INF           -5.2994      9978.8000          .          
5 .BASE_CASE        -INF           -5.2994      9978.8000          .          
6 .BASE_CASE        -INF           -5.2994      9978.8000          .          
7 .BASE_CASE        -INF           -5.2994      9978.8000          .          
8 .BASE_CASE        -INF           -5.2994      9978.8000          .          
9 .BASE_CASE        -INF           -5.8294      9978.8000          .          
10.BASE_CASE        -INF             .          9978.8000          .          
11.BASE_CASE        -INF             .          9978.8000          .          
12.BASE_CASE        -INF             .          9978.8000          .          

---- EQU SPTOLB3  

          LOWER          LEVEL          UPPER         MARGINAL

1         -INF          -70.0000      9930.0000          .          
2         -INF          -70.0000      9930.0000          .          
3         -INF          -70.0000      9930.0000          .          
4         -INF          -70.0000      9930.0000          .          
5         -INF          -70.0000      9930.0000          .          
6         -INF          -70.0000      9930.0000          .          
7         -INF          -70.0000      9930.0000          .          
8         -INF          -70.0000      9930.0000          .          
9         -INF          -70.0000      9930.0000          .          
10        -INF          -85.0000      9930.0000          .          
11        -INF          -85.0000      9930.0000          .          
12        -INF          -85.0000      9930.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 83
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU SPTOLB4  

          LOWER          LEVEL          UPPER         MARGINAL

1         -INF           70.0000     10070.0000          .          
2         -INF           70.0000     10070.0000          .          
3         -INF           70.0000     10070.0000          .          
4         -INF           70.0000     10070.0000          .          
5         -INF           70.0000     10070.0000          .          
6         -INF           70.0000     10070.0000          .          
7         -INF           70.0000     10070.0000          .          
8         -INF           70.0000     10070.0000          .          
9         -INF           70.0000     10070.0000          .          
10        -INF           85.0000     10070.0000          .          
11        -INF           85.0000     10070.0000          .          
12        -INF           85.0000     10070.0000          .          

---- EQU SPTOLB5  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF            6.9781        21.1900          .          
2 .BASE_CASE        -INF            6.8892        21.1900          .          
3 .BASE_CASE        -INF            5.8294        21.1900          .          
4 .BASE_CASE        -INF            5.2994        21.1900          .          
5 .BASE_CASE        -INF            5.2994        21.1900          .          
6 .BASE_CASE        -INF            5.2994        21.1900          .          
7 .BASE_CASE        -INF            5.2994        21.1900          .          
8 .BASE_CASE        -INF            5.2994        21.1900          .          
9 .BASE_CASE        -INF            5.8294        21.1900          .          
10.BASE_CASE        -INF             .            21.1900          .          
11.BASE_CASE        -INF             .            21.1900          .          
12.BASE_CASE        -INF             .            21.1900          .          

                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU objDefSum~          .              .              .             1.0000      
---- EQU objDefEne~          .              .              .             1.0000      
---- EQU objDefDis~          .              .              .             1.0000      
---- EQU objDefEle~          .              .              .             EPS         
---- EQU objDefPea~          .              .              .             EPS         

---- EQU elecLoadBalanceCon  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE          .              .              .             0.2440      
2 .BASE_CASE          .              .              .             0.2440      
3 .BASE_CASE          .              .              .             0.2440      
4 .BASE_CASE          .              .              .             0.2440      
5 .BASE_CASE          .              .              .             0.2440      
6 .BASE_CASE          .              .              .             0.2440      
7 .BASE_CASE          .              .              .             0.2440      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 84
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU elecLoadBalanceCon  

                    LOWER          LEVEL          UPPER         MARGINAL

8 .BASE_CASE          .              .              .             0.2440      
9 .BASE_CASE          .              .              .             0.2440      
10.BASE_CASE          .              .              .             0.2440      
11.BASE_CASE          .              .              .             0.2440      
12.BASE_CASE          .              .              .             0.3200      

---- EQU inirmTempcon  

                   LOWER          LEVEL          UPPER         MARGINAL

0.BASE_CASE        75.2409        75.2409        75.2409         1.1638      

---- EQU f_thermEqONCool1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF            8.6000         8.6000          .          
2 .BASE_CASE        -INF            8.8000         8.8000          .          
3 .BASE_CASE        -INF            8.6000         8.6000          .          
4 .BASE_CASE        -INF            8.5000         8.5000          .          
5 .BASE_CASE        -INF            8.5000         8.5000          .          
6 .BASE_CASE        -INF            8.5000         8.5000          .          
7 .BASE_CASE        -INF            8.5000         8.5000          .          
8 .BASE_CASE        -INF            8.5000         8.5000          .          
9 .BASE_CASE        -INF            8.6000         8.6000          .          
10.BASE_CASE        -INF            8.9000         8.9000          .          
11.BASE_CASE        -INF            9.2000         9.2000          .          
12.BASE_CASE        -INF            9.5000         9.5000          .          

---- EQU f_thermEqONCool2  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           -8.6000        -8.6000        -1.2931      
2 .BASE_CASE        -INF           -8.8000        -8.8000        -1.2931      
3 .BASE_CASE        -INF           -8.6000        -8.6000        -1.2931      
4 .BASE_CASE        -INF           -8.5000        -8.5000        -1.2931      
5 .BASE_CASE        -INF           -8.5000        -8.5000        -1.2931      
6 .BASE_CASE        -INF           -8.5000        -8.5000        -1.2931      
7 .BASE_CASE        -INF           -8.5000        -8.5000        -1.2931      
8 .BASE_CASE        -INF           -8.5000        -8.5000        -1.2931      
9 .BASE_CASE        -INF           -8.6000        -8.6000        -1.2931      
10.BASE_CASE        -INF           -8.9000        -8.9000        -1.0298      
11.BASE_CASE        -INF           -9.2000        -9.2000        -0.7220      
12.BASE_CASE        -INF           -9.5000        -9.5000        -0.3800      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 85
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU ubrmtemp  upper bound of room temperature

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
2 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
3 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
4 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
5 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
6 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
7 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
8 .BASE_CASE        -INF           75.0000        75.0000        -0.1293      
9 .BASE_CASE        -INF           75.0000        75.0000        -0.3662      
10.BASE_CASE        -INF           75.0000        75.0000        -0.3800      
11.BASE_CASE        -INF           75.0000        75.0000        -0.3800      
12.BASE_CASE        -INF           75.0000        75.0000        -0.3800      

---- EQU lbrmtemp  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        75.0000        75.0000        +INF             .          
2 .BASE_CASE        75.0000        75.0000        +INF             .          
3 .BASE_CASE        75.0000        75.0000        +INF             .          
4 .BASE_CASE        75.0000        75.0000        +INF             .          
5 .BASE_CASE        75.0000        75.0000        +INF             .          
6 .BASE_CASE        75.0000        75.0000        +INF             .          
7 .BASE_CASE        75.0000        75.0000        +INF             .          
8 .BASE_CASE        75.0000        75.0000        +INF             .          
9 .BASE_CASE        75.0000        75.0000        +INF             .          
10.BASE_CASE        75.0000        76.4000        +INF             .          
11.BASE_CASE        75.0000        77.9600        +INF             .          
12.BASE_CASE        75.0000        79.6640        +INF             .          

---- EQU f_ubpHVACONCool  upper bound of HVAC power

                    LOWER          LEVEL          UPPER         MARGINAL

0 .BASE_CASE        -INF             .            21.2000          .          
1 .BASE_CASE        -INF            6.9781        21.2000          .          
2 .BASE_CASE        -INF            6.8892        21.2000          .          
3 .BASE_CASE        -INF            5.8294        21.2000          .          
4 .BASE_CASE        -INF            5.2994        21.2000          .          
5 .BASE_CASE        -INF            5.2994        21.2000          .          
6 .BASE_CASE        -INF            5.2994        21.2000          .          
7 .BASE_CASE        -INF            5.2994        21.2000          .          
8 .BASE_CASE        -INF            5.2994        21.2000          .          
9 .BASE_CASE        -INF            5.8294        21.2000          .          
10.BASE_CASE        -INF             .            21.2000          .          
11.BASE_CASE        -INF             .            21.2000          .          
12.BASE_CASE        -INF             .            21.2000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 86
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_lbpHVACONCool  

                    LOWER          LEVEL          UPPER         MARGINAL

0 .BASE_CASE        -INF             .              .              .          
1 .BASE_CASE        -INF           -6.9781          .              .          
2 .BASE_CASE        -INF           -6.8892          .              .          
3 .BASE_CASE        -INF           -5.8294          .              .          
4 .BASE_CASE        -INF           -5.2994          .              .          
5 .BASE_CASE        -INF           -5.2994          .              .          
6 .BASE_CASE        -INF           -5.2994          .              .          
7 .BASE_CASE        -INF           -5.2994          .              .          
8 .BASE_CASE        -INF           -5.2994          .              .          
9 .BASE_CASE        -INF           -5.8294          .              .          
10.BASE_CASE        -INF             .              .              .          
11.BASE_CASE        -INF             .              .              .          
12.BASE_CASE        -INF             .              .              .          

---- EQU f_ubpHVACOFF1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF        -9993.0219          .              .          
2 .BASE_CASE        -INF        -9993.1108          .              .          
3 .BASE_CASE        -INF        -9994.1706          .              .          
4 .BASE_CASE        -INF        -9994.7006          .              .          
5 .BASE_CASE        -INF        -9994.7006          .              .          
6 .BASE_CASE        -INF        -9994.7006          .              .          
7 .BASE_CASE        -INF        -9994.7006          .              .          
8 .BASE_CASE        -INF        -9994.7006          .              .          
9 .BASE_CASE        -INF        -9994.1706          .              .          
10.BASE_CASE        -INF       -10000.0000          .              .          
11.BASE_CASE        -INF       -10000.0000          .              .          
12.BASE_CASE        -INF       -10000.0000          .              .          

---- EQU f_ubpHVACOFF2  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF       -10006.9781          .              .          
2 .BASE_CASE        -INF       -10006.8892          .              .          
3 .BASE_CASE        -INF       -10005.8294          .              .          
4 .BASE_CASE        -INF       -10005.2994          .              .          
5 .BASE_CASE        -INF       -10005.2994          .              .          
6 .BASE_CASE        -INF       -10005.2994          .              .          
7 .BASE_CASE        -INF       -10005.2994          .              .          
8 .BASE_CASE        -INF       -10005.2994          .              .          
9 .BASE_CASE        -INF       -10005.8294          .              .          
10.BASE_CASE        -INF       -10000.0000          .              .          
11.BASE_CASE        -INF       -10000.0000          .              .          
12.BASE_CASE        -INF       -10000.0000          .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 87
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU calRmTempNoCooling  calculate room temperature without cooling from HVAC

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE         8.6000         8.6000         8.6000         EPS         
2 .BASE_CASE         8.8000         8.8000         8.8000         EPS         
3 .BASE_CASE         8.6000         8.6000         8.6000         EPS         
4 .BASE_CASE         8.5000         8.5000         8.5000         EPS         
5 .BASE_CASE         8.5000         8.5000         8.5000         EPS         
6 .BASE_CASE         8.5000         8.5000         8.5000         EPS         
7 .BASE_CASE         8.5000         8.5000         8.5000         EPS         
8 .BASE_CASE         8.5000         8.5000         8.5000         EPS         
9 .BASE_CASE         8.6000         8.6000         8.6000         EPS         
10.BASE_CASE         8.9000         8.9000         8.9000         EPS         
11.BASE_CASE         9.2000         9.2000         9.2000         EPS         
12.BASE_CASE         9.5000         9.5000         9.5000         EPS         

---- EQU calRmTempRatedCooling  calculate room temperature with full power from HVAC

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE         4.5996         4.5996         4.5996         EPS         
2 .BASE_CASE         4.7996         4.7996         4.7996         EPS         
3 .BASE_CASE         4.5996         4.5996         4.5996         EPS         
4 .BASE_CASE         4.4996         4.4996         4.4996         EPS         
5 .BASE_CASE         4.4996         4.4996         4.4996         EPS         
6 .BASE_CASE         4.4996         4.4996         4.4996         EPS         
7 .BASE_CASE         4.4996         4.4996         4.4996         EPS         
8 .BASE_CASE         4.4996         4.4996         4.4996         EPS         
9 .BASE_CASE         4.5996         4.5996         4.5996         EPS         
10.BASE_CASE         4.8996         4.8996         4.8996         EPS         
11.BASE_CASE         5.1996         5.1996         5.1996         EPS         
12.BASE_CASE         5.4996         5.4996         5.4996         EPS         

---- EQU f_calPHVACSP1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           45.5750        45.5750         EPS         
2 .BASE_CASE        -INF           46.6349        46.6349         EPS         
3 .BASE_CASE        -INF           45.5750        45.5750         EPS         
4 .BASE_CASE        -INF           45.0450        45.0450         EPS         
5 .BASE_CASE        -INF           45.0450        45.0450         EPS         
6 .BASE_CASE        -INF           45.0450        45.0450         EPS         
7 .BASE_CASE        -INF           45.0450        45.0450         EPS         
8 .BASE_CASE        -INF           45.0450        45.0450         EPS         
9 .BASE_CASE        -INF           45.5750        45.5750         EPS         
10.BASE_CASE        -INF           47.1648        47.1648         EPS         
11.BASE_CASE        -INF           48.7546        48.7546         EPS         
12.BASE_CASE        -INF           50.3445        50.3445         EPS         
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 88
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_calPHVACSP2  calculate power consumption of HVAC system with room temperature setpoint

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF          -45.5750       -45.5750          .          
2 .BASE_CASE        -INF          -46.6349       -46.6349          .          
3 .BASE_CASE        -INF          -45.5750       -45.5750          .          
4 .BASE_CASE        -INF          -45.0450       -45.0450          .          
5 .BASE_CASE        -INF          -45.0450       -45.0450          .          
6 .BASE_CASE        -INF          -45.0450       -45.0450          .          
7 .BASE_CASE        -INF          -45.0450       -45.0450          .          
8 .BASE_CASE        -INF          -45.0450       -45.0450          .          
9 .BASE_CASE        -INF          -45.5750       -45.5750          .          
10.BASE_CASE        -INF          -47.1648       -47.1648          .          
11.BASE_CASE        -INF          -48.7546       -48.7546          .          
12.BASE_CASE        -INF          -50.3445       -50.3445          .          

---- EQU lbrmSetTemp  lower bound of room set temprature

          LOWER          LEVEL          UPPER         MARGINAL

1         70.0000        70.0000        +INF            EPS         
2         70.0000        70.0000        +INF            EPS         
3         70.0000        70.0000        +INF            EPS         
4         70.0000        70.0000        +INF            EPS         
5         70.0000        70.0000        +INF            EPS         
6         70.0000        70.0000        +INF            EPS         
7         70.0000        70.0000        +INF            EPS         
8         70.0000        70.0000        +INF            EPS         
9         70.0000        70.0000        +INF            EPS         
10        70.0000        85.0000        +INF             .          
11        70.0000        85.0000        +INF             .          
12        70.0000        85.0000        +INF             .          

---- EQU ubrmSetTemp  upper bound of room set temprature

          LOWER          LEVEL          UPPER         MARGINAL

1         -INF           70.0000        85.0000          .          
2         -INF           70.0000        85.0000          .          
3         -INF           70.0000        85.0000          .          
4         -INF           70.0000        85.0000          .          
5         -INF           70.0000        85.0000          .          
6         -INF           70.0000        85.0000          .          
7         -INF           70.0000        85.0000          .          
8         -INF           70.0000        85.0000          .          
9         -INF           70.0000        85.0000          .          
10        -INF           85.0000        85.0000          .          
11        -INF           85.0000        85.0000          .          
12        -INF           85.0000        85.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 89
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_branch1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE          .              .              .              .          
2 .BASE_CASE          .              .              .              .          
3 .BASE_CASE          .              .              .              .          
4 .BASE_CASE          .              .              .              .          
5 .BASE_CASE          .              .              .              .          
6 .BASE_CASE          .              .              .              .          
7 .BASE_CASE          .              .              .              .          
8 .BASE_CASE          .              .              .              .          
9 .BASE_CASE          .              .              .              .          
10.BASE_CASE          .              .              .              .          
11.BASE_CASE          .              .              .              .          
12.BASE_CASE          .              .              .              .          

---- EQU iniWHTempcon  

                        LOWER          LEVEL          UPPER         MARGINAL

WH_1.0.BASE_CASE       111.1611       111.1611       111.1611        -0.1754      

---- EQU thermEqWH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE          .              .              .            -0.1757      
WH_1.2 .BASE_CASE          .              .              .            -0.1757      
WH_1.3 .BASE_CASE          .              .              .            -0.1757      
WH_1.4 .BASE_CASE          .              .              .            -0.1757      
WH_1.5 .BASE_CASE          .              .              .            -0.1757      
WH_1.6 .BASE_CASE          .              .              .            -0.1757      
WH_1.7 .BASE_CASE          .              .              .            -0.1757      
WH_1.8 .BASE_CASE        -1.8360        -1.8360        -1.8360        -0.1757      
WH_1.9 .BASE_CASE          .              .              .            -0.1757      
WH_1.10.BASE_CASE        -1.8360        -1.8360        -1.8360        -0.1757      
WH_1.11.BASE_CASE        -1.8360        -1.8360        -1.8360        -0.1757      
WH_1.12.BASE_CASE        -9.1800        -9.1800        -9.1800        -0.1200      

---- EQU ubWHtemp  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.2 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.3 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.4 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.5 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.6 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.7 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.8 .BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.9 .BASE_CASE        -INF          113.0000       113.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 90
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU ubWHtemp  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.10.BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.11.BASE_CASE        -INF          113.0000       113.0000          .          
WH_1.12.BASE_CASE        -INF          103.6618       113.0000          .          

---- EQU lbWHtemp  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.2 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.3 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.4 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.5 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.6 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.7 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.8 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.9 .BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.10.BASE_CASE       113.0000       113.0000        +INF            0.0002      
WH_1.11.BASE_CASE       113.0000       113.0000        +INF            0.0558      
WH_1.12.BASE_CASE       113.0000       113.0000        +INF            0.1200      

---- EQU ubWHSetTemp  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1         -INF          118.0000       118.0000         EPS         
WH_1.2         -INF          118.0000       118.0000         EPS         
WH_1.3         -INF          112.8418       118.0000          .          
WH_1.4         -INF          118.0000       118.0000         EPS         
WH_1.5         -INF          118.0000       118.0000         EPS         
WH_1.6         -INF          112.8418       118.0000          .          
WH_1.7         -INF          118.0000       118.0000         EPS         
WH_1.8         -INF          118.0000       118.0000         EPS         
WH_1.9         -INF          118.0000       118.0000         EPS         
WH_1.10        -INF          118.0000       118.0000         EPS         
WH_1.11        -INF          118.0000       118.0000         EPS         
WH_1.12        -INF          108.0000       118.0000          .          

---- EQU lbWHSetTemp  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1        108.0000       118.0000        +INF             .          
WH_1.2        108.0000       118.0000        +INF             .          
WH_1.3        108.0000       112.8418        +INF             .          
WH_1.4        108.0000       118.0000        +INF             .          
WH_1.5        108.0000       118.0000        +INF             .          
WH_1.6        108.0000       112.8418        +INF             .          
WH_1.7        108.0000       118.0000        +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 91
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU lbWHSetTemp  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.8        108.0000       118.0000        +INF             .          
WH_1.9        108.0000       118.0000        +INF             .          
WH_1.10       108.0000       118.0000        +INF             .          
WH_1.11       108.0000       118.0000        +INF             .          
WH_1.12       108.0000       108.0000        +INF            EPS         

---- EQU f_ubpWHONHeat  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.0 .BASE_CASE        -INF           -8.3000          .              .          
WH_1.1 .BASE_CASE        -INF           -6.8640          .              .          
WH_1.2 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.3 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.4 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.5 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.6 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.7 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.8 .BASE_CASE        -INF           -6.8643          .              .          
WH_1.9 .BASE_CASE        -INF           -8.1861          .              .          
WH_1.10.BASE_CASE        -INF           -6.8643          .              .          
WH_1.11.BASE_CASE        -INF           -6.8643          .              .          
WH_1.12.BASE_CASE        -INF           -8.3000          .              .          

---- EQU f_ubpWHOFF1  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF        -9998.5640          .              .          
WH_1.2 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.3 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.4 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.5 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.6 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.7 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.8 .BASE_CASE        -INF        -9998.5643          .              .          
WH_1.9 .BASE_CASE        -INF        -9999.8861          .              .          
WH_1.10.BASE_CASE        -INF        -9998.5643          .              .          
WH_1.11.BASE_CASE        -INF        -9998.5643          .              .          
WH_1.12.BASE_CASE        -INF       -10000.0000          .              .          

---- EQU f_ubpWHOFF2  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF       -10001.4360          .              .          
WH_1.2 .BASE_CASE        -INF       -10000.1139          .              .          
WH_1.3 .BASE_CASE        -INF       -10000.1139          .              .          
WH_1.4 .BASE_CASE        -INF       -10000.1139          .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 92
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU f_ubpWHOFF2  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.5 .BASE_CASE        -INF       -10000.1139          .              .          
WH_1.6 .BASE_CASE        -INF       -10000.1139          .              .          
WH_1.7 .BASE_CASE        -INF       -10000.1139          .              .          
WH_1.8 .BASE_CASE        -INF       -10001.4357          .              .          
WH_1.9 .BASE_CASE        -INF       -10000.1139          .              .          
WH_1.10.BASE_CASE        -INF       -10001.4357          .              .          
WH_1.11.BASE_CASE        -INF       -10001.4357          .              .          
WH_1.12.BASE_CASE        -INF       -10000.0000          .              .          

---- EQU calWHTempNoHeating  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE          .              .              .             EPS         
WH_1.2 .BASE_CASE          .              .              .             EPS         
WH_1.3 .BASE_CASE          .              .              .             EPS         
WH_1.4 .BASE_CASE          .              .              .             EPS         
WH_1.5 .BASE_CASE          .              .              .             EPS         
WH_1.6 .BASE_CASE          .              .              .             EPS         
WH_1.7 .BASE_CASE          .              .              .             EPS         
WH_1.8 .BASE_CASE        -1.8360        -1.8360        -1.8360         EPS         
WH_1.9 .BASE_CASE          .              .              .             EPS         
WH_1.10.BASE_CASE        -1.8360        -1.8360        -1.8360         EPS         
WH_1.11.BASE_CASE        -1.8360        -1.8360        -1.8360         EPS         
WH_1.12.BASE_CASE        -9.1800        -9.1800        -9.1800         EPS         

---- EQU f_extraWHCon1  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE    -10000.0000     -9993.0054        +INF             .          
WH_1.2 .BASE_CASE    -10000.0000     -9994.8418        +INF             .          
WH_1.3 .BASE_CASE    -10000.0000    -10000.0000        +INF            EPS         
WH_1.4 .BASE_CASE    -10000.0000     -9994.8418        +INF             .          
WH_1.5 .BASE_CASE    -10000.0000     -9994.8418        +INF             .          
WH_1.6 .BASE_CASE    -10000.0000    -10000.0000        +INF             .          
WH_1.7 .BASE_CASE    -10000.0000     -9994.8418        +INF             .          
WH_1.8 .BASE_CASE    -10000.0000     -9993.0058        +INF             .          
WH_1.9 .BASE_CASE    -10000.0000     -9994.8418        +INF             .          
WH_1.10.BASE_CASE    -10000.0000     -9993.0058        +INF             .          
WH_1.11.BASE_CASE    -10000.0000     -9993.0058        +INF             .          
WH_1.12.BASE_CASE    -10000.0000     -9995.6618        +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 93
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_extraWHCon2  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE         0.0100      9993.0054        +INF             .          
WH_1.2 .BASE_CASE         0.0100      9994.8418        +INF             .          
WH_1.3 .BASE_CASE         0.0100     10000.0000        +INF             .          
WH_1.4 .BASE_CASE         0.0100      9994.8418        +INF             .          
WH_1.5 .BASE_CASE         0.0100      9994.8418        +INF             .          
WH_1.6 .BASE_CASE         0.0100     10000.0000        +INF             .          
WH_1.7 .BASE_CASE         0.0100      9994.8418        +INF             .          
WH_1.8 .BASE_CASE         0.0100      9993.0058        +INF             .          
WH_1.9 .BASE_CASE         0.0100      9994.8418        +INF             .          
WH_1.10.BASE_CASE         0.0100      9993.0058        +INF             .          
WH_1.11.BASE_CASE         0.0100      9993.0058        +INF             .          
WH_1.12.BASE_CASE         0.0100      9995.6618        +INF             .          

---- EQU calWHTempRatedHeating  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.2 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.3 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.4 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.5 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.6 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.7 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.8 .BASE_CASE         9.6927         9.6927         9.6927         EPS         
WH_1.9 .BASE_CASE        11.5287        11.5287        11.5287         EPS         
WH_1.10.BASE_CASE         9.6927         9.6927         9.6927         EPS         
WH_1.11.BASE_CASE         9.6927         9.6927         9.6927         EPS         
WH_1.12.BASE_CASE         2.3487         2.3487         2.3487         EPS         

---- EQU f_calPWHSP1  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.2 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.3 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.4 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.5 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.6 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.7 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.8 .BASE_CASE        -INF        10001.3218     10001.3218         EPS         
WH_1.9 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.10.BASE_CASE        -INF        10001.3218     10001.3218         EPS         
WH_1.11.BASE_CASE        -INF        10001.3218     10001.3218         EPS         
WH_1.12.BASE_CASE        -INF        10006.6091     10006.6091         EPS         
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 94
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_calPWHSP2  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.2 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.3 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.4 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.5 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.6 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.7 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.8 .BASE_CASE        -INF         9998.6782      9998.6782          .          
WH_1.9 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.10.BASE_CASE        -INF         9998.6782      9998.6782          .          
WH_1.11.BASE_CASE        -INF         9998.6782      9998.6782          .          
WH_1.12.BASE_CASE        -INF         9993.3909      9993.3909          .          

---- EQU f_ancbin1WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF        10006.9946     20000.0000          .          
WH_1.2 .BASE_CASE        -INF        10005.1582     20000.0000          .          
WH_1.3 .BASE_CASE        -INF        10000.0000     20000.0000          .          
WH_1.4 .BASE_CASE        -INF        10005.1582     20000.0000          .          
WH_1.5 .BASE_CASE        -INF        10005.1582     20000.0000          .          
WH_1.6 .BASE_CASE        -INF        10000.0000     20000.0000          .          
WH_1.7 .BASE_CASE        -INF        10005.1582     20000.0000          .          
WH_1.8 .BASE_CASE        -INF        10006.9942     20000.0000          .          
WH_1.9 .BASE_CASE        -INF        10005.1582     20000.0000          .          
WH_1.10.BASE_CASE        -INF        10006.9942     20000.0000          .          
WH_1.11.BASE_CASE        -INF        10006.9942     20000.0000          .          
WH_1.12.BASE_CASE        -INF        10004.3382     20000.0000          .          

---- EQU ancbin2WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF            1.4360     20000.0000          .          
WH_1.2 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.3 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.4 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.5 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.6 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.7 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.8 .BASE_CASE        -INF            1.4357     20000.0000          .          
WH_1.9 .BASE_CASE        -INF            0.1139     20000.0000          .          
WH_1.10.BASE_CASE        -INF            1.4357     20000.0000          .          
WH_1.11.BASE_CASE        -INF            1.4357     20000.0000          .          
WH_1.12.BASE_CASE        -INF             .         20000.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 95
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_ancbin3WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF         9998.5640     20000.0000          .          
WH_1.2 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.3 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.4 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.5 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.6 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.7 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.8 .BASE_CASE        -INF         9998.5643     20000.0000          .          
WH_1.9 .BASE_CASE        -INF         9999.8861     20000.0000          .          
WH_1.10.BASE_CASE        -INF         9998.5643     20000.0000          .          
WH_1.11.BASE_CASE        -INF         9998.5643     20000.0000          .          
WH_1.12.BASE_CASE        -INF        10000.0000     20000.0000          .          

---- EQU f_ancbin4WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF        10001.9946     20000.0000          .          
WH_1.2 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.3 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.4 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.5 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.6 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.7 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.8 .BASE_CASE        -INF        10001.9942     20000.0000          .          
WH_1.9 .BASE_CASE        -INF        10000.1582     20000.0000          .          
WH_1.10.BASE_CASE        -INF        10001.9942     20000.0000          .          
WH_1.11.BASE_CASE        -INF        10001.9942     20000.0000          .          
WH_1.12.BASE_CASE        -INF        10000.0000     20000.0000          .          

---- EQU f_ancbin5WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF         9998.0054     20000.0000          .          
WH_1.2 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.3 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.4 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.5 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.6 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.7 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.8 .BASE_CASE        -INF         9998.0058     20000.0000          .          
WH_1.9 .BASE_CASE        -INF         9999.8418     20000.0000          .          
WH_1.10.BASE_CASE        -INF         9998.0058     20000.0000          .          
WH_1.11.BASE_CASE        -INF         9998.0058     20000.0000          .          
WH_1.12.BASE_CASE        -INF        10000.0000     20000.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 96
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_ancbin6WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF         9993.0054     10000.0000          .          
WH_1.2 .BASE_CASE        -INF         9994.8418     10000.0000          .          
WH_1.3 .BASE_CASE        -INF        10000.0000     10000.0000          .          
WH_1.4 .BASE_CASE        -INF         9994.8418     10000.0000          .          
WH_1.5 .BASE_CASE        -INF         9994.8418     10000.0000          .          
WH_1.6 .BASE_CASE        -INF        10000.0000     10000.0000         EPS         
WH_1.7 .BASE_CASE        -INF         9994.8418     10000.0000          .          
WH_1.8 .BASE_CASE        -INF         9993.0058     10000.0000          .          
WH_1.9 .BASE_CASE        -INF         9994.8418     10000.0000          .          
WH_1.10.BASE_CASE        -INF         9993.0058     10000.0000          .          
WH_1.11.BASE_CASE        -INF         9993.0058     10000.0000          .          
WH_1.12.BASE_CASE        -INF         9995.6618     10000.0000          .          

---- EQU f_ancbin7WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF         9994.9643     19991.7000          .          
WH_1.2 .BASE_CASE        -INF         9996.2864     19991.7000          .          
WH_1.3 .BASE_CASE        -INF        10000.0000     19991.7000          .          
WH_1.4 .BASE_CASE        -INF         9996.2864     19991.7000          .          
WH_1.5 .BASE_CASE        -INF         9996.2864     19991.7000          .          
WH_1.6 .BASE_CASE        -INF        10000.0000     19991.7000          .          
WH_1.7 .BASE_CASE        -INF         9996.2864     19991.7000          .          
WH_1.8 .BASE_CASE        -INF         9994.9646     19991.7000          .          
WH_1.9 .BASE_CASE        -INF         9996.2864     19991.7000          .          
WH_1.10.BASE_CASE        -INF         9994.9646     19991.7000          .          
WH_1.11.BASE_CASE        -INF         9994.9646     19991.7000          .          
WH_1.12.BASE_CASE        -INF         9996.8767     19991.7000          .          

---- EQU f_ancbin8WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF        10001.4360     20008.3000          .          
WH_1.2 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.3 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.4 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.5 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.6 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.7 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.8 .BASE_CASE        -INF        10001.4357     20008.3000          .          
WH_1.9 .BASE_CASE        -INF        10000.1139     20008.3000          .          
WH_1.10.BASE_CASE        -INF        10001.4357     20008.3000          .          
WH_1.11.BASE_CASE        -INF        10001.4357     20008.3000          .          
WH_1.12.BASE_CASE        -INF        10000.0000     20008.3000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 97
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_ancbin9WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF         9998.5640     19991.7000          .          
WH_1.2 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.3 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.4 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.5 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.6 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.7 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.8 .BASE_CASE        -INF         9998.5643     19991.7000          .          
WH_1.9 .BASE_CASE        -INF         9999.8861     19991.7000          .          
WH_1.10.BASE_CASE        -INF         9998.5643     19991.7000          .          
WH_1.11.BASE_CASE        -INF         9998.5643     19991.7000          .          
WH_1.12.BASE_CASE        -INF        10000.0000     19991.7000          .          

---- EQU f_ancbin10WH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF         9990.4659     20000.0000          .          
WH_1.2 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.3 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.4 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.5 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.6 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.7 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.8 .BASE_CASE        -INF         9990.4655     20000.0000          .          
WH_1.9 .BASE_CASE        -INF         9988.6295     20000.0000          .          
WH_1.10.BASE_CASE        -INF         9990.4655     20000.0000          .          
WH_1.11.BASE_CASE        -INF         9990.4655     20000.0000          .          
WH_1.12.BASE_CASE        -INF         9988.4713     20000.0000          .          

---- EQU f_EVSOCdynamicEq1Charge  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.2 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.3 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.4 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.5 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.6 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.7 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.8 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.9 .BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
EV_1.10.BASE_CASE        -INF        10000.0000     10000.0000       -10.9800      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 98
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU f_EVSOCdynamicEq2Charge  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.2 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.3 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.4 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.5 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.6 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.7 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.8 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.9 .BASE_CASE        -INF        10000.0000     10000.0000          .          
EV_1.10.BASE_CASE        -INF        10000.0000     10000.0000          .          

---- EQU f_EVSOCdynamicEq1Discharge  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF            0.1200     10000.0000          .          
EV_1.2 .BASE_CASE        -INF            0.1200     10000.0000          .          
EV_1.3 .BASE_CASE        -INF            0.1200     10000.0000          .          
EV_1.4 .BASE_CASE        -INF            0.1200     10000.0000          .          
EV_1.5 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.6 .BASE_CASE        -INF            0.1200     10000.0000          .          
EV_1.7 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.8 .BASE_CASE        -INF            0.0733     10000.0000          .          
EV_1.9 .BASE_CASE        -INF            0.1200     10000.0000          .          
EV_1.10.BASE_CASE        -INF            0.1200     10000.0000          .          

---- EQU f_EVSOCdynamicEq2Discharge  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF           -0.1200     10000.0000          .          
EV_1.2 .BASE_CASE        -INF           -0.1200     10000.0000          .          
EV_1.3 .BASE_CASE        -INF           -0.1200     10000.0000          .          
EV_1.4 .BASE_CASE        -INF           -0.1200     10000.0000          .          
EV_1.5 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.6 .BASE_CASE        -INF           -0.1200     10000.0000          .          
EV_1.7 .BASE_CASE        -INF             .         10000.0000          .          
EV_1.8 .BASE_CASE        -INF           -0.0733     10000.0000          .          
EV_1.9 .BASE_CASE        -INF           -0.1200     10000.0000          .          
EV_1.10.BASE_CASE        -INF           -0.1200     10000.0000          .          

---- EQU f_EVSOCdynamicEq1Idle  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF        -9999.8800          .              .          
EV_1.2 .BASE_CASE        -INF        -9999.8800          .              .          
EV_1.3 .BASE_CASE        -INF        -9999.8800          .              .          
EV_1.4 .BASE_CASE        -INF        -9999.8800          .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                                03/14/18 13:22:38 Page 99
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU f_EVSOCdynamicEq1Idle  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.5 .BASE_CASE        -INF             .              .           -10.9800      
EV_1.6 .BASE_CASE        -INF        -9999.8800          .              .          
EV_1.7 .BASE_CASE        -INF             .              .           -10.9800      
EV_1.8 .BASE_CASE        -INF        -9999.9267          .              .          
EV_1.9 .BASE_CASE        -INF        -9999.8800          .              .          
EV_1.10.BASE_CASE        -INF        -9999.8800          .              .          

---- EQU f_EVSOCdynamicEq2Idle  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF       -10000.1200          .              .          
EV_1.2 .BASE_CASE        -INF       -10000.1200          .              .          
EV_1.3 .BASE_CASE        -INF       -10000.1200          .              .          
EV_1.4 .BASE_CASE        -INF       -10000.1200          .              .          
EV_1.5 .BASE_CASE        -INF             .              .              .          
EV_1.6 .BASE_CASE        -INF       -10000.1200          .              .          
EV_1.7 .BASE_CASE        -INF             .              .              .          
EV_1.8 .BASE_CASE        -INF       -10000.0733          .              .          
EV_1.9 .BASE_CASE        -INF       -10000.1200          .              .          
EV_1.10.BASE_CASE        -INF       -10000.1200          .              .          

---- EQU EVOfflineEq1  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.0 .BASE_CASE          .              .              .             EPS         
EV_1.11.BASE_CASE          .              .              .             0.2440      
EV_1.12.BASE_CASE          .              .              .             0.3200      

---- EQU EVOfflineEq2  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.0 .BASE_CASE          .              .              .             EPS         
EV_1.11.BASE_CASE          .              .              .            -0.2440      
EV_1.12.BASE_CASE          .              .              .            -0.3200      

---- EQU EViniSOCEq  

                        LOWER          LEVEL          UPPER         MARGINAL

EV_1.0.BASE_CASE         0.0067         0.0067         0.0067       -10.9800      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 100
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- EQU EVendSOCEq  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.10.BASE_CASE         0.9200         0.9200         0.9200        10.9800      

---- EQU f_EVubChargeCon  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.2 .BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.3 .BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.4 .BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.5 .BASE_CASE        -INF             .              .              .          
EV_1.6 .BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.7 .BASE_CASE        -INF             .              .              .          
EV_1.8 .BASE_CASE        -INF           -2.1006          .              .          
EV_1.9 .BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.10.BASE_CASE        -INF             .              .       -2.77556E-17      
EV_1.11.BASE_CASE        -INF             .              .              .          
EV_1.12.BASE_CASE        -INF             .              .              .          

---- EQU f_EVlbChargeCon  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE          .             5.3900        +INF             .          
EV_1.2 .BASE_CASE          .             5.3900        +INF             .          
EV_1.3 .BASE_CASE          .             5.3900        +INF             .          
EV_1.4 .BASE_CASE          .             5.3900        +INF             .          
EV_1.5 .BASE_CASE          .              .            +INF            0.2440      
EV_1.6 .BASE_CASE          .             5.3900        +INF             .          
EV_1.7 .BASE_CASE          .              .            +INF            0.2440      
EV_1.8 .BASE_CASE          .             3.2894        +INF             .          
EV_1.9 .BASE_CASE          .             5.3900        +INF             .          
EV_1.10.BASE_CASE          .             5.3900        +INF             .          
EV_1.11.BASE_CASE          .              .            +INF             .          
EV_1.12.BASE_CASE          .              .            +INF             .          

---- EQU f_EVubDischargeCon  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.2 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.3 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.4 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.5 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.6 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.7 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.8 .BASE_CASE        -INF             .              .            -0.2440      
EV_1.9 .BASE_CASE        -INF             .              .            -0.2440      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 101
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU f_EVubDischargeCon  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.10.BASE_CASE        -INF             .              .            -0.2440      
EV_1.11.BASE_CASE        -INF             .              .              .          
EV_1.12.BASE_CASE        -INF             .              .              .          

---- EQU f_EVlbDischargeCon  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE          .              .            +INF             .          
EV_1.2 .BASE_CASE          .              .            +INF             .          
EV_1.3 .BASE_CASE          .              .            +INF             .          
EV_1.4 .BASE_CASE          .              .            +INF             .          
EV_1.5 .BASE_CASE          .              .            +INF             .          
EV_1.6 .BASE_CASE          .              .            +INF             .          
EV_1.7 .BASE_CASE          .              .            +INF             .          
EV_1.8 .BASE_CASE          .              .            +INF             .          
EV_1.9 .BASE_CASE          .              .            +INF             .          
EV_1.10.BASE_CASE          .              .            +INF             .          
EV_1.11.BASE_CASE          .              .            +INF             .          
EV_1.12.BASE_CASE          .              .            +INF             .          

---- EQU f_EVStateCon  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.2 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.3 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.4 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.5 .BASE_CASE        -INF             .             1.0000          .          
EV_1.6 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.7 .BASE_CASE        -INF             .             1.0000          .          
EV_1.8 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.9 .BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.10.BASE_CASE        -INF            1.0000         1.0000          .          
EV_1.11.BASE_CASE        -INF             .             1.0000          .          
EV_1.12.BASE_CASE        -INF             .             1.0000          .          

---- EQU EVubSOC  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE        -INF            0.1267         1.0000          .          
EV_1.2 .BASE_CASE        -INF            0.2467         1.0000          .          
EV_1.3 .BASE_CASE        -INF            0.3667         1.0000          .          
EV_1.4 .BASE_CASE        -INF            0.4867         1.0000          .          
EV_1.5 .BASE_CASE        -INF            0.4867         1.0000          .          
EV_1.6 .BASE_CASE        -INF            0.6067         1.0000          .          
EV_1.7 .BASE_CASE        -INF            0.6067         1.0000          .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 102
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     EQU EVubSOC  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.8 .BASE_CASE        -INF            0.6800         1.0000          .          
EV_1.9 .BASE_CASE        -INF            0.8000         1.0000          .          
EV_1.10.BASE_CASE        -INF            0.9200         1.0000          .          

---- EQU EVlbSOC  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.1 .BASE_CASE          .             0.1267        +INF             .          
EV_1.2 .BASE_CASE          .             0.2467        +INF             .          
EV_1.3 .BASE_CASE          .             0.3667        +INF             .          
EV_1.4 .BASE_CASE          .             0.4867        +INF             .          
EV_1.5 .BASE_CASE          .             0.4867        +INF             .          
EV_1.6 .BASE_CASE          .             0.6067        +INF             .          
EV_1.7 .BASE_CASE          .             0.6067        +INF             .          
EV_1.8 .BASE_CASE          .             0.6800        +INF             .          
EV_1.9 .BASE_CASE          .             0.8000        +INF             .          
EV_1.10.BASE_CASE          .             0.9200        +INF             .          

                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU HVACEnerg~          .              .              .             EPS         
---- EQU WHEnergyC~          .              .              .             EPS         
---- EQU EVEnergyC~          .              .              .             EPS         
---- EQU StorEnerg~          .              .              .             EPS         
---- EQU PVEnergyC~          .              .              .             EPS         
---- EQU WindEnerg~          .              .              .             EPS         
---- EQU NCLEnergy~          .              .              .             EPS         

---- VAR pGrid  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           13.8141        +INF             .          
2 .BASE_CASE        -INF           12.4031        +INF             .          
3 .BASE_CASE        -INF           11.3433        +INF             .          
4 .BASE_CASE        -INF           10.8133        +INF             .          
5 .BASE_CASE        -INF            5.4133        +INF             .          
6 .BASE_CASE        -INF           10.8133        +INF             .          
7 .BASE_CASE        -INF            5.4133        +INF             .          
8 .BASE_CASE        -INF           10.0345        +INF             .          
9 .BASE_CASE        -INF           11.3433        +INF             .          
10.BASE_CASE        -INF            6.8357        +INF             .          
11.BASE_CASE        -INF            1.4357        +INF             .          
12.BASE_CASE        -INF             .            +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 103
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR pGridUB           -INF             .            +INF             .          

---- VAR pGridSlack1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE          .              .            +INF            EPS         
2 .BASE_CASE          .              .            +INF            EPS         
3 .BASE_CASE          .              .            +INF            EPS         
4 .BASE_CASE          .              .            +INF            EPS         
5 .BASE_CASE          .              .            +INF            EPS         
6 .BASE_CASE          .              .            +INF            EPS         
7 .BASE_CASE          .              .            +INF            EPS         
8 .BASE_CASE          .              .            +INF            EPS         
9 .BASE_CASE          .              .            +INF            EPS         
10.BASE_CASE          .              .            +INF            EPS         
11.BASE_CASE          .              .            +INF            EPS         
12.BASE_CASE          .              .            +INF            EPS         

---- VAR pGridSlack2  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE          .              .            +INF            EPS         
2 .BASE_CASE          .              .            +INF            EPS         
3 .BASE_CASE          .              .            +INF            EPS         
4 .BASE_CASE          .              .            +INF            EPS         
5 .BASE_CASE          .              .            +INF            EPS         
6 .BASE_CASE          .              .            +INF            EPS         
7 .BASE_CASE          .              .            +INF            EPS         
8 .BASE_CASE          .              .            +INF            EPS         
9 .BASE_CASE          .              .            +INF            EPS         
10.BASE_CASE          .              .            +INF            EPS         
11.BASE_CASE          .              .            +INF            EPS         
12.BASE_CASE          .              .            +INF            EPS         

                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR energyCost        -INF           24.3178        +INF             .          
---- VAR discom            -INF            4.5497        +INF             .          
---- VAR elecConsu~        -INF            7.9730        +INF             .          
---- VAR peakLoad          -INF             .            +INF            EPS         
---- VAR sumObj            -INF           28.8675        +INF             .          
---- VAR HVACEnerg~        -INF           12.6937        +INF             .          
---- VAR WHEnergyC~        -INF            1.5959        +INF             .          
---- VAR EVEnergyC~        -INF           10.0283        +INF             .          
---- VAR StorEnerg~        -INF             .            +INF             .          
---- VAR PVEnergyC~        -INF             .            +INF             .          
---- VAR WindEnerg~        -INF             .            +INF             .          
---- VAR NCLEnergy~        -INF             .            +INF             .          

GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 104
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


  energyCost  total energy cost
  discom  total discomfort
  elecConsump  total energy comsumption
  peakLoad  peak load
  sumObj  overall objective function

---- VAR rmTemp  

                    LOWER          LEVEL          UPPER         MARGINAL

0 .BASE_CASE        -INF           75.2409        +INF             .          
1 .BASE_CASE        -INF           75.0000        +INF             .          
2 .BASE_CASE        -INF           75.0000        +INF             .          
3 .BASE_CASE        -INF           75.0000        +INF             .          
4 .BASE_CASE        -INF           75.0000        +INF             .          
5 .BASE_CASE        -INF           75.0000        +INF             .          
6 .BASE_CASE        -INF           75.0000        +INF             .          
7 .BASE_CASE        -INF           75.0000        +INF             .          
8 .BASE_CASE        -INF           75.0000        +INF             .          
9 .BASE_CASE        -INF           75.0000        +INF             .          
10.BASE_CASE        -INF           76.4000        +INF             .          
11.BASE_CASE        -INF           77.9600        +INF             .          
12.BASE_CASE        -INF           79.6640        +INF             .          

---- VAR rmTempSP  room temperature set point

          LOWER          LEVEL          UPPER         MARGINAL

1         -INF           70.0000        +INF             .          
2         -INF           70.0000        +INF             .          
3         -INF           70.0000        +INF             .          
4         -INF           70.0000        +INF             .          
5         -INF           70.0000        +INF             .          
6         -INF           70.0000        +INF             .          
7         -INF           70.0000        +INF             .          
8         -INF           70.0000        +INF             .          
9         -INF           70.0000        +INF             .          
10        -INF           85.0000        +INF             .          
11        -INF           85.0000        +INF             .          
12        -INF           85.0000        +INF             .          

---- VAR pHVAC  HVAC power consumption

                    LOWER          LEVEL          UPPER         MARGINAL

0 .BASE_CASE          .              .            +INF            EPS         
1 .BASE_CASE          .             6.9781        +INF             .          
2 .BASE_CASE          .             6.8892        +INF             .          
3 .BASE_CASE          .             5.8294        +INF             .          
4 .BASE_CASE          .             5.2994        +INF             .          
5 .BASE_CASE          .             5.2994        +INF             .          
6 .BASE_CASE          .             5.2994        +INF             .          
7 .BASE_CASE          .             5.2994        +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 105
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     VAR pHVAC  HVAC power consumption

                    LOWER          LEVEL          UPPER         MARGINAL

8 .BASE_CASE          .             5.2994        +INF             .          
9 .BASE_CASE          .             5.8294        +INF             .          
10.BASE_CASE          .              .            +INF            0.0497      
11.BASE_CASE          .              .            +INF            0.1078      
12.BASE_CASE          .              .            +INF            0.2483      

---- VAR calRmTemp_noCool  calculated room temperature without HVAC

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           76.3168        +INF             .          
2 .BASE_CASE        -INF           76.3000        +INF             .          
3 .BASE_CASE        -INF           76.1000        +INF             .          
4 .BASE_CASE        -INF           76.0000        +INF             .          
5 .BASE_CASE        -INF           76.0000        +INF             .          
6 .BASE_CASE        -INF           76.0000        +INF             .          
7 .BASE_CASE        -INF           76.0000        +INF             .          
8 .BASE_CASE        -INF           76.0000        +INF             .          
9 .BASE_CASE        -INF           76.1000        +INF             .          
10.BASE_CASE        -INF           76.4000        +INF             .          
11.BASE_CASE        -INF           77.9600        +INF             .          
12.BASE_CASE        -INF           79.6640        +INF             .          

---- VAR calRmTemp_ratedCool  calculated room temperature with rated HVAC power

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           72.3163        +INF             .          
2 .BASE_CASE        -INF           72.2996        +INF             .          
3 .BASE_CASE        -INF           72.0996        +INF             .          
4 .BASE_CASE        -INF           71.9996        +INF             .          
5 .BASE_CASE        -INF           71.9996        +INF             .          
6 .BASE_CASE        -INF           71.9996        +INF             .          
7 .BASE_CASE        -INF           71.9996        +INF             .          
8 .BASE_CASE        -INF           71.9996        +INF             .          
9 .BASE_CASE        -INF           72.0996        +INF             .          
10.BASE_CASE        -INF           72.3996        +INF             .          
11.BASE_CASE        -INF           73.9596        +INF             .          
12.BASE_CASE        -INF           75.6636        +INF             .          

---- VAR calPHVAC_CoolSP  calculated HVAC power with room temperature cooling setpoint

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE        -INF           33.4752        +INF             .          
2 .BASE_CASE        -INF           33.3863        +INF             .          
3 .BASE_CASE        -INF           32.3264        +INF             .          
4 .BASE_CASE        -INF           31.7965        +INF             .          
5 .BASE_CASE        -INF           31.7965        +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 106
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     VAR calPHVAC_CoolSP  calculated HVAC power with room temperature cooling setpoint

                    LOWER          LEVEL          UPPER         MARGINAL

6 .BASE_CASE        -INF           31.7965        +INF             .          
7 .BASE_CASE        -INF           31.7965        +INF             .          
8 .BASE_CASE        -INF           31.7965        +INF             .          
9 .BASE_CASE        -INF           32.3264        +INF             .          
10.BASE_CASE        -INF          -45.5750        +INF             .          
11.BASE_CASE        -INF          -37.3079        +INF             .          
12.BASE_CASE        -INF          -28.2777        +INF             .          

---- VAR s1  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE          .              .            +INF            0.2507      
2 .BASE_CASE          .              .            +INF            0.2507      
3 .BASE_CASE          .              .            +INF            0.2507      
4 .BASE_CASE          .              .            +INF            0.2507      
5 .BASE_CASE          .              .            +INF            0.2507      
6 .BASE_CASE          .              .            +INF            0.2507      
7 .BASE_CASE          .              .            +INF            0.2507      
8 .BASE_CASE          .              .            +INF            0.2507      
9 .BASE_CASE          .              .            +INF            0.0138      
10.BASE_CASE          .             1.4000        +INF             .          
11.BASE_CASE          .             2.9600        +INF             .          
12.BASE_CASE          .             4.6640        +INF             .          

---- VAR s2  

                    LOWER          LEVEL          UPPER         MARGINAL

1 .BASE_CASE          .              .            +INF            0.3800      
2 .BASE_CASE          .              .            +INF            0.3800      
3 .BASE_CASE          .              .            +INF            0.3800      
4 .BASE_CASE          .              .            +INF            0.3800      
5 .BASE_CASE          .              .            +INF            0.3800      
6 .BASE_CASE          .              .            +INF            0.3800      
7 .BASE_CASE          .              .            +INF            0.3800      
8 .BASE_CASE          .              .            +INF            0.3800      
9 .BASE_CASE          .              .            +INF            0.3800      
10.BASE_CASE          .              .            +INF            0.3800      
11.BASE_CASE          .              .            +INF            0.3800      
12.BASE_CASE          .              .            +INF            0.3800      

---- VAR WHTemp  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.0 .BASE_CASE        -INF          111.1611        +INF             .          
WH_1.1 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.2 .BASE_CASE        -INF          113.0000        +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 107
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


     VAR WHTemp  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.3 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.4 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.5 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.6 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.7 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.8 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.9 .BASE_CASE        -INF          113.0000        +INF             .          
WH_1.10.BASE_CASE        -INF          113.0000        +INF             .          
WH_1.11.BASE_CASE        -INF          113.0000        +INF             .          
WH_1.12.BASE_CASE        -INF          103.6618        +INF             .          

---- VAR WHTempSP  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1         -INF          118.0000        +INF             .          
WH_1.2         -INF          118.0000        +INF             .          
WH_1.3         -INF          112.8418        +INF             .          
WH_1.4         -INF          118.0000        +INF             .          
WH_1.5         -INF          118.0000        +INF             .          
WH_1.6         -INF          112.8418        +INF             .          
WH_1.7         -INF          118.0000        +INF             .          
WH_1.8         -INF          118.0000        +INF             .          
WH_1.9         -INF          118.0000        +INF             .          
WH_1.10        -INF          118.0000        +INF             .          
WH_1.11        -INF          118.0000        +INF             .          
WH_1.12        -INF          108.0000        +INF             .          

---- VAR pWH  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.0 .BASE_CASE          .              .            +INF            EPS         
WH_1.1 .BASE_CASE          .             1.4360        +INF             .          
WH_1.2 .BASE_CASE          .             0.1139        +INF             .          
WH_1.3 .BASE_CASE          .             0.1139        +INF             .          
WH_1.4 .BASE_CASE          .             0.1139        +INF             .          
WH_1.5 .BASE_CASE          .             0.1139        +INF             .          
WH_1.6 .BASE_CASE          .             0.1139        +INF             .          
WH_1.7 .BASE_CASE          .             0.1139        +INF             .          
WH_1.8 .BASE_CASE          .             1.4357        +INF             .          
WH_1.9 .BASE_CASE          .             0.1139        +INF             .          
WH_1.10.BASE_CASE          .             1.4357        +INF             .          
WH_1.11.BASE_CASE          .             1.4357        +INF             .          
WH_1.12.BASE_CASE          .              .            +INF            0.1533      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 108
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR calWHTemp_noHeat  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF          111.0054        +INF             .          
WH_1.2 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.3 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.4 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.5 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.6 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.7 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.8 .BASE_CASE        -INF          111.0058        +INF             .          
WH_1.9 .BASE_CASE        -INF          112.8418        +INF             .          
WH_1.10.BASE_CASE        -INF          111.0058        +INF             .          
WH_1.11.BASE_CASE        -INF          111.0058        +INF             .          
WH_1.12.BASE_CASE        -INF          103.6618        +INF             .          

---- VAR calWHTemp_ratedHeat  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF          122.5341        +INF             .          
WH_1.2 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.3 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.4 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.5 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.6 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.7 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.8 .BASE_CASE        -INF          122.5345        +INF             .          
WH_1.9 .BASE_CASE        -INF          124.3705        +INF             .          
WH_1.10.BASE_CASE        -INF          122.5345        +INF             .          
WH_1.11.BASE_CASE        -INF          122.5345        +INF             .          
WH_1.12.BASE_CASE        -INF          115.1905        +INF             .          

---- VAR calPWH_HeatSP  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF            5.0357        +INF             .          
WH_1.2 .BASE_CASE        -INF            3.7136        +INF             .          
WH_1.3 .BASE_CASE        -INF             .            +INF             .          
WH_1.4 .BASE_CASE        -INF            3.7136        +INF             .          
WH_1.5 .BASE_CASE        -INF            3.7136        +INF             .          
WH_1.6 .BASE_CASE        -INF             .            +INF             .          
WH_1.7 .BASE_CASE        -INF            3.7136        +INF             .          
WH_1.8 .BASE_CASE        -INF            5.0354        +INF             .          
WH_1.9 .BASE_CASE        -INF            3.7136        +INF             .          
WH_1.10.BASE_CASE        -INF            5.0354        +INF             .          
WH_1.11.BASE_CASE        -INF            5.0354        +INF             .          
WH_1.12.BASE_CASE        -INF            3.1233        +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 109
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR s5  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE          .              .            +INF            0.1200      
WH_1.2 .BASE_CASE          .              .            +INF            0.1200      
WH_1.3 .BASE_CASE          .              .            +INF            0.1200      
WH_1.4 .BASE_CASE          .              .            +INF            0.1200      
WH_1.5 .BASE_CASE          .              .            +INF            0.1200      
WH_1.6 .BASE_CASE          .              .            +INF            0.1200      
WH_1.7 .BASE_CASE          .              .            +INF            0.1200      
WH_1.8 .BASE_CASE          .              .            +INF            0.1200      
WH_1.9 .BASE_CASE          .              .            +INF            0.1200      
WH_1.10.BASE_CASE          .              .            +INF            0.1200      
WH_1.11.BASE_CASE          .              .            +INF            0.1200      
WH_1.12.BASE_CASE          .              .            +INF            0.1200      

---- VAR s6  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE          .              .            +INF            0.1198      
WH_1.2 .BASE_CASE          .              .            +INF            0.1198      
WH_1.3 .BASE_CASE          .              .            +INF            0.1198      
WH_1.4 .BASE_CASE          .              .            +INF            0.1198      
WH_1.5 .BASE_CASE          .              .            +INF            0.1198      
WH_1.6 .BASE_CASE          .              .            +INF            0.1198      
WH_1.7 .BASE_CASE          .              .            +INF            0.1198      
WH_1.8 .BASE_CASE          .              .            +INF            0.1198      
WH_1.9 .BASE_CASE          .              .            +INF            0.1198      
WH_1.10.BASE_CASE          .              .            +INF            0.1198      
WH_1.11.BASE_CASE          .              .            +INF            0.0642      
WH_1.12.BASE_CASE          .             9.3382        +INF             .          

---- VAR WHON  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1           .              .             1.0000         EPS         
WH_1.2           .              .             1.0000         EPS         
WH_1.3           .              .             1.0000         EPS         
WH_1.4           .              .             1.0000         EPS         
WH_1.5           .              .             1.0000         EPS         
WH_1.6           .              .             1.0000         EPS         
WH_1.7           .              .             1.0000         EPS         
WH_1.8           .              .             1.0000         EPS         
WH_1.9           .              .             1.0000         EPS         
WH_1.10          .              .             1.0000         EPS         
WH_1.11          .              .             1.0000         EPS         
WH_1.12          .              .             1.0000         EPS         
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 110
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR bbb1  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1           .              .             1.0000         EPS         
WH_1.2           .              .             1.0000         EPS         
WH_1.3           .              .             1.0000         EPS         
WH_1.4           .              .             1.0000         EPS         
WH_1.5           .              .             1.0000         EPS         
WH_1.6           .              .             1.0000         EPS         
WH_1.7           .              .             1.0000         EPS         
WH_1.8           .              .             1.0000         EPS         
WH_1.9           .              .             1.0000         EPS         
WH_1.10          .              .             1.0000         EPS         
WH_1.11          .              .             1.0000         EPS         
WH_1.12          .              .             1.0000         EPS         

---- VAR WHAmbTemp  

                         LOWER          LEVEL          UPPER         MARGINAL

WH_1.1 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.2 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.3 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.4 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.5 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.6 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.7 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.8 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.9 .BASE_CASE        -INF             .            +INF            EPS         
WH_1.10.BASE_CASE        -INF             .            +INF            EPS         
WH_1.11.BASE_CASE        -INF             .            +INF            EPS         
WH_1.12.BASE_CASE        -INF             .            +INF            EPS         

---- VAR EVCharRate  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.0 .BASE_CASE        -INF             .            +INF             .          
EV_1.1 .BASE_CASE        -INF            5.4000        +INF             .          
EV_1.2 .BASE_CASE        -INF            5.4000        +INF             .          
EV_1.3 .BASE_CASE        -INF            5.4000        +INF             .          
EV_1.4 .BASE_CASE        -INF            5.4000        +INF             .          
EV_1.5 .BASE_CASE        -INF             .            +INF             .          
EV_1.6 .BASE_CASE        -INF            5.4000        +INF             .          
EV_1.7 .BASE_CASE        -INF             .            +INF             .          
EV_1.8 .BASE_CASE        -INF            3.2994        +INF             .          
EV_1.9 .BASE_CASE        -INF            5.4000        +INF             .          
EV_1.10.BASE_CASE        -INF            5.4000        +INF             .          
EV_1.11.BASE_CASE        -INF             .            +INF             .          
EV_1.12.BASE_CASE        -INF             .            +INF             .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 111
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR EVDischarRate  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.0 .BASE_CASE        -INF             .            +INF             .          
EV_1.1 .BASE_CASE        -INF             .            +INF             .          
EV_1.2 .BASE_CASE        -INF             .            +INF             .          
EV_1.3 .BASE_CASE        -INF             .            +INF             .          
EV_1.4 .BASE_CASE        -INF             .            +INF             .          
EV_1.5 .BASE_CASE        -INF             .            +INF             .          
EV_1.6 .BASE_CASE        -INF             .            +INF             .          
EV_1.7 .BASE_CASE        -INF             .            +INF             .          
EV_1.8 .BASE_CASE        -INF             .            +INF             .          
EV_1.9 .BASE_CASE        -INF             .            +INF             .          
EV_1.10.BASE_CASE        -INF             .            +INF             .          
EV_1.11.BASE_CASE        -INF             .            +INF             .          
EV_1.12.BASE_CASE        -INF             .            +INF             .          

---- VAR EVSOC  

                         LOWER          LEVEL          UPPER         MARGINAL

EV_1.0 .BASE_CASE          .             0.0067        +INF             .          
EV_1.1 .BASE_CASE          .             0.1267        +INF             .          
EV_1.2 .BASE_CASE          .             0.2467        +INF             .          
EV_1.3 .BASE_CASE          .             0.3667        +INF             .          
EV_1.4 .BASE_CASE          .             0.4867        +INF             .          
EV_1.5 .BASE_CASE          .             0.4867        +INF             .          
EV_1.6 .BASE_CASE          .             0.6067        +INF             .          
EV_1.7 .BASE_CASE          .             0.6067        +INF             .          
EV_1.8 .BASE_CASE          .             0.6800        +INF             .          
EV_1.9 .BASE_CASE          .             0.8000        +INF             .          
EV_1.10.BASE_CASE          .             0.9200        +INF             .          

---- VAR EVSOCSlack  

          LOWER          LEVEL          UPPER         MARGINAL

1           .              .            +INF           45.0000      
2           .              .            +INF           45.0000      
3           .              .            +INF           45.0000      
4           .              .            +INF           45.0000      
5           .              .            +INF           45.0000      
6           .              .            +INF           45.0000      
7           .              .            +INF           45.0000      
8           .              .            +INF           45.0000      
9           .              .            +INF           45.0000      
10          .              .            +INF           34.0200      
11          .              .            +INF           45.0000      
12          .              .            +INF           45.0000      
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 112
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR storCharRate  

                              LOWER          LEVEL          UPPER         MARGINAL

STORAGE_1.1 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.2 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.3 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.4 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.5 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.6 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.7 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.8 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.9 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.10.BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.11.BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.12.BASE_CASE        -INF             .            +INF            EPS         

---- VAR storDischarRate  

                              LOWER          LEVEL          UPPER         MARGINAL

STORAGE_1.1 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.2 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.3 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.4 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.5 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.6 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.7 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.8 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.9 .BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.10.BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.11.BASE_CASE        -INF             .            +INF            EPS         
STORAGE_1.12.BASE_CASE        -INF             .            +INF            EPS         

---- VAR f_ON  HVAC ON=1 or OFF=0 state

          LOWER          LEVEL          UPPER         MARGINAL

1           .             1.0000         1.0000         EPS         
2           .             1.0000         1.0000         EPS         
3           .             1.0000         1.0000         EPS         
4           .             1.0000         1.0000         EPS         
5           .             1.0000         1.0000         EPS         
6           .             1.0000         1.0000         EPS         
7           .             1.0000         1.0000         EPS         
8           .             1.0000         1.0000         EPS         
9           .             1.0000         1.0000         EPS         
10          .             1.0000         1.0000         EPS         
11          .             1.0000         1.0000         EPS         
12          .             1.0000         1.0000         EPS         
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 113
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR f_h  heating state

          LOWER          LEVEL          UPPER         MARGINAL

1           .              .             1.0000         EPS         
2           .              .             1.0000         EPS         
3           .              .             1.0000         EPS         
4           .              .             1.0000         EPS         
5           .              .             1.0000         EPS         
6           .              .             1.0000         EPS         
7           .              .             1.0000         EPS         
8           .              .             1.0000         EPS         
9           .              .             1.0000         EPS         
10          .              .             1.0000         EPS         
11          .              .             1.0000         EPS         
12          .              .             1.0000         EPS         

---- VAR f_WHON  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.0           .             1.0000         1.0000         EPS         
WH_1.1           .             1.0000         1.0000         EPS         
WH_1.2           .             1.0000         1.0000         EPS         
WH_1.3           .             1.0000         1.0000         EPS         
WH_1.4           .             1.0000         1.0000         EPS         
WH_1.5           .             1.0000         1.0000         EPS         
WH_1.6           .             1.0000         1.0000         EPS         
WH_1.7           .             1.0000         1.0000         EPS         
WH_1.8           .             1.0000         1.0000         EPS         
WH_1.9           .             1.0000         1.0000         EPS         
WH_1.10          .             1.0000         1.0000         EPS         
WH_1.11          .             1.0000         1.0000         EPS         
WH_1.12          .             1.0000         1.0000         EPS         

---- VAR f_bbb1  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1           .              .             1.0000         EPS         
WH_1.2           .              .             1.0000         EPS         
WH_1.3           .              .             1.0000         EPS         
WH_1.4           .              .             1.0000         EPS         
WH_1.5           .              .             1.0000         EPS         
WH_1.6           .              .             1.0000         EPS         
WH_1.7           .              .             1.0000         EPS         
WH_1.8           .              .             1.0000         EPS         
WH_1.9           .              .             1.0000         EPS         
WH_1.10          .              .             1.0000         EPS         
WH_1.11          .              .             1.0000         EPS         
WH_1.12          .              .             1.0000         EPS         
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 114
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR f_bbb2  

               LOWER          LEVEL          UPPER         MARGINAL

WH_1.1           .              .             1.0000         EPS         
WH_1.2           .              .             1.0000         EPS         
WH_1.3           .              .             1.0000         EPS         
WH_1.4           .              .             1.0000         EPS         
WH_1.5           .              .             1.0000         EPS         
WH_1.6           .              .             1.0000         EPS         
WH_1.7           .              .             1.0000         EPS         
WH_1.8           .              .             1.0000         EPS         
WH_1.9           .              .             1.0000         EPS         
WH_1.10          .              .             1.0000         EPS         
WH_1.11          .              .             1.0000         EPS         
WH_1.12          .              .             1.0000         EPS         

---- VAR f_EVChargeState  

               LOWER          LEVEL          UPPER         MARGINAL

EV_1.1           .             1.0000         1.0000    109800.0000      
EV_1.2           .             1.0000         1.0000    109800.0000      
EV_1.3           .             1.0000         1.0000    109800.0000      
EV_1.4           .             1.0000         1.0000    109800.0000      
EV_1.5           .              .             1.0000   -109799.9976      
EV_1.6           .             1.0000         1.0000    109800.0000      
EV_1.7           .              .             1.0000   -109799.9976      
EV_1.8           .             1.0000         1.0000    109800.0000      
EV_1.9           .             1.0000         1.0000    109800.0000      
EV_1.10          .             1.0000         1.0000    109800.0000      
EV_1.11          .              .             1.0000         EPS         
EV_1.12          .              .             1.0000         EPS         

---- VAR f_EVDischargeState  

               LOWER          LEVEL          UPPER         MARGINAL

EV_1.1           .              .             1.0000         EPS         
EV_1.2           .              .             1.0000         EPS         
EV_1.3           .              .             1.0000         EPS         
EV_1.4           .              .             1.0000         EPS         
EV_1.5           .              .             1.0000   -109800.0000      
EV_1.6           .              .             1.0000         EPS         
EV_1.7           .              .             1.0000   -109800.0000      
EV_1.8           .              .             1.0000         EPS         
EV_1.9           .              .             1.0000         EPS         
EV_1.10          .              .             1.0000         EPS         
EV_1.11          .              .             1.0000         EPS         
EV_1.12          .              .             1.0000         EPS         
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 115
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE SHEMS_overall Using MIP From line 1745


---- VAR ifrated  

          LOWER          LEVEL          UPPER         MARGINAL

1           .              .             1.0000         EPS         
2           .              .             1.0000         EPS         
3           .              .             1.0000         EPS         
4           .              .             1.0000         EPS         
5           .              .             1.0000         EPS         
6           .              .             1.0000         EPS         
7           .              .             1.0000         EPS         
8           .              .             1.0000         EPS         
9           .              .             1.0000         EPS         
10          .              .             1.0000         EPS         
11          .              .             1.0000         EPS         
12          .              .             1.0000         EPS         

---- VAR ifzero  

          LOWER          LEVEL          UPPER         MARGINAL

1           .              .             1.0000         EPS         
2           .              .             1.0000         EPS         
3           .              .             1.0000         EPS         
4           .              .             1.0000         EPS         
5           .              .             1.0000         EPS         
6           .              .             1.0000         EPS         
7           .              .             1.0000         EPS         
8           .              .             1.0000         EPS         
9           .              .             1.0000         EPS         
10          .             1.0000         1.0000         EPS         
11          .             1.0000         1.0000         EPS         
12          .             1.0000         1.0000         EPS         


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows                                                                                                                                                               03/14/18 13:22:38 Page 116
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----   1752 PARAMETER coolingSP            =       70.000  

----   1766 PARAMETER WHSP                 =      118.000  

----   1770 PARAMETER EVCharRateResult     =        5.400  

----   1771 VARIABLE EVCharRate.L  

          BASE_CASE

EV_1.1        5.400
EV_1.2        5.400
EV_1.3        5.400
EV_1.4        5.400
EV_1.6        5.400
EV_1.8        3.299
EV_1.9        5.400
EV_1.10       5.400


----   1771 VARIABLE EVSOC.L  

          BASE_CASE

EV_1.0        0.007
EV_1.1        0.127
EV_1.2        0.247
EV_1.3        0.367
EV_1.4        0.487
EV_1.5        0.487
EV_1.6        0.607
EV_1.7        0.607
EV_1.8        0.680
EV_1.9        0.800
EV_1.10       0.920



EXECUTION TIME       =        0.015 SECONDS      3 MB  24.7.4 r58773 WEX-WEI


USER: Small MUD - 5 User License                     G170912:1000AO-WIN
      Kansas State University, College of Engineering           DC12793
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      D:\PSOC\LWang\GAMS_HEMS_test\HEMS.gms
Output     D:\PSOC\LWang\GAMS_HEMS_test\HEMS.lst
